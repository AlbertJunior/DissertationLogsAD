/Volumes/workplace/disertatie/LogADEmpirical/venv/bin/python /Volumes/workplace/disertatie/LogADEmpirical/main_run.py --folder=hdfs/ --log_file=HDFS.log --dataset_name=hdfs --model_name=deeplog --window_type=session --sample=sliding_window --is_logkey --train_size=0.1 --train_ratio=1 --valid_ratio=0.1 --test_ratio=1 --n_warm_up_epoch=0 --n_epochs_stop=10 --batch_size=1024 --num_candidates=34 --history_size=10 --lr=0.001 --accumulation_step=5 --session_level=hour --window_size=30 --step_size=20 --output_dir=dataset/ --max_epoch=10 --run_dir=runs/2023-03-15
Some weights of the model checkpoint at bert-base-uncased were not used when initializing BertModel: ['cls.predictions.transform.dense.bias', 'cls.seq_relationship.weight', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.decoder.weight', 'cls.predictions.bias', 'cls.predictions.transform.dense.weight']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Save options parameters
vocab size 38
save vocab in dataset/hdfs/deeplog_vocab.pkl
Loading vocab
38
Loading train dataset

Secvente de train normale: 55857
Secvente de train anormale: 1649
Nr secvente train from train.pkl 57506
number of sessions 57506 . Cate una pentru fiecare identificator unic SAU logica de creare de sesiune
number of seqs 542013 . Exista mai multe pe train in functie de history_size
Find 487812 secvente de train, 54201 secvente de validation
Checkpoint not found

Starting EPOCH: 0 | phase: train | ⏰: 12:49:17 | Learning rate: 0.000031
Train loss: 3.53204972 - Train acc: 0.22 - Train kurtosis: -3.00 - Train skewness: 0.02: 100%|██████████| 477/477 [02:56<00:00,  2.70it/s]
Eliminated instances percentage:  0.10941305256943248 53373/487812
Eliminated anomalies percentage:  0.04858261667884511 2593/53373
:   0%|          | 0/477 [00:00<?, ?it/s]Log saved

Starting EPOCH: 1 | phase: train | ⏰: 12:52:15 | Learning rate: 0.000063
Train loss: 2.30747949 - Train acc: 0.28 - Train kurtosis: -1.74 - Train skewness: 0.08: 100%|██████████| 477/477 [02:44<00:00,  2.90it/s]
: 100%|██████████| 53/53 [00:05<00:00,  9.20it/s]
: 100%|██████████| 107/107 [00:08<00:00, 12.69it/s]
Eliminated instances percentage:  0.10391503284052053 50691/487812
Eliminated anomalies percentage:  0.06034601803081415 3059/50691

Starting epoch: 1 | phase: valid | ⏰: 12:55:00

Validation loss: 1.8627976606476981 Validation accuracy: 0.3829818638032509 Validation kurtosis: -0.6357254981994629 Validation skewness: -1.1173372268676758
Save model checkpoint at dataset/hdfs/deeplog/deeplog.pth
======== My contribution ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/train.pkl
Length test 57506
Nr secvente unice train: normale vs anormale
3773 607
------------------------JUST NORMAL FOR ELBOW TRAIN SEQUENCES----------------------------
: 100%|██████████| 19/19 [00:01<00:00, 11.57it/s]
For g  34  train metrics, TP:  459 , FP:  189 , FN: 1190 , P: 70.83333333333333 , R: 27.835051546391753 , F1: 39.96517196343056
For g  33  train metrics, TP:  459 , FP:  189 , FN: 1190 , P: 70.83333333333333 , R: 27.835051546391753 , F1: 39.96517196343056
For g  32  train metrics, TP:  459 , FP:  189 , FN: 1190 , P: 70.83333333333333 , R: 27.835051546391753 , F1: 39.96517196343056
For g  31  train metrics, TP:  771 , FP:  189 , FN: 878 , P: 80.3125 , R: 46.755609460278954 , F1: 59.10310463779226
For g  30  train metrics, TP:  771 , FP:  189 , FN: 878 , P: 80.3125 , R: 46.755609460278954 , F1: 59.10310463779226
For g  29  train metrics, TP:  812 , FP:  189 , FN: 837 , P: 81.11888111888112 , R: 49.24196482716798 , F1: 61.28301886792454
For g  28  train metrics, TP:  812 , FP:  189 , FN: 837 , P: 81.11888111888112 , R: 49.24196482716798 , F1: 61.28301886792454
For g  27  train metrics, TP:  812 , FP:  189 , FN: 837 , P: 81.11888111888112 , R: 49.24196482716798 , F1: 61.28301886792454
For g  26  train metrics, TP:  812 , FP:  189 , FN: 837 , P: 81.11888111888112 , R: 49.24196482716798 , F1: 61.28301886792454
For g  25  train metrics, TP:  812 , FP:  189 , FN: 837 , P: 81.11888111888112 , R: 49.24196482716798 , F1: 61.28301886792454
For g  24  train metrics, TP:  814 , FP:  190 , FN: 835 , P: 81.07569721115537 , R: 49.363250454821106 , F1: 61.364493026762155
For g  23  train metrics, TP:  815 , FP:  190 , FN: 834 , P: 81.09452736318408 , R: 49.42389326864767 , F1: 61.41672946495855
For g  22  train metrics, TP:  815 , FP:  190 , FN: 834 , P: 81.09452736318408 , R: 49.42389326864767 , F1: 61.41672946495855
For g  21  train metrics, TP:  815 , FP:  190 , FN: 834 , P: 81.09452736318408 , R: 49.42389326864767 , F1: 61.41672946495855
For g  20  train metrics, TP:  815 , FP:  190 , FN: 834 , P: 81.09452736318408 , R: 49.42389326864767 , F1: 61.41672946495855
For g  19  train metrics, TP:  1060 , FP:  209 , FN: 589 , P: 83.53033884948779 , R: 64.28138265615524 , F1: 72.65250171350239
For g  18  train metrics, TP:  1415 , FP:  248 , FN: 234 , P: 85.08719182200842 , R: 85.80958156458459 , F1: 85.44685990338165
For g  17  train metrics, TP:  1415 , FP:  248 , FN: 234 , P: 85.08719182200842 , R: 85.80958156458459 , F1: 85.44685990338165
For g  16  train metrics, TP:  1415 , FP:  248 , FN: 234 , P: 85.08719182200842 , R: 85.80958156458459 , F1: 85.44685990338165
For g  15  train metrics, TP:  1415 , FP:  248 , FN: 234 , P: 85.08719182200842 , R: 85.80958156458459 , F1: 85.44685990338165
For g  14  train metrics, TP:  1415 , FP:  248 , FN: 234 , P: 85.08719182200842 , R: 85.80958156458459 , F1: 85.44685990338165
For g  13  train metrics, TP:  1415 , FP:  248 , FN: 234 , P: 85.08719182200842 , R: 85.80958156458459 , F1: 85.44685990338165
For g  12  train metrics, TP:  1415 , FP:  248 , FN: 234 , P: 85.08719182200842 , R: 85.80958156458459 , F1: 85.44685990338165
For g  11  train metrics, TP:  1507 , FP:  248 , FN: 142 , P: 85.86894586894587 , R: 91.38872043662826 , F1: 88.54289071680377
For g  10  train metrics, TP:  1507 , FP:  248 , FN: 142 , P: 85.86894586894587 , R: 91.38872043662826 , F1: 88.54289071680377
For g  9  train metrics, TP:  1507 , FP:  248 , FN: 142 , P: 85.86894586894587 , R: 91.38872043662826 , F1: 88.54289071680377
For g  8  train metrics, TP:  1629 , FP:  250 , FN: 20 , P: 86.69505055880788 , R: 98.78714372346877 , F1: 92.34693877551021
For g  7  train metrics, TP:  1629 , FP:  250 , FN: 20 , P: 86.69505055880788 , R: 98.78714372346877 , F1: 92.34693877551021
For g  6  train metrics, TP:  1633 , FP:  8180 , FN: 16 , P: 16.641190257821258 , R: 99.02971497877502 , F1: 28.494154597801433
For g  5  train metrics, TP:  1644 , FP:  20373 , FN: 5 , P: 7.466957351137757 , R: 99.6967859308672 , F1: 13.89334910842559
For g  4  train metrics, TP:  1647 , FP:  23655 , FN: 2 , P: 6.509366848470477 , R: 99.87871437234688 , F1: 12.222180995139327
For g  3  train metrics, TP:  1647 , FP:  26973 , FN: 2 , P: 5.754716981132075 , R: 99.87871437234688 , F1: 10.882420958736661
For g  2  train metrics, TP:  1647 , FP:  27177 , FN: 2 , P: 5.71398834304746 , R: 99.87871437234688 , F1: 10.809569126767958
For g  1  train metrics, TP:  1647 , FP:  55855 , FN: 2 , P: 2.8642482000626064 , R: 99.87871437234688 , F1: 5.568798498757418
Ce a dat pe train
9 250 20 86.69505055880788 98.78714372346877

[648, 648, 648, 960, 960, 1001, 1001, 1001, 1001, 1001, 1004, 1005, 1005, 1005, 1005, 1269, 1663, 1663, 1663, 1663, 1663, 1663, 1663, 1755, 1755, 1755, 1879, 1879, 9813, 22017, 25302, 28620, 28824, 57502]
Changes in number of anomalies
Pentru g 33 anomalies diff:0
Pentru g 32 anomalies diff:0
Pentru g 31 anomalies diff:312
Pentru g 30 anomalies diff:0
Pentru g 29 anomalies diff:41
Pentru g 28 anomalies diff:0
Pentru g 27 anomalies diff:0
Pentru g 26 anomalies diff:0
Pentru g 25 anomalies diff:0
Pentru g 24 anomalies diff:3
Pentru g 23 anomalies diff:1
Pentru g 22 anomalies diff:0
Pentru g 21 anomalies diff:0
Pentru g 20 anomalies diff:0
Pentru g 19 anomalies diff:264
Pentru g 18 anomalies diff:394
Pentru g 17 anomalies diff:0
Pentru g 16 anomalies diff:0
Pentru g 15 anomalies diff:0
Pentru g 14 anomalies diff:0
Pentru g 13 anomalies diff:0
Pentru g 12 anomalies diff:0
Pentru g 11 anomalies diff:92
Pentru g 10 anomalies diff:0
Pentru g 9 anomalies diff:0
Pentru g 8 anomalies diff:124
Pentru g 7 anomalies diff:0
Pentru g 6 anomalies diff:7934
Pentru g 5 anomalies diff:12204
Pentru g 4 anomalies diff:3285
Pentru g 3 anomalies diff:3318
Pentru g 2 anomalies diff:204
Pentru g 1 anomalies diff:28678
elapsed_time: 52.368539810180664
======== Their approach ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/test.pkl
Length test 517555
Nr secvente unice test: normale vs anormale
13059 3689
: 100%|██████████| 389/389 [00:39<00:00,  9.96it/s]
: 100%|██████████| 120/120 [00:08<00:00, 14.14it/s]
------------------------NORMAL TEST SEQUENCES----------------------------
For g  34  test metrics, TP:  4321 , FP:  1628 , FN: 10868 , P: 72.63405614388972 , R: 28.448219105931923 , F1: 40.883716529472984
For g  33  test metrics, TP:  4321 , FP:  1628 , FN: 10868 , P: 72.63405614388972 , R: 28.448219105931923 , F1: 40.883716529472984
For g  32  test metrics, TP:  4321 , FP:  1628 , FN: 10868 , P: 72.63405614388972 , R: 28.448219105931923 , F1: 40.883716529472984
For g  31  test metrics, TP:  7234 , FP:  1628 , FN: 7955 , P: 81.62942902279396 , R: 47.62657186121535 , F1: 60.155502889692734
For g  30  test metrics, TP:  7234 , FP:  1628 , FN: 7955 , P: 81.62942902279396 , R: 47.62657186121535 , F1: 60.155502889692734
For g  29  test metrics, TP:  7554 , FP:  1628 , FN: 7635 , P: 82.26965802657374 , R: 49.73335966818092 , F1: 61.99171146034221
For g  28  test metrics, TP:  7556 , FP:  1628 , FN: 7633 , P: 82.27351916376307 , R: 49.74652709197446 , F1: 62.003036146555615
For g  27  test metrics, TP:  7558 , FP:  1628 , FN: 7631 , P: 82.27737861963858 , R: 49.75969451576799 , F1: 62.01435897435898
For g  26  test metrics, TP:  7558 , FP:  1628 , FN: 7631 , P: 82.27737861963858 , R: 49.75969451576799 , F1: 62.01435897435898
For g  25  test metrics, TP:  7558 , FP:  1628 , FN: 7631 , P: 82.27737861963858 , R: 49.75969451576799 , F1: 62.01435897435898
For g  24  test metrics, TP:  7573 , FP:  1632 , FN: 7616 , P: 82.270505160239 , R: 49.8584501942195 , F1: 62.08903828810363
For g  23  test metrics, TP:  7574 , FP:  1632 , FN: 7615 , P: 82.27243102324572 , R: 49.86503390611627 , F1: 62.094691535150645
For g  22  test metrics, TP:  7580 , FP:  1632 , FN: 7609 , P: 82.28397742075553 , R: 49.90453617749687 , F1: 62.12860128683251
For g  21  test metrics, TP:  7580 , FP:  1632 , FN: 7609 , P: 82.28397742075553 , R: 49.90453617749687 , F1: 62.12860128683251
For g  20  test metrics, TP:  7580 , FP:  1632 , FN: 7609 , P: 82.28397742075553 , R: 49.90453617749687 , F1: 62.12860128683251
For g  19  test metrics, TP:  9784 , FP:  1830 , FN: 5405 , P: 84.24315481315654 , R: 64.41503719797221 , F1: 73.0067529754132
For g  18  test metrics, TP:  13155 , FP:  2175 , FN: 2034 , P: 85.81213307240705 , R: 86.60873000197512 , F1: 86.20859136931092
For g  17  test metrics, TP:  13155 , FP:  2175 , FN: 2034 , P: 85.81213307240705 , R: 86.60873000197512 , F1: 86.20859136931092
For g  16  test metrics, TP:  13155 , FP:  2175 , FN: 2034 , P: 85.81213307240705 , R: 86.60873000197512 , F1: 86.20859136931092
For g  15  test metrics, TP:  13155 , FP:  2175 , FN: 2034 , P: 85.81213307240705 , R: 86.60873000197512 , F1: 86.20859136931092
For g  14  test metrics, TP:  13155 , FP:  2175 , FN: 2034 , P: 85.81213307240705 , R: 86.60873000197512 , F1: 86.20859136931092
For g  13  test metrics, TP:  13155 , FP:  2175 , FN: 2034 , P: 85.81213307240705 , R: 86.60873000197512 , F1: 86.20859136931092
For g  12  test metrics, TP:  13156 , FP:  2176 , FN: 2033 , P: 85.8074615183929 , R: 86.61531371387188 , F1: 86.20949510173324
For g  11  test metrics, TP:  13943 , FP:  2176 , FN: 1246 , P: 86.50040325082202 , R: 91.79669497662782 , F1: 89.06988629104382
For g  10  test metrics, TP:  13943 , FP:  2176 , FN: 1246 , P: 86.50040325082202 , R: 91.79669497662782 , F1: 89.06988629104382
For g  9  test metrics, TP:  13943 , FP:  2176 , FN: 1246 , P: 86.50040325082202 , R: 91.79669497662782 , F1: 89.06988629104382
For g  8  test metrics, TP:  15057 , FP:  2186 , FN: 132 , P: 87.32239169518066 , R: 99.1309500296267 , F1: 92.85273803650715
For g  7  test metrics, TP:  15057 , FP:  2186 , FN: 132 , P: 87.32239169518066 , R: 99.1309500296267 , F1: 92.85273803650715
For g  6  test metrics, TP:  15080 , FP:  73752 , FN: 109 , P: 16.97586455331412 , R: 99.28237540325236 , F1: 28.994145412945464
For g  5  test metrics, TP:  15177 , FP:  181962 , FN: 12 , P: 7.698628886217339 , R: 99.92099545723879 , F1: 14.295806488075053
For g  4  test metrics, TP:  15189 , FP:  210708 , FN: 0 , P: 6.72386087464641 , R: 100.0 , F1: 12.600482815260944
For g  3  test metrics, TP:  15189 , FP:  240961 , FN: 0 , P: 5.929728674604724 , R: 100.0 , F1: 11.195589281304937
For g  2  test metrics, TP:  15189 , FP:  242614 , FN: 0 , P: 5.8917080096042325 , R: 100.0 , F1: 11.127798616809283
For g  1  test metrics, TP:  15189 , FP:  502348 , FN: 0 , P: 2.9348626281792414 , R: 100.0 , F1: 5.702368572211605
Ce a dat pe validare
9 2186 132 87.32239169518066 99.1309500296267

Best threshold 8
Confusion matrix
TP: 15057, TN: 500180, FP: 2186, FN: 132, FNR: 0.008690499703732965, FPR: 0.004351409131987435
Precision: 87.322%, Recall: 99.131%, F1-measure: 92.853%, Specificity: 0.996
--------------------------UNIQUE TEST SEQUENCES------------------------------------
Ce a dat pe validare
9 711 107 83.43815513626835 97.09948495527243

Best threshold 8
Confusion matrix
TP: 3582, TN: 12348, FP: 711, FN: 107, FNR: 0.029005150447275686, FPR: 0.05444521019986216
Precision: 83.438%, Recall: 97.099%, F1-measure: 89.752%, Specificity: 0.946, Lead time: 16.020
elapsed_time: 415.4625380039215
Log saved

Starting EPOCH: 2 | phase: train | ⏰: 13:03:03 | Learning rate: 0.000125
Train loss: 1.68181479 - Train acc: 0.54 - Train kurtosis: -0.69 - Train skewness: -0.28: 100%|██████████| 477/477 [02:31<00:00,  3.15it/s]
Eliminated instances percentage:  0.08998958615204218 43898/487812
Eliminated anomalies percentage:  0.08291949519340289 3640/43898

Starting epoch: 2 | phase: valid | ⏰: 13:05:36
: 100%|██████████| 53/53 [00:05<00:00,  9.61it/s]

Validation loss: 1.464351793505111 Validation accuracy: 0.6154498994483497 Validation kurtosis: -1.1998499631881714 Validation skewness: -0.4616585671901703
Save model checkpoint at dataset/hdfs/deeplog/deeplog.pth
======== My contribution ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/train.pkl
Length test 57506
Nr secvente unice train: normale vs anormale
3773 607
: 100%|██████████| 107/107 [00:10<00:00, 10.08it/s]
: 100%|██████████| 19/19 [00:01<00:00, 14.53it/s]
------------------------JUST NORMAL FOR ELBOW TRAIN SEQUENCES----------------------------
For g  34  train metrics, TP:  46 , FP:  0 , FN: 1603 , P: 100.0 , R: 2.7895694360218313 , F1: 5.427728613569321
For g  33  train metrics, TP:  46 , FP:  0 , FN: 1603 , P: 100.0 , R: 2.7895694360218313 , F1: 5.427728613569321
For g  32  train metrics, TP:  46 , FP:  0 , FN: 1603 , P: 100.0 , R: 2.7895694360218313 , F1: 5.427728613569321
For g  31  train metrics, TP:  47 , FP:  0 , FN: 1602 , P: 100.0 , R: 2.850212249848393 , F1: 5.5424528301886795
For g  30  train metrics, TP:  47 , FP:  0 , FN: 1602 , P: 100.0 , R: 2.850212249848393 , F1: 5.5424528301886795
For g  29  train metrics, TP:  47 , FP:  0 , FN: 1602 , P: 100.0 , R: 2.850212249848393 , F1: 5.5424528301886795
For g  28  train metrics, TP:  49 , FP:  0 , FN: 1600 , P: 100.0 , R: 2.971497877501516 , F1: 5.771495877502945
For g  27  train metrics, TP:  50 , FP:  0 , FN: 1599 , P: 100.0 , R: 3.0321406913280775 , F1: 5.885815185403178
For g  26  train metrics, TP:  362 , FP:  0 , FN: 1287 , P: 100.0 , R: 21.952698605215282 , F1: 36.001989060169066
For g  25  train metrics, TP:  384 , FP:  6 , FN: 1265 , P: 98.46153846153847 , R: 23.286840509399635 , F1: 37.665522314860226
For g  24  train metrics, TP:  457 , FP:  29 , FN: 1192 , P: 94.03292181069959 , R: 27.71376591873863 , F1: 42.81030444964872
For g  23  train metrics, TP:  674 , FP:  181 , FN: 975 , P: 78.83040935672514 , R: 40.87325651910248 , F1: 53.83386581469648
For g  22  train metrics, TP:  680 , FP:  183 , FN: 969 , P: 78.79490150637312 , R: 41.23711340206186 , F1: 54.14012738853504
For g  21  train metrics, TP:  681 , FP:  184 , FN: 968 , P: 78.72832369942196 , R: 41.29775621588842 , F1: 54.17661097852029
For g  20  train metrics, TP:  682 , FP:  184 , FN: 967 , P: 78.75288683602771 , R: 41.35839902971498 , F1: 54.23459244532803
For g  19  train metrics, TP:  682 , FP:  184 , FN: 967 , P: 78.75288683602771 , R: 41.35839902971498 , F1: 54.23459244532803
For g  18  train metrics, TP:  682 , FP:  184 , FN: 967 , P: 78.75288683602771 , R: 41.35839902971498 , F1: 54.23459244532803
For g  17  train metrics, TP:  682 , FP:  184 , FN: 967 , P: 78.75288683602771 , R: 41.35839902971498 , F1: 54.23459244532803
For g  16  train metrics, TP:  682 , FP:  184 , FN: 967 , P: 78.75288683602771 , R: 41.35839902971498 , F1: 54.23459244532803
For g  15  train metrics, TP:  821 , FP:  226 , FN: 828 , P: 78.414517669532 , R: 49.787750151607035 , F1: 60.90504451038576
For g  14  train metrics, TP:  848 , FP:  230 , FN: 801 , P: 78.66419294990723 , R: 51.4251061249242 , F1: 62.192885955262184
For g  13  train metrics, TP:  1049 , FP:  230 , FN: 600 , P: 82.01720093823299 , R: 63.61431170406307 , F1: 71.65300546448087
For g  12  train metrics, TP:  1075 , FP:  231 , FN: 574 , P: 82.31240428790198 , R: 65.19102486355366 , F1: 72.7580372250423
For g  11  train metrics, TP:  1123 , FP:  231 , FN: 526 , P: 82.9394387001477 , R: 68.10187992722862 , F1: 74.79187479187479
For g  10  train metrics, TP:  1197 , FP:  231 , FN: 452 , P: 83.82352941176471 , R: 72.58944815039418 , F1: 77.80305492362692
For g  9  train metrics, TP:  1629 , FP:  250 , FN: 20 , P: 86.69505055880788 , R: 98.78714372346877 , F1: 92.34693877551021
For g  8  train metrics, TP:  1629 , FP:  250 , FN: 20 , P: 86.69505055880788 , R: 98.78714372346877 , F1: 92.34693877551021
For g  7  train metrics, TP:  1629 , FP:  250 , FN: 20 , P: 86.69505055880788 , R: 98.78714372346877 , F1: 92.34693877551021
For g  6  train metrics, TP:  1633 , FP:  8180 , FN: 16 , P: 16.641190257821258 , R: 99.02971497877502 , F1: 28.494154597801433
For g  5  train metrics, TP:  1644 , FP:  20373 , FN: 5 , P: 7.466957351137757 , R: 99.6967859308672 , F1: 13.89334910842559
For g  4  train metrics, TP:  1644 , FP:  21151 , FN: 5 , P: 7.2121079184031585 , R: 99.6967859308672 , F1: 13.451153657339223
For g  3  train metrics, TP:  1647 , FP:  26975 , FN: 2 , P: 5.754314862693033 , R: 99.87871437234688 , F1: 10.881701958970632
For g  2  train metrics, TP:  1647 , FP:  27177 , FN: 2 , P: 5.71398834304746 , R: 99.87871437234688 , F1: 10.809569126767958
For g  1  train metrics, TP:  1647 , FP:  27195 , FN: 2 , P: 5.710422300811317 , R: 99.87871437234688 , F1: 10.803187825915844
Ce a dat pe train
10 250 20 86.69505055880788 98.78714372346877

[46, 46, 46, 47, 47, 47, 49, 50, 362, 390, 486, 855, 863, 865, 866, 866, 866, 866, 866, 1047, 1078, 1279, 1306, 1354, 1428, 1879, 1879, 1879, 9813, 22017, 22795, 28622, 28824, 28842]
Changes in number of anomalies
Pentru g 33 anomalies diff:0
Pentru g 32 anomalies diff:0
Pentru g 31 anomalies diff:1
Pentru g 30 anomalies diff:0
Pentru g 29 anomalies diff:0
Pentru g 28 anomalies diff:2
Pentru g 27 anomalies diff:1
Pentru g 26 anomalies diff:312
Pentru g 25 anomalies diff:28
Pentru g 24 anomalies diff:96
Pentru g 23 anomalies diff:369
Pentru g 22 anomalies diff:8
Pentru g 21 anomalies diff:2
Pentru g 20 anomalies diff:1
Pentru g 19 anomalies diff:0
Pentru g 18 anomalies diff:0
Pentru g 17 anomalies diff:0
Pentru g 16 anomalies diff:0
Pentru g 15 anomalies diff:181
Pentru g 14 anomalies diff:31
Pentru g 13 anomalies diff:201
Pentru g 12 anomalies diff:27
Pentru g 11 anomalies diff:48
Pentru g 10 anomalies diff:74
Pentru g 9 anomalies diff:451
Pentru g 8 anomalies diff:0
Pentru g 7 anomalies diff:0
Pentru g 6 anomalies diff:7934
Pentru g 5 anomalies diff:12204
Pentru g 4 anomalies diff:778
Pentru g 3 anomalies diff:5827
Pentru g 2 anomalies diff:202
Pentru g 1 anomalies diff:18
elapsed_time: 75.06571531295776
======== Their approach ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/test.pkl
Length test 517555
Nr secvente unice test: normale vs anormale
13059 3689
: 100%|██████████| 389/389 [00:30<00:00, 12.66it/s]
: 100%|██████████| 120/120 [00:07<00:00, 15.00it/s]
------------------------NORMAL TEST SEQUENCES----------------------------
For g  34  test metrics, TP:  389 , FP:  0 , FN: 14800 , P: 100.0 , R: 2.561063927842518 , F1: 4.994222621645912
For g  33  test metrics, TP:  389 , FP:  0 , FN: 14800 , P: 100.0 , R: 2.561063927842518 , F1: 4.994222621645912
For g  32  test metrics, TP:  400 , FP:  0 , FN: 14789 , P: 100.0 , R: 2.633484758706959 , F1: 5.131823721855154
For g  31  test metrics, TP:  402 , FP:  0 , FN: 14787 , P: 100.0 , R: 2.646652182500494 , F1: 5.156821243024823
For g  30  test metrics, TP:  402 , FP:  0 , FN: 14787 , P: 100.0 , R: 2.646652182500494 , F1: 5.156821243024823
For g  29  test metrics, TP:  412 , FP:  0 , FN: 14777 , P: 100.0 , R: 2.712489301468168 , F1: 5.2817127107236725
For g  28  test metrics, TP:  425 , FP:  0 , FN: 14764 , P: 100.0 , R: 2.798077556126144 , F1: 5.443832458050468
For g  27  test metrics, TP:  434 , FP:  0 , FN: 14755 , P: 100.0 , R: 2.8573309631970507 , F1: 5.555911156628048
For g  26  test metrics, TP:  3356 , FP:  0 , FN: 11833 , P: 100.0 , R: 22.094937125551386 , F1: 36.19304394715557
For g  25  test metrics, TP:  3529 , FP:  60 , FN: 11660 , P: 98.32822513234885 , R: 23.233919283692146 , F1: 37.58653743742678
For g  24  test metrics, TP:  4287 , FP:  229 , FN: 10902 , P: 94.92914083259522 , R: 28.224372901441832 , F1: 43.51179903577772
For g  23  test metrics, TP:  6285 , FP:  1541 , FN: 8904 , P: 80.30922565806287 , R: 41.378629271183094 , F1: 54.61655442102977
For g  22  test metrics, TP:  6350 , FP:  1556 , FN: 8839 , P: 80.31874525676702 , R: 41.806570544472976 , F1: 54.99025763152198
For g  21  test metrics, TP:  6388 , FP:  1562 , FN: 8801 , P: 80.35220125786164 , R: 42.056751596550136 , F1: 55.214140628376335
For g  20  test metrics, TP:  6390 , FP:  1562 , FN: 8799 , P: 80.35714285714286 , R: 42.06991902034367 , F1: 55.22665399075235
For g  19  test metrics, TP:  6392 , FP:  1563 , FN: 8797 , P: 80.3519798868636 , R: 42.0830864441372 , F1: 55.23677843069478
For g  18  test metrics, TP:  6394 , FP:  1563 , FN: 8795 , P: 80.3569184365967 , R: 42.09625386793074 , F1: 55.249287133846025
For g  17  test metrics, TP:  6397 , FP:  1564 , FN: 8792 , P: 80.35422685592262 , R: 42.11600500362104 , F1: 55.265658747300215
For g  16  test metrics, TP:  6399 , FP:  1564 , FN: 8790 , P: 80.35916112018084 , R: 42.129172427414574 , F1: 55.2781617138908
For g  15  test metrics, TP:  7621 , FP:  1950 , FN: 7568 , P: 79.62595340089855 , R: 50.17446836526434 , F1: 61.55896607431342
For g  14  test metrics, TP:  7969 , FP:  1979 , FN: 7220 , P: 80.10655408122236 , R: 52.46560010533939 , F1: 63.40454310379122
For g  13  test metrics, TP:  9820 , FP:  1982 , FN: 5369 , P: 83.20623623114726 , R: 64.65205082625585 , F1: 72.76499573932051
For g  12  test metrics, TP:  9983 , FP:  1988 , FN: 5206 , P: 83.39320023389858 , R: 65.72519586542893 , F1: 73.51251840942562
For g  11  test metrics, TP:  10435 , FP:  1988 , FN: 4754 , P: 83.99742413265717 , R: 68.7010336427678 , F1: 75.58307982036796
For g  10  test metrics, TP:  11031 , FP:  1989 , FN: 4158 , P: 84.72350230414746 , R: 72.62492593324116 , F1: 78.209082207806
For g  9  test metrics, TP:  15046 , FP:  2186 , FN: 143 , P: 87.31429897864439 , R: 99.05852919876226 , F1: 92.81638444218254
For g  8  test metrics, TP:  15057 , FP:  2186 , FN: 132 , P: 87.32239169518066 , R: 99.1309500296267 , F1: 92.85273803650715
For g  7  test metrics, TP:  15057 , FP:  2186 , FN: 132 , P: 87.32239169518066 , R: 99.1309500296267 , F1: 92.85273803650715
For g  6  test metrics, TP:  15080 , FP:  73752 , FN: 109 , P: 16.97586455331412 , R: 99.28237540325236 , F1: 28.994145412945464
For g  5  test metrics, TP:  15177 , FP:  181962 , FN: 12 , P: 7.698628886217339 , R: 99.92099545723879 , F1: 14.295806488075053
For g  4  test metrics, TP:  15177 , FP:  188486 , FN: 12 , P: 7.45201632107943 , R: 99.92099545723879 , F1: 13.86964706742456
For g  3  test metrics, TP:  15189 , FP:  240972 , FN: 0 , P: 5.929474041715952 , R: 100.0 , F1: 11.195135433941406
For g  2  test metrics, TP:  15189 , FP:  242614 , FN: 0 , P: 5.8917080096042325 , R: 100.0 , F1: 11.127798616809283
For g  1  test metrics, TP:  15189 , FP:  242767 , FN: 0 , P: 5.888213493774132 , R: 100.0 , F1: 11.12156546889015
Ce a dat pe validare
9 2186 132 87.32239169518066 99.1309500296267

Best threshold 8
Confusion matrix
TP: 15057, TN: 500180, FP: 2186, FN: 132, FNR: 0.008690499703732965, FPR: 0.004351409131987435
Precision: 87.322%, Recall: 99.131%, F1-measure: 92.853%, Specificity: 0.996
--------------------------UNIQUE TEST SEQUENCES------------------------------------
Ce a dat pe validare
9 711 107 83.43815513626835 97.09948495527243

Best threshold 8
Confusion matrix
TP: 3582, TN: 12348, FP: 711, FN: 107, FNR: 0.029005150447275686, FPR: 0.05444521019986216
Precision: 83.438%, Recall: 97.099%, F1-measure: 89.752%, Specificity: 0.946, Lead time: 16.020
elapsed_time: 413.40086913108826
Log saved

Starting EPOCH: 3 | phase: train | ⏰: 13:14:00 | Learning rate: 0.000250
Train loss: 1.08730575 - Train acc: 0.71 - Train kurtosis: -1.09 - Train skewness: -0.23: 100%|██████████| 477/477 [02:31<00:00,  3.14it/s]
Eliminated instances percentage:  0.04750395644223594 23173/487812
Eliminated anomalies percentage:  0.1481033961938463 3432/23173

Starting epoch: 3 | phase: valid | ⏰: 13:16:33
: 100%|██████████| 53/53 [00:05<00:00,  9.50it/s]

Validation loss: 0.8278457736069301 Validation accuracy: 0.7421634287190273 Validation kurtosis: -1.0301047563552856 Validation skewness: -0.5850766897201538
Save model checkpoint at dataset/hdfs/deeplog/deeplog.pth
======== My contribution ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/train.pkl
Length test 57506
Nr secvente unice train: normale vs anormale
3773 607
: 100%|██████████| 107/107 [00:08<00:00, 12.29it/s]
: 100%|██████████| 19/19 [00:01<00:00, 14.88it/s]
------------------------JUST NORMAL FOR ELBOW TRAIN SEQUENCES----------------------------
For g  34  train metrics, TP:  5 , FP:  0 , FN: 1644 , P: 100.0 , R: 0.30321406913280774 , F1: 0.6045949214026602
For g  33  train metrics, TP:  5 , FP:  0 , FN: 1644 , P: 100.0 , R: 0.30321406913280774 , F1: 0.6045949214026602
For g  32  train metrics, TP:  5 , FP:  0 , FN: 1644 , P: 100.0 , R: 0.30321406913280774 , F1: 0.6045949214026602
For g  31  train metrics, TP:  7 , FP:  0 , FN: 1642 , P: 100.0 , R: 0.42449969678593086 , F1: 0.8454106280193237
For g  30  train metrics, TP:  7 , FP:  0 , FN: 1642 , P: 100.0 , R: 0.42449969678593086 , F1: 0.8454106280193237
For g  29  train metrics, TP:  7 , FP:  0 , FN: 1642 , P: 100.0 , R: 0.42449969678593086 , F1: 0.8454106280193237
For g  28  train metrics, TP:  7 , FP:  0 , FN: 1642 , P: 100.0 , R: 0.42449969678593086 , F1: 0.8454106280193237
For g  27  train metrics, TP:  16 , FP:  0 , FN: 1633 , P: 100.0 , R: 0.9702850212249848 , F1: 1.921921921921922
For g  26  train metrics, TP:  19 , FP:  0 , FN: 1630 , P: 100.0 , R: 1.1522134627046694 , F1: 2.278177458033573
For g  25  train metrics, TP:  42 , FP:  0 , FN: 1607 , P: 100.0 , R: 2.546998180715585 , F1: 4.967474866942637
For g  24  train metrics, TP:  42 , FP:  0 , FN: 1607 , P: 100.0 , R: 2.546998180715585 , F1: 4.967474866942637
For g  23  train metrics, TP:  62 , FP:  0 , FN: 1587 , P: 100.0 , R: 3.759854457246816 , F1: 7.247223845704266
For g  22  train metrics, TP:  80 , FP:  1 , FN: 1569 , P: 98.76543209876543 , R: 4.851425106124924 , F1: 9.248554913294798
For g  21  train metrics, TP:  86 , FP:  1 , FN: 1563 , P: 98.85057471264368 , R: 5.215281989084294 , F1: 9.90783410138249
For g  20  train metrics, TP:  105 , FP:  1 , FN: 1544 , P: 99.05660377358491 , R: 6.367495451788963 , F1: 11.965811965811964
For g  19  train metrics, TP:  106 , FP:  1 , FN: 1543 , P: 99.06542056074767 , R: 6.428138265615525 , F1: 12.072892938496583
For g  18  train metrics, TP:  114 , FP:  1 , FN: 1535 , P: 99.1304347826087 , R: 6.913280776228017 , F1: 12.92517006802721
For g  17  train metrics, TP:  129 , FP:  16 , FN: 1520 , P: 88.96551724137932 , R: 7.82292298362644 , F1: 14.381270903010034
For g  16  train metrics, TP:  151 , FP:  16 , FN: 1498 , P: 90.41916167664671 , R: 9.157064887810794 , F1: 16.629955947136562
For g  15  train metrics, TP:  153 , FP:  17 , FN: 1496 , P: 90.0 , R: 9.278350515463918 , F1: 16.82242990654206
For g  14  train metrics, TP:  154 , FP:  17 , FN: 1495 , P: 90.05847953216374 , R: 9.33899332929048 , F1: 16.923076923076927
For g  13  train metrics, TP:  279 , FP:  22 , FN: 1370 , P: 92.69102990033223 , R: 16.919345057610673 , F1: 28.61538461538462
For g  12  train metrics, TP:  606 , FP:  39 , FN: 1043 , P: 93.95348837209302 , R: 36.7495451788963 , F1: 52.83347863993025
For g  11  train metrics, TP:  903 , FP:  98 , FN: 746 , P: 90.20979020979021 , R: 54.76046088538508 , F1: 68.15094339622642
For g  10  train metrics, TP:  1058 , FP:  225 , FN: 591 , P: 82.46297739672642 , R: 64.16009702850212 , F1: 72.16916780354707
For g  9  train metrics, TP:  1058 , FP:  228 , FN: 591 , P: 82.27060653188181 , R: 64.16009702850212 , F1: 72.09540034071551
For g  8  train metrics, TP:  1191 , FP:  229 , FN: 458 , P: 83.87323943661971 , R: 72.22559126743481 , F1: 77.61485826001955
For g  7  train metrics, TP:  1616 , FP:  246 , FN: 33 , P: 86.78839957035446 , R: 97.99878714372346 , F1: 92.05354599829109
For g  6  train metrics, TP:  1631 , FP:  252 , FN: 18 , P: 86.61710037174721 , R: 98.9084293511219 , F1: 92.35560588901471
For g  5  train metrics, TP:  1631 , FP:  288 , FN: 18 , P: 84.9921834288692 , R: 98.9084293511219 , F1: 91.4237668161435
For g  4  train metrics, TP:  1634 , FP:  1883 , FN: 15 , P: 46.46005117998294 , R: 99.09035779260158 , F1: 63.25977545489741
For g  3  train metrics, TP:  1641 , FP:  7841 , FN: 8 , P: 17.30647542712508 , R: 99.51485748938751 , F1: 29.485221453598058
For g  2  train metrics, TP:  1647 , FP:  8351 , FN: 2 , P: 16.473294658931785 , R: 99.87871437234688 , F1: 28.28196102000515
For g  1  train metrics, TP:  1647 , FP:  23711 , FN: 2 , P: 6.4949917185897945 , R: 99.87871437234688 , F1: 12.196837856851928
Ce a dat pe train
7 252 18 86.61710037174721 98.9084293511219

[5, 5, 5, 7, 7, 7, 7, 16, 19, 42, 42, 62, 81, 87, 106, 107, 115, 145, 167, 170, 171, 301, 645, 1001, 1283, 1286, 1420, 1862, 1883, 1919, 3517, 9482, 9998, 25358]
Changes in number of anomalies
Pentru g 33 anomalies diff:0
Pentru g 32 anomalies diff:0
Pentru g 31 anomalies diff:2
Pentru g 30 anomalies diff:0
Pentru g 29 anomalies diff:0
Pentru g 28 anomalies diff:0
Pentru g 27 anomalies diff:9
Pentru g 26 anomalies diff:3
Pentru g 25 anomalies diff:23
Pentru g 24 anomalies diff:0
Pentru g 23 anomalies diff:20
Pentru g 22 anomalies diff:19
Pentru g 21 anomalies diff:6
Pentru g 20 anomalies diff:19
Pentru g 19 anomalies diff:1
Pentru g 18 anomalies diff:8
Pentru g 17 anomalies diff:30
Pentru g 16 anomalies diff:22
Pentru g 15 anomalies diff:3
Pentru g 14 anomalies diff:1
Pentru g 13 anomalies diff:130
Pentru g 12 anomalies diff:344
Pentru g 11 anomalies diff:356
Pentru g 10 anomalies diff:282
Pentru g 9 anomalies diff:3
Pentru g 8 anomalies diff:134
Pentru g 7 anomalies diff:442
Pentru g 6 anomalies diff:21
Pentru g 5 anomalies diff:36
Pentru g 4 anomalies diff:1598
Pentru g 3 anomalies diff:5965
Pentru g 2 anomalies diff:516
Pentru g 1 anomalies diff:15360
elapsed_time: 51.13240122795105
======== Their approach ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/test.pkl
Length test 517555
Nr secvente unice test: normale vs anormale
13059 3689
: 100%|██████████| 389/389 [00:32<00:00, 11.90it/s]
: 100%|██████████| 120/120 [00:07<00:00, 16.89it/s]
------------------------NORMAL TEST SEQUENCES----------------------------
For g  34  test metrics, TP:  67 , FP:  0 , FN: 15122 , P: 100.0 , R: 0.44110869708341566 , F1: 0.8783429470372313
For g  33  test metrics, TP:  67 , FP:  0 , FN: 15122 , P: 100.0 , R: 0.44110869708341566 , F1: 0.8783429470372313
For g  32  test metrics, TP:  73 , FP:  0 , FN: 15116 , P: 100.0 , R: 0.48061096846402 , F1: 0.9566242956362206
For g  31  test metrics, TP:  81 , FP:  0 , FN: 15108 , P: 100.0 , R: 0.5332806636381592 , F1: 1.0609037328094302
For g  30  test metrics, TP:  87 , FP:  0 , FN: 15102 , P: 100.0 , R: 0.5727829350187635 , F1: 1.139041633935585
For g  29  test metrics, TP:  90 , FP:  0 , FN: 15099 , P: 100.0 , R: 0.5925340707090657 , F1: 1.1780875711761238
For g  28  test metrics, TP:  102 , FP:  0 , FN: 15087 , P: 100.0 , R: 0.6715386134702745 , F1: 1.3341181086913871
For g  27  test metrics, TP:  127 , FP:  0 , FN: 15062 , P: 100.0 , R: 0.8361314108894595 , F1: 1.6583964481587883
For g  26  test metrics, TP:  143 , FP:  0 , FN: 15046 , P: 100.0 , R: 0.9414708012377379 , F1: 1.8653795982259327
For g  25  test metrics, TP:  318 , FP:  0 , FN: 14871 , P: 100.0 , R: 2.0936203831720324 , F1: 4.101373573224995
For g  24  test metrics, TP:  331 , FP:  0 , FN: 14858 , P: 100.0 , R: 2.1792086378300084 , F1: 4.265463917525772
For g  23  test metrics, TP:  501 , FP:  0 , FN: 14688 , P: 100.0 , R: 3.298439660280466 , F1: 6.3862332695984705
For g  22  test metrics, TP:  686 , FP:  7 , FN: 14503 , P: 98.98989898989899 , R: 4.516426361182434 , F1: 8.638710489862737
For g  21  test metrics, TP:  727 , FP:  7 , FN: 14462 , P: 99.04632152588556 , R: 4.786358548949898 , F1: 9.131445079444829
For g  20  test metrics, TP:  916 , FP:  9 , FN: 14273 , P: 99.02702702702703 , R: 6.030680097438936 , F1: 11.368995904182698
For g  19  test metrics, TP:  941 , FP:  15 , FN: 14248 , P: 98.43096234309624 , R: 6.195272894858121 , F1: 11.6568597088882
For g  18  test metrics, TP:  1017 , FP:  15 , FN: 14172 , P: 98.54651162790698 , R: 6.6956349990124435 , F1: 12.539300906232663
For g  17  test metrics, TP:  1131 , FP:  120 , FN: 14058 , P: 90.40767386091127 , R: 7.446178155243927 , F1: 13.759124087591243
For g  16  test metrics, TP:  1292 , FP:  121 , FN: 13897 , P: 91.43665958952583 , R: 8.506155770623478 , F1: 15.564389832550296
For g  15  test metrics, TP:  1308 , FP:  125 , FN: 13881 , P: 91.27704117236567 , R: 8.611495160971756 , F1: 15.738178317891952
For g  14  test metrics, TP:  1314 , FP:  127 , FN: 13875 , P: 91.18667591950035 , R: 8.65099743235236 , F1: 15.802766085387855
For g  13  test metrics, TP:  2427 , FP:  153 , FN: 12762 , P: 94.06976744186046 , R: 15.978668773454473 , F1: 27.317237886206314
For g  12  test metrics, TP:  5550 , FP:  276 , FN: 9639 , P: 95.26261585993821 , R: 36.53960102705906 , F1: 52.81941470378302
For g  11  test metrics, TP:  8371 , FP:  794 , FN: 6818 , P: 91.33660665575559 , R: 55.11225228783989 , F1: 68.74435411020777
For g  10  test metrics, TP:  9809 , FP:  1913 , FN: 5380 , P: 83.68025934140931 , R: 64.5796299953914 , F1: 72.89955780164246
For g  9  test metrics, TP:  9816 , FP:  1944 , FN: 5373 , P: 83.46938775510205 , R: 64.62571597866878 , F1: 72.84871423800513
For g  8  test metrics, TP:  10992 , FP:  1974 , FN: 4197 , P: 84.77556686719112 , R: 72.36816116926724 , F1: 78.08204581779437
For g  7  test metrics, TP:  14895 , FP:  2143 , FN: 294 , P: 87.42223265641508 , R: 98.06438870235039 , F1: 92.43801781115214
For g  6  test metrics, TP:  15066 , FP:  2202 , FN: 123 , P: 87.24808895066018 , R: 99.19020343669762 , F1: 92.83667621776505
For g  5  test metrics, TP:  15067 , FP:  2546 , FN: 122 , P: 85.54476806903992 , R: 99.19678714859438 , F1: 91.86634961282849
For g  4  test metrics, TP:  15080 , FP:  17211 , FN: 109 , P: 46.70031897432721 , R: 99.28237540325236 , F1: 63.52148272957034
For g  3  test metrics, TP:  15152 , FP:  70830 , FN: 37 , P: 17.622293038077736 , R: 99.7564026598196 , F1: 29.953247472101687
For g  2  test metrics, TP:  15188 , FP:  75157 , FN: 1 , P: 16.811112955891307 , R: 99.99341628810323 , F1: 28.78314097826293
For g  1  test metrics, TP:  15189 , FP:  211183 , FN: 0 , P: 6.709752089481031 , R: 100.0 , F1: 12.57570551537707
Ce a dat pe validare
7 2202 123 87.24808895066018 99.19020343669762

Best threshold 6
Confusion matrix
TP: 15066, TN: 500164, FP: 2202, FN: 123, FNR: 0.0080979656330239, FPR: 0.004383258421151113
Precision: 87.248%, Recall: 99.190%, F1-measure: 92.837%, Specificity: 0.996
--------------------------UNIQUE TEST SEQUENCES------------------------------------
Ce a dat pe validare
7 720 98 83.29853862212944 97.34345351043643

Best threshold 6
Confusion matrix
TP: 3591, TN: 12339, FP: 720, FN: 98, FNR: 0.026565464895635674, FPR: 0.05513439007580979
Precision: 83.299%, Recall: 97.343%, F1-measure: 89.775%, Specificity: 0.945, Lead time: 15.664
elapsed_time: 435.448450088501
Log saved

Starting EPOCH: 4 | phase: train | ⏰: 13:24:52 | Learning rate: 0.000500
Train loss: 0.69821142 - Train acc: 0.76 - Train kurtosis: -1.06 - Train skewness: -0.60: 100%|██████████| 477/477 [02:33<00:00,  3.11it/s]
Eliminated instances percentage:  0.04975482357957574 24271/487812
Eliminated anomalies percentage:  0.1759713238020683 4271/24271

Starting epoch: 4 | phase: valid | ⏰: 13:27:27
: 100%|██████████| 53/53 [00:05<00:00,  9.59it/s]

Validation loss: 0.5375804962976923 Validation accuracy: 0.8102433534436634 Validation kurtosis: -0.7902926802635193 Validation skewness: -0.8555430173873901
Save model checkpoint at dataset/hdfs/deeplog/deeplog.pth
======== My contribution ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/train.pkl
Length test 57506
Nr secvente unice train: normale vs anormale
3773 607
: 100%|██████████| 107/107 [00:08<00:00, 12.99it/s]
: 100%|██████████| 19/19 [00:01<00:00, 14.51it/s]
------------------------JUST NORMAL FOR ELBOW TRAIN SEQUENCES----------------------------
For g  34  train metrics, TP:  3 , FP:  0 , FN: 1646 , P: 100.0 , R: 0.18192844147968465 , F1: 0.36319612590799033
For g  33  train metrics, TP:  3 , FP:  0 , FN: 1646 , P: 100.0 , R: 0.18192844147968465 , F1: 0.36319612590799033
For g  32  train metrics, TP:  5 , FP:  0 , FN: 1644 , P: 100.0 , R: 0.30321406913280774 , F1: 0.6045949214026602
For g  31  train metrics, TP:  6 , FP:  0 , FN: 1643 , P: 100.0 , R: 0.3638568829593693 , F1: 0.7250755287009063
For g  30  train metrics, TP:  7 , FP:  0 , FN: 1642 , P: 100.0 , R: 0.42449969678593086 , F1: 0.8454106280193237
For g  29  train metrics, TP:  10 , FP:  0 , FN: 1639 , P: 100.0 , R: 0.6064281382656155 , F1: 1.2055455093429777
For g  28  train metrics, TP:  10 , FP:  0 , FN: 1639 , P: 100.0 , R: 0.6064281382656155 , F1: 1.2055455093429777
For g  27  train metrics, TP:  10 , FP:  0 , FN: 1639 , P: 100.0 , R: 0.6064281382656155 , F1: 1.2055455093429777
For g  26  train metrics, TP:  10 , FP:  0 , FN: 1639 , P: 100.0 , R: 0.6064281382656155 , F1: 1.2055455093429777
For g  25  train metrics, TP:  49 , FP:  0 , FN: 1600 , P: 100.0 , R: 2.971497877501516 , F1: 5.771495877502945
For g  24  train metrics, TP:  50 , FP:  0 , FN: 1599 , P: 100.0 , R: 3.0321406913280775 , F1: 5.885815185403178
For g  23  train metrics, TP:  50 , FP:  0 , FN: 1599 , P: 100.0 , R: 3.0321406913280775 , F1: 5.885815185403178
For g  22  train metrics, TP:  51 , FP:  0 , FN: 1598 , P: 100.0 , R: 3.0927835051546393 , F1: 6.000000000000001
For g  21  train metrics, TP:  53 , FP:  0 , FN: 1596 , P: 100.0 , R: 3.2140691328077624 , F1: 6.227967097532314
For g  20  train metrics, TP:  54 , FP:  0 , FN: 1595 , P: 100.0 , R: 3.2747119466343237 , F1: 6.341749853200234
For g  19  train metrics, TP:  54 , FP:  0 , FN: 1595 , P: 100.0 , R: 3.2747119466343237 , F1: 6.341749853200234
For g  18  train metrics, TP:  54 , FP:  0 , FN: 1595 , P: 100.0 , R: 3.2747119466343237 , F1: 6.341749853200234
For g  17  train metrics, TP:  57 , FP:  0 , FN: 1592 , P: 100.0 , R: 3.4566403881140086 , F1: 6.682297772567409
For g  16  train metrics, TP:  73 , FP:  16 , FN: 1576 , P: 82.02247191011236 , R: 4.426925409338994 , F1: 8.400460299194476
For g  15  train metrics, TP:  151 , FP:  16 , FN: 1498 , P: 90.41916167664671 , R: 9.157064887810794 , F1: 16.629955947136562
For g  14  train metrics, TP:  154 , FP:  17 , FN: 1495 , P: 90.05847953216374 , R: 9.33899332929048 , F1: 16.923076923076927
For g  13  train metrics, TP:  316 , FP:  37 , FN: 1333 , P: 89.51841359773371 , R: 19.16312916919345 , F1: 31.568431568431567
For g  12  train metrics, TP:  321 , FP:  45 , FN: 1328 , P: 87.70491803278688 , R: 19.466343238326257 , F1: 31.861042183622825
For g  11  train metrics, TP:  825 , FP:  189 , FN: 824 , P: 81.36094674556213 , R: 50.03032140691328 , F1: 61.960195268494175
For g  10  train metrics, TP:  1053 , FP:  220 , FN: 596 , P: 82.71798900235663 , R: 63.856882959369315 , F1: 72.07392197125257
For g  9  train metrics, TP:  1058 , FP:  224 , FN: 591 , P: 82.52730109204369 , R: 64.16009702850212 , F1: 72.19379051518253
For g  8  train metrics, TP:  1058 , FP:  227 , FN: 591 , P: 82.33463035019456 , R: 64.16009702850212 , F1: 72.11997273346968
For g  7  train metrics, TP:  1058 , FP:  231 , FN: 591 , P: 82.07913110938712 , R: 64.16009702850212 , F1: 72.0217835262083
For g  6  train metrics, TP:  1191 , FP:  232 , FN: 458 , P: 83.6964160224877 , R: 72.22559126743481 , F1: 77.53906249999999
For g  5  train metrics, TP:  1193 , FP:  249 , FN: 456 , P: 82.73231622746187 , R: 72.34687689508793 , F1: 77.19184729860888
For g  4  train metrics, TP:  1201 , FP:  316 , FN: 448 , P: 79.16941331575478 , R: 72.83201940570042 , F1: 75.868603916614
For g  3  train metrics, TP:  1216 , FP:  388 , FN: 433 , P: 75.81047381546135 , R: 73.74166161309884 , F1: 74.76175837688288
For g  2  train metrics, TP:  1280 , FP:  8274 , FN: 369 , P: 13.397529830437513 , R: 77.62280169799878 , F1: 22.851022047665804
For g  1  train metrics, TP:  1648 , FP:  19599 , FN: 1 , P: 7.75638913728997 , R: 99.93935718617344 , F1: 14.395527603074772
Ce a dat pe train
7 232 458 83.6964160224877 72.22559126743481

[3, 3, 5, 6, 7, 10, 10, 10, 10, 49, 50, 50, 51, 53, 54, 54, 54, 57, 89, 167, 171, 353, 366, 1014, 1273, 1282, 1285, 1289, 1423, 1442, 1517, 1604, 9554, 21247]
Changes in number of anomalies
Pentru g 33 anomalies diff:0
Pentru g 32 anomalies diff:2
Pentru g 31 anomalies diff:1
Pentru g 30 anomalies diff:1
Pentru g 29 anomalies diff:3
Pentru g 28 anomalies diff:0
Pentru g 27 anomalies diff:0
Pentru g 26 anomalies diff:0
Pentru g 25 anomalies diff:39
Pentru g 24 anomalies diff:1
Pentru g 23 anomalies diff:0
Pentru g 22 anomalies diff:1
Pentru g 21 anomalies diff:2
Pentru g 20 anomalies diff:1
Pentru g 19 anomalies diff:0
Pentru g 18 anomalies diff:0
Pentru g 17 anomalies diff:3
Pentru g 16 anomalies diff:32
Pentru g 15 anomalies diff:78
Pentru g 14 anomalies diff:4
Pentru g 13 anomalies diff:182
Pentru g 12 anomalies diff:13
Pentru g 11 anomalies diff:648
Pentru g 10 anomalies diff:259
Pentru g 9 anomalies diff:9
Pentru g 8 anomalies diff:3
Pentru g 7 anomalies diff:4
Pentru g 6 anomalies diff:134
Pentru g 5 anomalies diff:19
Pentru g 4 anomalies diff:75
Pentru g 3 anomalies diff:87
Pentru g 2 anomalies diff:7950
Pentru g 1 anomalies diff:11693
elapsed_time: 51.686996936798096
======== Their approach ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/test.pkl
Length test 517555
Nr secvente unice test: normale vs anormale
13059 3689
: 100%|██████████| 389/389 [00:30<00:00, 12.85it/s]
: 100%|██████████| 120/120 [00:08<00:00, 14.63it/s]
------------------------NORMAL TEST SEQUENCES----------------------------
For g  34  test metrics, TP:  51 , FP:  0 , FN: 15138 , P: 100.0 , R: 0.3357693067351373 , F1: 0.6692913385826772
For g  33  test metrics, TP:  51 , FP:  0 , FN: 15138 , P: 100.0 , R: 0.3357693067351373 , F1: 0.6692913385826772
For g  32  test metrics, TP:  62 , FP:  0 , FN: 15127 , P: 100.0 , R: 0.4081901375995786 , F1: 0.8130614385941906
For g  31  test metrics, TP:  80 , FP:  0 , FN: 15109 , P: 100.0 , R: 0.5266969517413918 , F1: 1.0478747789639138
For g  30  test metrics, TP:  86 , FP:  0 , FN: 15103 , P: 100.0 , R: 0.5661992231219962 , F1: 1.126022913256956
For g  29  test metrics, TP:  95 , FP:  0 , FN: 15094 , P: 100.0 , R: 0.6254526301929028 , F1: 1.2431300706621304
For g  28  test metrics, TP:  106 , FP:  0 , FN: 15083 , P: 100.0 , R: 0.6978734610573442 , F1: 1.3860738803530566
For g  27  test metrics, TP:  107 , FP:  0 , FN: 15082 , P: 100.0 , R: 0.7044571729541115 , F1: 1.3990585774058577
For g  26  test metrics, TP:  111 , FP:  0 , FN: 15078 , P: 100.0 , R: 0.7307920205411811 , F1: 1.4509803921568627
For g  25  test metrics, TP:  422 , FP:  0 , FN: 14767 , P: 100.0 , R: 2.7783264204358415 , F1: 5.406444173979885
For g  24  test metrics, TP:  431 , FP:  0 , FN: 14758 , P: 100.0 , R: 2.8375798275067483 , F1: 5.518565941101153
For g  23  test metrics, TP:  442 , FP:  0 , FN: 14747 , P: 100.0 , R: 2.9100006583711897 , F1: 5.655428315526838
For g  22  test metrics, TP:  467 , FP:  0 , FN: 14722 , P: 100.0 , R: 3.0745934557903745 , F1: 5.965763924374042
For g  21  test metrics, TP:  480 , FP:  0 , FN: 14709 , P: 100.0 , R: 3.160181710448351 , F1: 6.126747080222094
For g  20  test metrics, TP:  488 , FP:  0 , FN: 14701 , P: 100.0 , R: 3.21285140562249 , F1: 6.22568093385214
For g  19  test metrics, TP:  492 , FP:  1 , FN: 14697 , P: 99.7971602434077 , R: 3.2391862532095597 , F1: 6.274709858436425
For g  18  test metrics, TP:  493 , FP:  1 , FN: 14696 , P: 99.79757085020243 , R: 3.245769965106327 , F1: 6.287062424281068
For g  17  test metrics, TP:  556 , FP:  1 , FN: 14633 , P: 99.82046678635548 , R: 3.660543814602673 , F1: 7.06211101232059
For g  16  test metrics, TP:  678 , FP:  113 , FN: 14511 , P: 85.71428571428571 , R: 4.463756666008296 , F1: 8.485607008760951
For g  15  test metrics, TP:  1304 , FP:  119 , FN: 13885 , P: 91.63738580463809 , R: 8.585160313384685 , F1: 15.699494341439921
For g  14  test metrics, TP:  1311 , FP:  125 , FN: 13878 , P: 91.29526462395543 , R: 8.631246296662058 , F1: 15.771428571428572
For g  13  test metrics, TP:  2820 , FP:  350 , FN: 12369 , P: 88.9589905362776 , R: 18.56606754888406 , F1: 30.72062748515714
For g  12  test metrics, TP:  2883 , FP:  381 , FN: 12306 , P: 88.32720588235294 , R: 18.980841398380406 , F1: 31.24695171516826
For g  11  test metrics, TP:  7542 , FP:  1663 , FN: 7647 , P: 81.93373166757198 , R: 49.65435512541971 , F1: 61.83487742887595
For g  10  test metrics, TP:  9781 , FP:  1883 , FN: 5408 , P: 83.85631001371742 , R: 64.39528606228191 , F1: 72.84847130674413
For g  9  test metrics, TP:  9817 , FP:  1911 , FN: 5372 , P: 83.7056616643929 , R: 64.63229969056555 , F1: 72.94274993498533
For g  8  test metrics, TP:  9817 , FP:  1929 , FN: 5372 , P: 83.57738804699473 , R: 64.63229969056555 , F1: 72.8940040839057
For g  7  test metrics, TP:  9821 , FP:  1989 , FN: 5368 , P: 83.15834038950042 , R: 64.65863453815261 , F1: 72.75084262380088
For g  6  test metrics, TP:  10997 , FP:  2009 , FN: 4192 , P: 84.55328310010765 , R: 72.40107972875107 , F1: 78.00673878347224
For g  5  test metrics, TP:  11011 , FP:  2198 , FN: 4178 , P: 83.35983041865394 , R: 72.49325169530582 , F1: 77.54771462779068
For g  4  test metrics, TP:  11047 , FP:  2723 , FN: 4142 , P: 80.22512708787218 , R: 72.73026532358944 , F1: 76.29407092786353
For g  3  test metrics, TP:  11188 , FP:  3273 , FN: 4001 , P: 77.36671046262362 , R: 73.65856870103364 , F1: 75.46711635750421
For g  2  test metrics, TP:  11762 , FP:  74499 , FN: 3427 , P: 13.635362446528559 , R: 77.43761932977813 , F1: 23.18777723016264
For g  1  test metrics, TP:  15188 , FP:  174006 , FN: 1 , P: 8.027738723215323 , R: 99.99341628810323 , F1: 14.862292852145238
Ce a dat pe validare
7 2009 4192 84.55328310010765 72.40107972875107

Best threshold 6
Confusion matrix
TP: 10997, TN: 500357, FP: 2009, FN: 4192, FNR: 0.2759892027124893, FPR: 0.0039990763706142535
Precision: 84.553%, Recall: 72.401%, F1-measure: 78.007%, Specificity: 0.996
--------------------------UNIQUE TEST SEQUENCES------------------------------------
Ce a dat pe validare
10 517 1054 83.59771573604061 71.42857142857143

Best threshold 9
Confusion matrix
TP: 2635, TN: 12542, FP: 517, FN: 1054, FNR: 0.2857142857142857, FPR: 0.039589555096102305
Precision: 83.598%, Recall: 71.429%, F1-measure: 77.036%, Specificity: 0.960, Lead time: 15.156
elapsed_time: 440.4839777946472
Log saved

Starting EPOCH: 5 | phase: train | ⏰: 13:35:55 | Learning rate: 0.001000
Train loss: 0.45407509 - Train acc: 0.83 - Train kurtosis: -0.46 - Train skewness: -1.03: 100%|██████████| 477/477 [02:31<00:00,  3.14it/s]
Eliminated instances percentage:  0.054527153903553005 26599/487812
Eliminated anomalies percentage:  0.1679762397082597 4468/26599

Starting epoch: 5 | phase: valid | ⏰: 13:38:28
: 100%|██████████| 53/53 [00:05<00:00,  9.74it/s]

Validation loss: 0.4055822013684039 Validation accuracy: 0.8517924023542001 Validation kurtosis: 0.003487566253170371 Validation skewness: -1.2214980125427246
Save model checkpoint at dataset/hdfs/deeplog/deeplog.pth
======== My contribution ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/train.pkl
Length test 57506
Nr secvente unice train: normale vs anormale
3773 607
: 100%|██████████| 107/107 [00:09<00:00, 11.28it/s]
: 100%|██████████| 19/19 [00:01<00:00, 16.14it/s]
------------------------JUST NORMAL FOR ELBOW TRAIN SEQUENCES----------------------------
For g  34  train metrics, TP:  2 , FP:  0 , FN: 1647 , P: 100.0 , R: 0.1212856276531231 , F1: 0.24227740763173833
For g  33  train metrics, TP:  2 , FP:  0 , FN: 1647 , P: 100.0 , R: 0.1212856276531231 , F1: 0.24227740763173833
For g  32  train metrics, TP:  4 , FP:  0 , FN: 1645 , P: 100.0 , R: 0.2425712553062462 , F1: 0.4839685420447671
For g  31  train metrics, TP:  5 , FP:  0 , FN: 1644 , P: 100.0 , R: 0.30321406913280774 , F1: 0.6045949214026602
For g  30  train metrics, TP:  6 , FP:  0 , FN: 1643 , P: 100.0 , R: 0.3638568829593693 , F1: 0.7250755287009063
For g  29  train metrics, TP:  7 , FP:  0 , FN: 1642 , P: 100.0 , R: 0.42449969678593086 , F1: 0.8454106280193237
For g  28  train metrics, TP:  7 , FP:  0 , FN: 1642 , P: 100.0 , R: 0.42449969678593086 , F1: 0.8454106280193237
For g  27  train metrics, TP:  9 , FP:  0 , FN: 1640 , P: 100.0 , R: 0.5457853244390539 , F1: 1.0856453558504222
For g  26  train metrics, TP:  10 , FP:  0 , FN: 1639 , P: 100.0 , R: 0.6064281382656155 , F1: 1.2055455093429777
For g  25  train metrics, TP:  10 , FP:  0 , FN: 1639 , P: 100.0 , R: 0.6064281382656155 , F1: 1.2055455093429777
For g  24  train metrics, TP:  10 , FP:  0 , FN: 1639 , P: 100.0 , R: 0.6064281382656155 , F1: 1.2055455093429777
For g  23  train metrics, TP:  11 , FP:  0 , FN: 1638 , P: 100.0 , R: 0.667070952092177 , F1: 1.325301204819277
For g  22  train metrics, TP:  11 , FP:  0 , FN: 1638 , P: 100.0 , R: 0.667070952092177 , F1: 1.325301204819277
For g  21  train metrics, TP:  19 , FP:  0 , FN: 1630 , P: 100.0 , R: 1.1522134627046694 , F1: 2.278177458033573
For g  20  train metrics, TP:  20 , FP:  0 , FN: 1629 , P: 100.0 , R: 1.212856276531231 , F1: 2.396644697423607
For g  19  train metrics, TP:  20 , FP:  0 , FN: 1629 , P: 100.0 , R: 1.212856276531231 , F1: 2.396644697423607
For g  18  train metrics, TP:  21 , FP:  0 , FN: 1628 , P: 100.0 , R: 1.2734990903577925 , F1: 2.5149700598802394
For g  17  train metrics, TP:  22 , FP:  0 , FN: 1627 , P: 100.0 , R: 1.334141904184354 , F1: 2.6331538001196884
For g  16  train metrics, TP:  23 , FP:  0 , FN: 1626 , P: 100.0 , R: 1.3947847180109156 , F1: 2.751196172248804
For g  15  train metrics, TP:  54 , FP:  0 , FN: 1595 , P: 100.0 , R: 3.2747119466343237 , F1: 6.341749853200234
For g  14  train metrics, TP:  154 , FP:  0 , FN: 1495 , P: 100.0 , R: 9.33899332929048 , F1: 17.082640044370496
For g  13  train metrics, TP:  155 , FP:  29 , FN: 1494 , P: 84.23913043478261 , R: 9.399636143117041 , F1: 16.912165848336063
For g  12  train metrics, TP:  157 , FP:  39 , FN: 1492 , P: 80.10204081632654 , R: 9.520921770770164 , F1: 17.018970189701896
For g  11  train metrics, TP:  241 , FP:  82 , FN: 1408 , P: 74.61300309597523 , R: 14.614918132201334 , F1: 24.442190669371193
For g  10  train metrics, TP:  246 , FP:  85 , FN: 1403 , P: 74.3202416918429 , R: 14.918132201334142 , F1: 24.848484848484848
For g  9  train metrics, TP:  278 , FP:  107 , FN: 1371 , P: 72.20779220779221 , R: 16.858702243784112 , F1: 27.335299901671583
For g  8  train metrics, TP:  540 , FP:  165 , FN: 1109 , P: 76.59574468085107 , R: 32.747119466343236 , F1: 45.87935429056924
For g  7  train metrics, TP:  881 , FP:  311 , FN: 768 , P: 73.90939597315436 , R: 53.42631898120073 , F1: 62.0204153467089
For g  6  train metrics, TP:  883 , FP:  334 , FN: 766 , P: 72.55546425636811 , R: 53.54760460885385 , F1: 61.618981158408936
For g  5  train metrics, TP:  1195 , FP:  358 , FN: 454 , P: 76.94784288473922 , R: 72.46816252274105 , F1: 74.64084946908183
For g  4  train metrics, TP:  1198 , FP:  366 , FN: 451 , P: 76.59846547314578 , R: 72.65009096422074 , F1: 74.57205104263927
For g  3  train metrics, TP:  1205 , FP:  415 , FN: 444 , P: 74.38271604938272 , R: 73.07459066100667 , F1: 73.72285102477822
For g  2  train metrics, TP:  1262 , FP:  7651 , FN: 387 , P: 14.159093458992484 , R: 76.53123104912068 , F1: 23.89698920658966
For g  1  train metrics, TP:  1467 , FP:  17029 , FN: 182 , P: 7.931444636678201 , R: 88.9630078835658 , F1: 14.564408041697693
Ce a dat pe train
6 358 454 76.94784288473922 72.46816252274105

[2, 2, 4, 5, 6, 7, 7, 9, 10, 10, 10, 11, 11, 19, 20, 20, 21, 22, 23, 54, 154, 184, 196, 323, 331, 385, 705, 1192, 1217, 1553, 1564, 1620, 8913, 18496]
Changes in number of anomalies
Pentru g 33 anomalies diff:0
Pentru g 32 anomalies diff:2
Pentru g 31 anomalies diff:1
Pentru g 30 anomalies diff:1
Pentru g 29 anomalies diff:1
Pentru g 28 anomalies diff:0
Pentru g 27 anomalies diff:2
Pentru g 26 anomalies diff:1
Pentru g 25 anomalies diff:0
Pentru g 24 anomalies diff:0
Pentru g 23 anomalies diff:1
Pentru g 22 anomalies diff:0
Pentru g 21 anomalies diff:8
Pentru g 20 anomalies diff:1
Pentru g 19 anomalies diff:0
Pentru g 18 anomalies diff:1
Pentru g 17 anomalies diff:1
Pentru g 16 anomalies diff:1
Pentru g 15 anomalies diff:31
Pentru g 14 anomalies diff:100
Pentru g 13 anomalies diff:30
Pentru g 12 anomalies diff:12
Pentru g 11 anomalies diff:127
Pentru g 10 anomalies diff:8
Pentru g 9 anomalies diff:54
Pentru g 8 anomalies diff:320
Pentru g 7 anomalies diff:487
Pentru g 6 anomalies diff:25
Pentru g 5 anomalies diff:336
Pentru g 4 anomalies diff:11
Pentru g 3 anomalies diff:56
Pentru g 2 anomalies diff:7293
Pentru g 1 anomalies diff:9583
elapsed_time: 58.65634894371033
======== Their approach ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/test.pkl
Length test 517555
Nr secvente unice test: normale vs anormale
13059 3689
: 100%|██████████| 389/389 [00:34<00:00, 11.31it/s]
: 100%|██████████| 120/120 [00:06<00:00, 18.12it/s]
------------------------NORMAL TEST SEQUENCES----------------------------
For g  34  test metrics, TP:  33 , FP:  0 , FN: 15156 , P: 100.0 , R: 0.2172624925933241 , F1: 0.43358297201419005
For g  33  test metrics, TP:  33 , FP:  0 , FN: 15156 , P: 100.0 , R: 0.2172624925933241 , F1: 0.43358297201419005
For g  32  test metrics, TP:  59 , FP:  0 , FN: 15130 , P: 100.0 , R: 0.38843900190927644 , F1: 0.7738719832109129
For g  31  test metrics, TP:  66 , FP:  0 , FN: 15123 , P: 100.0 , R: 0.4345249851866482 , F1: 0.8652900688298919
For g  30  test metrics, TP:  74 , FP:  0 , FN: 15115 , P: 100.0 , R: 0.4871946803607874 , F1: 0.9696652034331389
For g  29  test metrics, TP:  86 , FP:  0 , FN: 15103 , P: 100.0 , R: 0.5661992231219962 , F1: 1.126022913256956
For g  28  test metrics, TP:  88 , FP:  0 , FN: 15101 , P: 100.0 , R: 0.579366646915531 , F1: 1.1520586502585586
For g  27  test metrics, TP:  96 , FP:  0 , FN: 15093 , P: 100.0 , R: 0.6320363420896702 , F1: 1.256133464180569
For g  26  test metrics, TP:  97 , FP:  0 , FN: 15092 , P: 100.0 , R: 0.6386200539864375 , F1: 1.2691351563522175
For g  25  test metrics, TP:  107 , FP:  0 , FN: 15082 , P: 100.0 , R: 0.7044571729541115 , F1: 1.3990585774058577
For g  24  test metrics, TP:  114 , FP:  0 , FN: 15075 , P: 100.0 , R: 0.7505431562314833 , F1: 1.4899039404038423
For g  23  test metrics, TP:  126 , FP:  0 , FN: 15063 , P: 100.0 , R: 0.8295476989926921 , F1: 1.6454456415279137
For g  22  test metrics, TP:  137 , FP:  1 , FN: 15052 , P: 99.27536231884058 , R: 0.9019685298571335 , F1: 1.78769491746591
For g  21  test metrics, TP:  161 , FP:  1 , FN: 15028 , P: 99.38271604938272 , R: 1.059977615379551 , F1: 2.0975832193342456
For g  20  test metrics, TP:  173 , FP:  1 , FN: 15016 , P: 99.42528735632185 , R: 1.1389821581407598 , F1: 2.252164290828614
For g  19  test metrics, TP:  178 , FP:  1 , FN: 15011 , P: 99.44134078212291 , R: 1.1719007176245968 , F1: 2.316501821967725
For g  18  test metrics, TP:  186 , FP:  1 , FN: 15003 , P: 99.46524064171123 , R: 1.224570412798736 , F1: 2.4193548387096775
For g  17  test metrics, TP:  193 , FP:  1 , FN: 14996 , P: 99.48453608247422 , R: 1.2706563960761077 , F1: 2.50926347266463
For g  16  test metrics, TP:  214 , FP:  1 , FN: 14975 , P: 99.53488372093024 , R: 1.408914345908223 , F1: 2.7784990911451564
For g  15  test metrics, TP:  490 , FP:  1 , FN: 14699 , P: 99.79633401221996 , R: 3.2260188294160246 , F1: 6.25
For g  14  test metrics, TP:  1310 , FP:  1 , FN: 13879 , P: 99.92372234935164 , R: 8.624662584765291 , F1: 15.87878787878788
For g  13  test metrics, TP:  1322 , FP:  248 , FN: 13867 , P: 84.20382165605096 , R: 8.703667127526499 , F1: 15.776597649024403
For g  12  test metrics, TP:  1332 , FP:  377 , FN: 13857 , P: 77.94031597425395 , R: 8.769504246494174 , F1: 15.765179311161084
For g  11  test metrics, TP:  2097 , FP:  719 , FN: 13092 , P: 74.46732954545455 , R: 13.806043847521233 , F1: 23.29352957511802
For g  10  test metrics, TP:  2156 , FP:  771 , FN: 13033 , P: 73.65903655620089 , R: 14.194482849430509 , F1: 23.802163833075735
For g  9  test metrics, TP:  2443 , FP:  949 , FN: 12746 , P: 72.02240566037736 , R: 16.084008163802753 , F1: 26.29567838114203
For g  8  test metrics, TP:  5026 , FP:  1505 , FN: 10163 , P: 76.95605573419078 , R: 33.08973599315294 , F1: 46.279926335174956
For g  7  test metrics, TP:  8073 , FP:  2597 , FN: 7116 , P: 75.66073102155576 , R: 53.1503061426032 , F1: 62.43860938164662
For g  6  test metrics, TP:  8104 , FP:  2852 , FN: 7085 , P: 73.96860167944506 , R: 53.35440121140299 , F1: 61.99273283610633
For g  5  test metrics, TP:  11030 , FP:  3068 , FN: 4159 , P: 78.23804795006384 , R: 72.61834222134439 , F1: 75.32352238194422
For g  4  test metrics, TP:  11038 , FP:  3151 , FN: 4151 , P: 77.79265628303615 , R: 72.67101191651854 , F1: 75.144666076656
For g  3  test metrics, TP:  11089 , FP:  3557 , FN: 4100 , P: 75.71350539396423 , R: 73.00678122325367 , F1: 74.33551198257081
For g  2  test metrics, TP:  11638 , FP:  67943 , FN: 3551 , P: 14.624093690705068 , R: 76.62123905457896 , F1: 24.5605149308853
For g  1  test metrics, TP:  13428 , FP:  151427 , FN: 1761 , P: 8.145339844105425 , R: 88.40608334979261 , F1: 14.916353780187064
Ce a dat pe validare
6 3068 4159 78.23804795006384 72.61834222134439

Best threshold 5
Confusion matrix
TP: 11030, TN: 499298, FP: 3068, FN: 4159, FNR: 0.27381657778655605, FPR: 0.0061071011971351565
Precision: 78.238%, Recall: 72.618%, F1-measure: 75.324%, Specificity: 0.994
--------------------------UNIQUE TEST SEQUENCES------------------------------------
Ce a dat pe validare
8 769 1062 77.35571260306243 71.21171049064787

Best threshold 7
Confusion matrix
TP: 2627, TN: 12290, FP: 769, FN: 1062, FNR: 0.2878828950935213, FPR: 0.05888659162263573
Precision: 77.356%, Recall: 71.212%, F1-measure: 74.157%, Specificity: 0.941, Lead time: 15.421
elapsed_time: 472.2961039543152
Log saved

Starting EPOCH: 6 | phase: train | ⏰: 13:47:34 | Learning rate: 0.001000
Train loss: 0.37949174 - Train acc: 0.86 - Train kurtosis: 0.24 - Train skewness: -1.29: 100%|██████████| 477/477 [02:30<00:00,  3.17it/s]
Eliminated instances percentage:  0.10946840176133428 53400/487812
Eliminated anomalies percentage:  0.09734082397003746 5198/53400

Starting epoch: 6 | phase: valid | ⏰: 13:50:05
: 100%|██████████| 53/53 [00:05<00:00,  9.84it/s]

Validation loss: 0.34897699108663593 Validation accuracy: 0.8762015460969355 Validation kurtosis: 0.7291489839553833 Validation skewness: -1.4507852792739868
Save model checkpoint at dataset/hdfs/deeplog/deeplog.pth
======== My contribution ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/train.pkl
Length test 57506
Nr secvente unice train: normale vs anormale
3773 607
: 100%|██████████| 107/107 [00:07<00:00, 13.89it/s]
: 100%|██████████| 19/19 [00:01<00:00, 15.98it/s]
------------------------JUST NORMAL FOR ELBOW TRAIN SEQUENCES----------------------------
For g  34  train metrics, TP:  1 , FP:  0 , FN: 1648 , P: 100.0 , R: 0.06064281382656155 , F1: 0.1212121212121212
For g  33  train metrics, TP:  1 , FP:  0 , FN: 1648 , P: 100.0 , R: 0.06064281382656155 , F1: 0.1212121212121212
For g  32  train metrics, TP:  1 , FP:  0 , FN: 1648 , P: 100.0 , R: 0.06064281382656155 , F1: 0.1212121212121212
For g  31  train metrics, TP:  2 , FP:  0 , FN: 1647 , P: 100.0 , R: 0.1212856276531231 , F1: 0.24227740763173833
For g  30  train metrics, TP:  4 , FP:  0 , FN: 1645 , P: 100.0 , R: 0.2425712553062462 , F1: 0.4839685420447671
For g  29  train metrics, TP:  4 , FP:  0 , FN: 1645 , P: 100.0 , R: 0.2425712553062462 , F1: 0.4839685420447671
For g  28  train metrics, TP:  5 , FP:  0 , FN: 1644 , P: 100.0 , R: 0.30321406913280774 , F1: 0.6045949214026602
For g  27  train metrics, TP:  5 , FP:  0 , FN: 1644 , P: 100.0 , R: 0.30321406913280774 , F1: 0.6045949214026602
For g  26  train metrics, TP:  5 , FP:  0 , FN: 1644 , P: 100.0 , R: 0.30321406913280774 , F1: 0.6045949214026602
For g  25  train metrics, TP:  6 , FP:  0 , FN: 1643 , P: 100.0 , R: 0.3638568829593693 , F1: 0.7250755287009063
For g  24  train metrics, TP:  7 , FP:  0 , FN: 1642 , P: 100.0 , R: 0.42449969678593086 , F1: 0.8454106280193237
For g  23  train metrics, TP:  8 , FP:  0 , FN: 1641 , P: 100.0 , R: 0.4851425106124924 , F1: 0.9656004828002414
For g  22  train metrics, TP:  8 , FP:  0 , FN: 1641 , P: 100.0 , R: 0.4851425106124924 , F1: 0.9656004828002414
For g  21  train metrics, TP:  10 , FP:  0 , FN: 1639 , P: 100.0 , R: 0.6064281382656155 , F1: 1.2055455093429777
For g  20  train metrics, TP:  11 , FP:  0 , FN: 1638 , P: 100.0 , R: 0.667070952092177 , F1: 1.325301204819277
For g  19  train metrics, TP:  11 , FP:  1 , FN: 1638 , P: 91.66666666666667 , R: 0.667070952092177 , F1: 1.3245033112582782
For g  18  train metrics, TP:  12 , FP:  1 , FN: 1637 , P: 92.3076923076923 , R: 0.7277137659187386 , F1: 1.444043321299639
For g  17  train metrics, TP:  12 , FP:  1 , FN: 1637 , P: 92.3076923076923 , R: 0.7277137659187386 , F1: 1.444043321299639
For g  16  train metrics, TP:  20 , FP:  1 , FN: 1629 , P: 95.23809523809524 , R: 1.212856276531231 , F1: 2.3952095808383236
For g  15  train metrics, TP:  22 , FP:  2 , FN: 1627 , P: 91.66666666666667 , R: 1.334141904184354 , F1: 2.630005977286312
For g  14  train metrics, TP:  129 , FP:  3 , FN: 1520 , P: 97.72727272727273 , R: 7.82292298362644 , F1: 14.486243683323975
For g  13  train metrics, TP:  152 , FP:  5 , FN: 1497 , P: 96.81528662420382 , R: 9.217707701637355 , F1: 16.832779623477297
For g  12  train metrics, TP:  157 , FP:  42 , FN: 1492 , P: 78.89447236180905 , R: 9.520921770770164 , F1: 16.991341991341994
For g  11  train metrics, TP:  160 , FP:  52 , FN: 1489 , P: 75.47169811320755 , R: 9.702850212249848 , F1: 17.195056421278885
For g  10  train metrics, TP:  171 , FP:  87 , FN: 1478 , P: 66.27906976744185 , R: 10.369921164342026 , F1: 17.93392763502884
For g  9  train metrics, TP:  265 , FP:  174 , FN: 1384 , P: 60.36446469248292 , R: 16.07034566403881 , F1: 25.383141762452112
For g  8  train metrics, TP:  280 , FP:  202 , FN: 1369 , P: 58.09128630705394 , R: 16.979987871437235 , F1: 26.278742374472078
For g  7  train metrics, TP:  325 , FP:  225 , FN: 1324 , P: 59.09090909090909 , R: 19.708914493632506 , F1: 29.558890404729425
For g  6  train metrics, TP:  467 , FP:  355 , FN: 1182 , P: 56.81265206812652 , R: 28.320194057004244 , F1: 37.7984621610684
For g  5  train metrics, TP:  727 , FP:  369 , FN: 922 , P: 66.33211678832117 , R: 44.08732565191025 , F1: 52.96903460837888
For g  4  train metrics, TP:  886 , FP:  376 , FN: 763 , P: 70.20602218700475 , R: 53.729533050333536 , F1: 60.8725523874957
For g  3  train metrics, TP:  891 , FP:  422 , FN: 758 , P: 67.85986290936786 , R: 54.03274711946634 , F1: 60.16205266711681
For g  2  train metrics, TP:  949 , FP:  7897 , FN: 700 , P: 10.728012661089759 , R: 57.550030321406915 , F1: 18.08480228680324
For g  1  train metrics, TP:  1006 , FP:  15579 , FN: 643 , P: 6.065722037986132 , R: 61.006670709520925 , F1: 11.034331468684876
Ce a dat pe train
5 376 763 70.20602218700475 53.729533050333536

[1, 1, 1, 2, 4, 4, 5, 5, 5, 6, 7, 8, 8, 10, 11, 12, 13, 13, 21, 24, 132, 157, 199, 212, 258, 439, 482, 550, 822, 1096, 1262, 1313, 8846, 16585]
Changes in number of anomalies
Pentru g 33 anomalies diff:0
Pentru g 32 anomalies diff:0
Pentru g 31 anomalies diff:1
Pentru g 30 anomalies diff:2
Pentru g 29 anomalies diff:0
Pentru g 28 anomalies diff:1
Pentru g 27 anomalies diff:0
Pentru g 26 anomalies diff:0
Pentru g 25 anomalies diff:1
Pentru g 24 anomalies diff:1
Pentru g 23 anomalies diff:1
Pentru g 22 anomalies diff:0
Pentru g 21 anomalies diff:2
Pentru g 20 anomalies diff:1
Pentru g 19 anomalies diff:1
Pentru g 18 anomalies diff:1
Pentru g 17 anomalies diff:0
Pentru g 16 anomalies diff:8
Pentru g 15 anomalies diff:3
Pentru g 14 anomalies diff:108
Pentru g 13 anomalies diff:25
Pentru g 12 anomalies diff:42
Pentru g 11 anomalies diff:13
Pentru g 10 anomalies diff:46
Pentru g 9 anomalies diff:181
Pentru g 8 anomalies diff:43
Pentru g 7 anomalies diff:68
Pentru g 6 anomalies diff:272
Pentru g 5 anomalies diff:274
Pentru g 4 anomalies diff:166
Pentru g 3 anomalies diff:51
Pentru g 2 anomalies diff:7533
Pentru g 1 anomalies diff:7739
elapsed_time: 51.46461009979248
======== Their approach ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/test.pkl
Length test 517555
Nr secvente unice test: normale vs anormale
13059 3689
: 100%|██████████| 389/389 [00:28<00:00, 13.61it/s]
: 100%|██████████| 120/120 [00:07<00:00, 16.21it/s]
------------------------NORMAL TEST SEQUENCES----------------------------
For g  34  test metrics, TP:  48 , FP:  0 , FN: 15141 , P: 100.0 , R: 0.3160181710448351 , F1: 0.6300452845048238
For g  33  test metrics, TP:  48 , FP:  0 , FN: 15141 , P: 100.0 , R: 0.3160181710448351 , F1: 0.6300452845048238
For g  32  test metrics, TP:  49 , FP:  0 , FN: 15140 , P: 100.0 , R: 0.32260188294160247 , F1: 0.6431290195563721
For g  31  test metrics, TP:  54 , FP:  0 , FN: 15135 , P: 100.0 , R: 0.35552044242543945 , F1: 0.7085219444991142
For g  30  test metrics, TP:  78 , FP:  0 , FN: 15111 , P: 100.0 , R: 0.513529527947857 , F1: 1.0218117508351348
For g  29  test metrics, TP:  86 , FP:  0 , FN: 15103 , P: 100.0 , R: 0.5661992231219962 , F1: 1.126022913256956
For g  28  test metrics, TP:  89 , FP:  1 , FN: 15100 , P: 98.88888888888889 , R: 0.5859503588122984 , F1: 1.1649977092741672
For g  27  test metrics, TP:  94 , FP:  1 , FN: 15095 , P: 98.94736842105263 , R: 0.6188689182961353 , F1: 1.23004449097095
For g  26  test metrics, TP:  95 , FP:  1 , FN: 15094 , P: 98.95833333333333 , R: 0.6254526301929028 , F1: 1.243048740595355
For g  25  test metrics, TP:  102 , FP:  1 , FN: 15087 , P: 99.02912621359224 , R: 0.6715386134702745 , F1: 1.3340308658121895
For g  24  test metrics, TP:  104 , FP:  2 , FN: 15085 , P: 98.11320754716981 , R: 0.6847060372638093 , F1: 1.3599215429879046
For g  23  test metrics, TP:  121 , FP:  3 , FN: 15068 , P: 97.58064516129032 , R: 0.796629139508855 , F1: 1.580356559785803
For g  22  test metrics, TP:  123 , FP:  3 , FN: 15066 , P: 97.61904761904762 , R: 0.8097965633023899 , F1: 1.606268364348678
For g  21  test metrics, TP:  134 , FP:  3 , FN: 15055 , P: 97.81021897810218 , R: 0.8822173941668313 , F1: 1.7486624037583194
For g  20  test metrics, TP:  146 , FP:  3 , FN: 15043 , P: 97.98657718120805 , R: 0.96122193692804 , F1: 1.9037684183074717
For g  19  test metrics, TP:  153 , FP:  15 , FN: 15036 , P: 91.07142857142857 , R: 1.0073079202054118 , F1: 1.9925766751318619
For g  18  test metrics, TP:  155 , FP:  15 , FN: 15034 , P: 91.17647058823529 , R: 1.0204753439989467 , F1: 2.0183605703496323
For g  17  test metrics, TP:  155 , FP:  16 , FN: 15034 , P: 90.64327485380117 , R: 1.0204753439989467 , F1: 2.0182291666666665
For g  16  test metrics, TP:  178 , FP:  24 , FN: 15011 , P: 88.11881188118812 , R: 1.1719007176245968 , F1: 2.3130400883633295
For g  15  test metrics, TP:  186 , FP:  30 , FN: 15003 , P: 86.11111111111111 , R: 1.224570412798736 , F1: 2.4148003894839336
For g  14  test metrics, TP:  1116 , FP:  62 , FN: 14073 , P: 94.73684210526316 , R: 7.347422476792415 , F1: 13.637196798435877
For g  13  test metrics, TP:  1308 , FP:  81 , FN: 13881 , P: 94.16846652267819 , R: 8.611495160971756 , F1: 15.77994933043793
For g  12  test metrics, TP:  1335 , FP:  411 , FN: 13854 , P: 76.46048109965636 , R: 8.789255382184475 , F1: 15.766164747564213
For g  11  test metrics, TP:  1358 , FP:  482 , FN: 13831 , P: 73.80434782608695 , R: 8.940680755810126 , F1: 15.949263021903812
For g  10  test metrics, TP:  1475 , FP:  814 , FN: 13714 , P: 64.43861948449104 , R: 9.710975047731912 , F1: 16.878361368577643
For g  9  test metrics, TP:  2345 , FP:  1516 , FN: 12844 , P: 60.73556073556074 , R: 15.438804397919547 , F1: 24.61942257217848
For g  8  test metrics, TP:  2540 , FP:  1733 , FN: 12649 , P: 59.44301427568453 , R: 16.72262821778919 , F1: 26.10214777515158
For g  7  test metrics, TP:  2957 , FP:  1950 , FN: 12232 , P: 60.26085184430406 , R: 19.468036078741193 , F1: 29.42874203821656
For g  6  test metrics, TP:  4332 , FP:  3054 , FN: 10857 , P: 58.651502843216896 , R: 28.520639936796364 , F1: 38.37873754152824
For g  5  test metrics, TP:  6636 , FP:  3220 , FN: 8553 , P: 67.32954545454545 , R: 43.68951214694845 , F1: 52.992613296067084
For g  4  test metrics, TP:  8128 , FP:  3261 , FN: 7061 , P: 71.3671086135745 , R: 53.51241029692541 , F1: 61.16336819926255
For g  3  test metrics, TP:  8154 , FP:  3597 , FN: 7035 , P: 69.38983916262445 , R: 53.68358680624136 , F1: 60.534521158129174
For g  2  test metrics, TP:  8718 , FP:  69581 , FN: 6471 , P: 11.13424181662601 , R: 57.39680031601817 , F1: 18.65052199212733
For g  1  test metrics, TP:  9264 , FP:  138179 , FN: 5925 , P: 6.2831060138494195 , R: 60.99150701165317 , F1: 11.392591863839833
Ce a dat pe validare
5 3261 7061 71.3671086135745 53.51241029692541

Best threshold 4
Confusion matrix
TP: 8128, TN: 499105, FP: 3261, FN: 7061, FNR: 0.46487589703074594, FPR: 0.006491283247672016
Precision: 71.367%, Recall: 53.512%, F1-measure: 61.163%, Specificity: 0.994
--------------------------UNIQUE TEST SEQUENCES------------------------------------
Ce a dat pe validare
6 1212 1016 68.8030888030888 72.45866088370832

Best threshold 5
Confusion matrix
TP: 2673, TN: 11847, FP: 1212, FN: 1016, FNR: 0.2754133911629168, FPR: 0.09280955662761314
Precision: 68.803%, Recall: 72.459%, F1-measure: 70.584%, Specificity: 0.907, Lead time: 14.681
elapsed_time: 444.8177840709686
Log saved

Starting EPOCH: 7 | phase: train | ⏰: 13:58:34 | Learning rate: 0.001000
Train loss: 0.33185998 - Train acc: 0.88 - Train kurtosis: 0.88 - Train skewness: -1.52: 100%|██████████| 477/477 [02:31<00:00,  3.14it/s]
Eliminated instances percentage:  0.1825211351914262 89036/487812
Eliminated anomalies percentage:  0.06906195246866437 6149/89036

Starting epoch: 7 | phase: valid | ⏰: 14:01:07
: 100%|██████████| 53/53 [00:05<00:00,  9.87it/s]

Validation loss: 0.31153162133018925 Validation accuracy: 0.881090754783122 Validation kurtosis: 1.0469721555709839 Validation skewness: -1.5653432607650757
Save model checkpoint at dataset/hdfs/deeplog/deeplog.pth
======== My contribution ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/train.pkl
Length test 57506
Nr secvente unice train: normale vs anormale
3773 607
: 100%|██████████| 107/107 [00:08<00:00, 12.32it/s]
: 100%|██████████| 19/19 [00:01<00:00, 18.09it/s]
------------------------JUST NORMAL FOR ELBOW TRAIN SEQUENCES----------------------------
For g  34  train metrics, TP:  1 , FP:  0 , FN: 1648 , P: 100.0 , R: 0.06064281382656155 , F1: 0.1212121212121212
For g  33  train metrics, TP:  1 , FP:  0 , FN: 1648 , P: 100.0 , R: 0.06064281382656155 , F1: 0.1212121212121212
For g  32  train metrics, TP:  2 , FP:  0 , FN: 1647 , P: 100.0 , R: 0.1212856276531231 , F1: 0.24227740763173833
For g  31  train metrics, TP:  3 , FP:  0 , FN: 1646 , P: 100.0 , R: 0.18192844147968465 , F1: 0.36319612590799033
For g  30  train metrics, TP:  5 , FP:  0 , FN: 1644 , P: 100.0 , R: 0.30321406913280774 , F1: 0.6045949214026602
For g  29  train metrics, TP:  5 , FP:  0 , FN: 1644 , P: 100.0 , R: 0.30321406913280774 , F1: 0.6045949214026602
For g  28  train metrics, TP:  5 , FP:  0 , FN: 1644 , P: 100.0 , R: 0.30321406913280774 , F1: 0.6045949214026602
For g  27  train metrics, TP:  5 , FP:  0 , FN: 1644 , P: 100.0 , R: 0.30321406913280774 , F1: 0.6045949214026602
For g  26  train metrics, TP:  5 , FP:  0 , FN: 1644 , P: 100.0 , R: 0.30321406913280774 , F1: 0.6045949214026602
For g  25  train metrics, TP:  5 , FP:  0 , FN: 1644 , P: 100.0 , R: 0.30321406913280774 , F1: 0.6045949214026602
For g  24  train metrics, TP:  6 , FP:  0 , FN: 1643 , P: 100.0 , R: 0.3638568829593693 , F1: 0.7250755287009063
For g  23  train metrics, TP:  6 , FP:  0 , FN: 1643 , P: 100.0 , R: 0.3638568829593693 , F1: 0.7250755287009063
For g  22  train metrics, TP:  7 , FP:  0 , FN: 1642 , P: 100.0 , R: 0.42449969678593086 , F1: 0.8454106280193237
For g  21  train metrics, TP:  7 , FP:  0 , FN: 1642 , P: 100.0 , R: 0.42449969678593086 , F1: 0.8454106280193237
For g  20  train metrics, TP:  8 , FP:  0 , FN: 1641 , P: 100.0 , R: 0.4851425106124924 , F1: 0.9656004828002414
For g  19  train metrics, TP:  9 , FP:  0 , FN: 1640 , P: 100.0 , R: 0.5457853244390539 , F1: 1.0856453558504222
For g  18  train metrics, TP:  12 , FP:  0 , FN: 1637 , P: 100.0 , R: 0.7277137659187386 , F1: 1.4449127031908489
For g  17  train metrics, TP:  12 , FP:  0 , FN: 1637 , P: 100.0 , R: 0.7277137659187386 , F1: 1.4449127031908489
For g  16  train metrics, TP:  12 , FP:  1 , FN: 1637 , P: 92.3076923076923 , R: 0.7277137659187386 , F1: 1.444043321299639
For g  15  train metrics, TP:  21 , FP:  1 , FN: 1628 , P: 95.45454545454545 , R: 1.2734990903577925 , F1: 2.5134649910233393
For g  14  train metrics, TP:  56 , FP:  2 , FN: 1593 , P: 96.55172413793103 , R: 3.395997574287447 , F1: 6.561218512009373
For g  13  train metrics, TP:  111 , FP:  4 , FN: 1538 , P: 96.52173913043478 , R: 6.731352334748332 , F1: 12.585034013605442
For g  12  train metrics, TP:  142 , FP:  7 , FN: 1507 , P: 95.30201342281879 , R: 8.61127956337174 , F1: 15.795328142380422
For g  11  train metrics, TP:  157 , FP:  32 , FN: 1492 , P: 83.06878306878306 , R: 9.520921770770164 , F1: 17.08378672470076
For g  10  train metrics, TP:  170 , FP:  59 , FN: 1479 , P: 74.23580786026201 , R: 10.309278350515465 , F1: 18.10436634717785
For g  9  train metrics, TP:  267 , FP:  157 , FN: 1382 , P: 62.971698113207545 , R: 16.191631291691934 , F1: 25.759768451519534
For g  8  train metrics, TP:  297 , FP:  185 , FN: 1352 , P: 61.61825726141079 , R: 18.01091570648878 , F1: 27.874237447207886
For g  7  train metrics, TP:  309 , FP:  215 , FN: 1340 , P: 58.969465648854964 , R: 18.73862947240752 , F1: 28.439944776806257
For g  6  train metrics, TP:  350 , FP:  238 , FN: 1299 , P: 59.523809523809526 , R: 21.224984839296543 , F1: 31.291908806437192
For g  5  train metrics, TP:  507 , FP:  317 , FN: 1142 , P: 61.529126213592235 , R: 30.745906610066708 , F1: 41.002830570157705
For g  4  train metrics, TP:  590 , FP:  372 , FN: 1059 , P: 61.33056133056133 , R: 35.77926015767132 , F1: 45.19341248563769
For g  3  train metrics, TP:  597 , FP:  379 , FN: 1052 , P: 61.16803278688525 , R: 36.203759854457246 , F1: 45.48571428571429
For g  2  train metrics, TP:  780 , FP:  7072 , FN: 869 , P: 9.933774834437086 , R: 47.30139478471801 , F1: 16.419324281654564
For g  1  train metrics, TP:  989 , FP:  14565 , FN: 660 , P: 6.358492992156359 , R: 59.975742874469375 , F1: 11.497994535836773
Ce a dat pe train
4 379 1052 61.16803278688525 36.203759854457246

[1, 1, 2, 3, 5, 5, 5, 5, 5, 5, 6, 6, 7, 7, 8, 9, 12, 12, 13, 22, 58, 115, 149, 189, 229, 424, 482, 524, 588, 824, 962, 976, 7852, 15554]
Changes in number of anomalies
Pentru g 33 anomalies diff:0
Pentru g 32 anomalies diff:1
Pentru g 31 anomalies diff:1
Pentru g 30 anomalies diff:2
Pentru g 29 anomalies diff:0
Pentru g 28 anomalies diff:0
Pentru g 27 anomalies diff:0
Pentru g 26 anomalies diff:0
Pentru g 25 anomalies diff:0
Pentru g 24 anomalies diff:1
Pentru g 23 anomalies diff:0
Pentru g 22 anomalies diff:1
Pentru g 21 anomalies diff:0
Pentru g 20 anomalies diff:1
Pentru g 19 anomalies diff:1
Pentru g 18 anomalies diff:3
Pentru g 17 anomalies diff:0
Pentru g 16 anomalies diff:1
Pentru g 15 anomalies diff:9
Pentru g 14 anomalies diff:36
Pentru g 13 anomalies diff:57
Pentru g 12 anomalies diff:34
Pentru g 11 anomalies diff:40
Pentru g 10 anomalies diff:40
Pentru g 9 anomalies diff:195
Pentru g 8 anomalies diff:58
Pentru g 7 anomalies diff:42
Pentru g 6 anomalies diff:64
Pentru g 5 anomalies diff:236
Pentru g 4 anomalies diff:138
Pentru g 3 anomalies diff:14
Pentru g 2 anomalies diff:6876
Pentru g 1 anomalies diff:7702
elapsed_time: 47.75628924369812
======== Their approach ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/test.pkl
Length test 517555
Nr secvente unice test: normale vs anormale
13059 3689
: 100%|██████████| 389/389 [00:37<00:00, 10.39it/s]
: 100%|██████████| 120/120 [00:10<00:00, 11.26it/s]
------------------------NORMAL TEST SEQUENCES----------------------------
For g  34  test metrics, TP:  47 , FP:  0 , FN: 15142 , P: 100.0 , R: 0.30943445914806766 , F1: 0.6169598319768967
For g  33  test metrics, TP:  47 , FP:  0 , FN: 15142 , P: 100.0 , R: 0.30943445914806766 , F1: 0.6169598319768967
For g  32  test metrics, TP:  54 , FP:  0 , FN: 15135 , P: 100.0 , R: 0.35552044242543945 , F1: 0.7085219444991142
For g  31  test metrics, TP:  59 , FP:  0 , FN: 15130 , P: 100.0 , R: 0.38843900190927644 , F1: 0.7738719832109129
For g  30  test metrics, TP:  75 , FP:  0 , FN: 15114 , P: 100.0 , R: 0.4937783922575548 , F1: 0.9827044025157232
For g  29  test metrics, TP:  78 , FP:  0 , FN: 15111 , P: 100.0 , R: 0.513529527947857 , F1: 1.0218117508351348
For g  28  test metrics, TP:  94 , FP:  0 , FN: 15095 , P: 100.0 , R: 0.6188689182961353 , F1: 1.2301249754629326
For g  27  test metrics, TP:  99 , FP:  0 , FN: 15090 , P: 100.0 , R: 0.6517874777799724 , F1: 1.2951334379905808
For g  26  test metrics, TP:  104 , FP:  0 , FN: 15085 , P: 100.0 , R: 0.6847060372638093 , F1: 1.3600993918786373
For g  25  test metrics, TP:  106 , FP:  1 , FN: 15083 , P: 99.06542056074767 , R: 0.6978734610573442 , F1: 1.3859832635983265
For g  24  test metrics, TP:  107 , FP:  1 , FN: 15082 , P: 99.07407407407408 , R: 0.7044571729541115 , F1: 1.3989671177355036
For g  23  test metrics, TP:  114 , FP:  1 , FN: 15075 , P: 99.1304347826087 , R: 0.7505431562314833 , F1: 1.4898065865133299
For g  22  test metrics, TP:  124 , FP:  1 , FN: 15065 , P: 99.2 , R: 0.8163802751991572 , F1: 1.6194331983805668
For g  21  test metrics, TP:  129 , FP:  2 , FN: 15060 , P: 98.47328244274809 , R: 0.8492988346829943 , F1: 1.6840731070496084
For g  20  test metrics, TP:  130 , FP:  3 , FN: 15059 , P: 97.74436090225564 , R: 0.8558825465797617 , F1: 1.6969064090849757
For g  19  test metrics, TP:  137 , FP:  4 , FN: 15052 , P: 97.16312056737588 , R: 0.9019685298571335 , F1: 1.787345075016308
For g  18  test metrics, TP:  147 , FP:  4 , FN: 15042 , P: 97.35099337748345 , R: 0.9678056488248075 , F1: 1.9165580182529334
For g  17  test metrics, TP:  149 , FP:  4 , FN: 15040 , P: 97.38562091503267 , R: 0.9809730726183422 , F1: 1.9423803936905226
For g  16  test metrics, TP:  154 , FP:  16 , FN: 15035 , P: 90.58823529411765 , R: 1.0138916321021791 , F1: 2.0053388892506026
For g  15  test metrics, TP:  180 , FP:  27 , FN: 15009 , P: 86.95652173913044 , R: 1.1850681414181314 , F1: 2.338269680436477
For g  14  test metrics, TP:  503 , FP:  42 , FN: 14686 , P: 92.29357798165138 , R: 3.311607084074001 , F1: 6.393796873013856
For g  13  test metrics, TP:  937 , FP:  59 , FN: 14252 , P: 94.07630522088354 , R: 6.168938047271052 , F1: 11.57862218103182
For g  12  test metrics, TP:  1242 , FP:  119 , FN: 13947 , P: 91.25642909625276 , R: 8.176970175785108 , F1: 15.009063444108763
For g  11  test metrics, TP:  1351 , FP:  414 , FN: 13838 , P: 76.54390934844193 , R: 8.894594772532754 , F1: 15.937241948802644
For g  10  test metrics, TP:  1457 , FP:  664 , FN: 13732 , P: 68.69401225836869 , R: 9.592468233590099 , F1: 16.83419988445985
For g  9  test metrics, TP:  2351 , FP:  1487 , FN: 12838 , P: 61.255862428348095 , R: 15.478306669300151 , F1: 24.712251011720188
For g  8  test metrics, TP:  2571 , FP:  1677 , FN: 12618 , P: 60.5225988700565 , R: 16.926723286588977 , F1: 26.45469979935175
For g  7  test metrics, TP:  2733 , FP:  1891 , FN: 12456 , P: 59.10467128027682 , R: 17.993284613865296 , F1: 27.58794730732347
For g  6  test metrics, TP:  3161 , FP:  2030 , FN: 12028 , P: 60.89385474860335 , R: 20.811113305681744 , F1: 31.02060843964671
For g  5  test metrics, TP:  4721 , FP:  2666 , FN: 10468 , P: 63.90957086774063 , R: 31.081703864638882 , F1: 41.82317505315379
For g  4  test metrics, TP:  5459 , FP:  3206 , FN: 9730 , P: 63.00057703404501 , R: 35.940483244453226 , F1: 45.770101450490486
For g  3  test metrics, TP:  5475 , FP:  3275 , FN: 9714 , P: 62.57142857142857 , R: 36.0458226348015 , F1: 45.7412590333765
For g  2  test metrics, TP:  7149 , FP:  62386 , FN: 8040 , P: 10.281153375997699 , R: 47.06695634999012 , F1: 16.875973750059014
For g  1  test metrics, TP:  9172 , FP:  129568 , FN: 6017 , P: 6.610926913651435 , R: 60.38580551715057 , F1: 11.917182597171422
Ce a dat pe validare
5 3206 9730 63.00057703404501 35.940483244453226

Best threshold 4
Confusion matrix
TP: 5459, TN: 499160, FP: 3206, FN: 9730, FNR: 0.6405951675554677, FPR: 0.006381801316171875
Precision: 63.001%, Recall: 35.940%, F1-measure: 45.770%, Specificity: 0.994
--------------------------UNIQUE TEST SEQUENCES------------------------------------
Ce a dat pe validare
5 1201 1019 68.97442521312323 72.377338031987

Best threshold 4
Confusion matrix
TP: 2670, TN: 11858, FP: 1201, FN: 1019, FNR: 0.2762266196801301, FPR: 0.0919672256681216
Precision: 68.974%, Recall: 72.377%, F1-measure: 70.635%, Specificity: 0.908, Lead time: 14.268
elapsed_time: 469.19413685798645
Log saved

Starting EPOCH: 8 | phase: train | ⏰: 14:09:57 | Learning rate: 0.001000
Train loss: 0.30415396 - Train acc: 0.88 - Train kurtosis: 1.17 - Train skewness: -1.60: 100%|██████████| 477/477 [02:52<00:00,  2.76it/s]
Eliminated instances percentage:  0.17445040302411585 85099/487812
Eliminated anomalies percentage:  0.06824992068061904 5808/85099

Starting epoch: 8 | phase: valid | ⏰: 14:12:51
: 100%|██████████| 53/53 [00:06<00:00,  8.08it/s]

Validation loss: 0.2895174279527844 Validation accuracy: 0.890297226988432 Validation kurtosis: 1.4732158184051514 Validation skewness: -1.6712379455566406
Save model checkpoint at dataset/hdfs/deeplog/deeplog.pth
======== My contribution ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/train.pkl
Length test 57506
Nr secvente unice train: normale vs anormale
3773 607
: 100%|██████████| 107/107 [00:11<00:00,  8.99it/s]
: 100%|██████████| 19/19 [00:01<00:00, 15.06it/s]
------------------------JUST NORMAL FOR ELBOW TRAIN SEQUENCES----------------------------
For g  34  train metrics, TP:  2 , FP:  0 , FN: 1647 , P: 100.0 , R: 0.1212856276531231 , F1: 0.24227740763173833
For g  33  train metrics, TP:  2 , FP:  0 , FN: 1647 , P: 100.0 , R: 0.1212856276531231 , F1: 0.24227740763173833
For g  32  train metrics, TP:  2 , FP:  0 , FN: 1647 , P: 100.0 , R: 0.1212856276531231 , F1: 0.24227740763173833
For g  31  train metrics, TP:  2 , FP:  0 , FN: 1647 , P: 100.0 , R: 0.1212856276531231 , F1: 0.24227740763173833
For g  30  train metrics, TP:  2 , FP:  0 , FN: 1647 , P: 100.0 , R: 0.1212856276531231 , F1: 0.24227740763173833
For g  29  train metrics, TP:  3 , FP:  0 , FN: 1646 , P: 100.0 , R: 0.18192844147968465 , F1: 0.36319612590799033
For g  28  train metrics, TP:  5 , FP:  0 , FN: 1644 , P: 100.0 , R: 0.30321406913280774 , F1: 0.6045949214026602
For g  27  train metrics, TP:  5 , FP:  0 , FN: 1644 , P: 100.0 , R: 0.30321406913280774 , F1: 0.6045949214026602
For g  26  train metrics, TP:  5 , FP:  0 , FN: 1644 , P: 100.0 , R: 0.30321406913280774 , F1: 0.6045949214026602
For g  25  train metrics, TP:  6 , FP:  0 , FN: 1643 , P: 100.0 , R: 0.3638568829593693 , F1: 0.7250755287009063
For g  24  train metrics, TP:  6 , FP:  0 , FN: 1643 , P: 100.0 , R: 0.3638568829593693 , F1: 0.7250755287009063
For g  23  train metrics, TP:  6 , FP:  0 , FN: 1643 , P: 100.0 , R: 0.3638568829593693 , F1: 0.7250755287009063
For g  22  train metrics, TP:  6 , FP:  0 , FN: 1643 , P: 100.0 , R: 0.3638568829593693 , F1: 0.7250755287009063
For g  21  train metrics, TP:  6 , FP:  0 , FN: 1643 , P: 100.0 , R: 0.3638568829593693 , F1: 0.7250755287009063
For g  20  train metrics, TP:  9 , FP:  0 , FN: 1640 , P: 100.0 , R: 0.5457853244390539 , F1: 1.0856453558504222
For g  19  train metrics, TP:  10 , FP:  0 , FN: 1639 , P: 100.0 , R: 0.6064281382656155 , F1: 1.2055455093429777
For g  18  train metrics, TP:  10 , FP:  0 , FN: 1639 , P: 100.0 , R: 0.6064281382656155 , F1: 1.2055455093429777
For g  17  train metrics, TP:  12 , FP:  0 , FN: 1637 , P: 100.0 , R: 0.7277137659187386 , F1: 1.4449127031908489
For g  16  train metrics, TP:  13 , FP:  0 , FN: 1636 , P: 100.0 , R: 0.7883565797453002 , F1: 1.5643802647412757
For g  15  train metrics, TP:  21 , FP:  0 , FN: 1628 , P: 100.0 , R: 1.2734990903577925 , F1: 2.5149700598802394
For g  14  train metrics, TP:  22 , FP:  3 , FN: 1627 , P: 88.0 , R: 1.334141904184354 , F1: 2.6284348864994027
For g  13  train metrics, TP:  25 , FP:  4 , FN: 1624 , P: 86.20689655172414 , R: 1.5160703456640388 , F1: 2.9797377830750893
For g  12  train metrics, TP:  61 , FP:  6 , FN: 1588 , P: 91.04477611940298 , R: 3.699211643420255 , F1: 7.109557109557111
For g  11  train metrics, TP:  95 , FP:  17 , FN: 1554 , P: 84.82142857142857 , R: 5.761067313523347 , F1: 10.789324247586599
For g  10  train metrics, TP:  142 , FP:  47 , FN: 1507 , P: 75.13227513227513 , R: 8.61127956337174 , F1: 15.45157780195865
For g  9  train metrics, TP:  266 , FP:  108 , FN: 1383 , P: 71.12299465240642 , R: 16.130988477865372 , F1: 26.29757785467128
For g  8  train metrics, TP:  288 , FP:  137 , FN: 1361 , P: 67.76470588235294 , R: 17.465130382049725 , F1: 27.772420443587272
For g  7  train metrics, TP:  309 , FP:  189 , FN: 1340 , P: 62.04819277108434 , R: 18.73862947240752 , F1: 28.784350256171404
For g  6  train metrics, TP:  355 , FP:  238 , FN: 1294 , P: 59.86509274873524 , R: 21.528198908429353 , F1: 31.668153434433545
For g  5  train metrics, TP:  393 , FP:  267 , FN: 1256 , P: 59.54545454545455 , R: 23.83262583383869 , F1: 34.04071026418363
For g  4  train metrics, TP:  471 , FP:  368 , FN: 1178 , P: 56.13825983313468 , R: 28.562765312310493 , F1: 37.861736334405144
For g  3  train metrics, TP:  594 , FP:  381 , FN: 1055 , P: 60.92307692307692 , R: 36.02183141297756 , F1: 45.27439024390243
For g  2  train metrics, TP:  646 , FP:  6529 , FN: 1003 , P: 9.003484320557492 , R: 39.175257731958766 , F1: 14.641885766092477
For g  1  train metrics, TP:  825 , FP:  13348 , FN: 824 , P: 5.820927114936851 , R: 50.03032140691328 , F1: 10.428517254455821
Ce a dat pe train
4 381 1055 60.92307692307692 36.02183141297756

[2, 2, 2, 2, 2, 3, 5, 5, 5, 6, 6, 6, 6, 6, 9, 10, 10, 12, 13, 21, 25, 29, 67, 112, 189, 374, 425, 498, 593, 660, 839, 975, 7175, 14173]
Changes in number of anomalies
Pentru g 33 anomalies diff:0
Pentru g 32 anomalies diff:0
Pentru g 31 anomalies diff:0
Pentru g 30 anomalies diff:0
Pentru g 29 anomalies diff:1
Pentru g 28 anomalies diff:2
Pentru g 27 anomalies diff:0
Pentru g 26 anomalies diff:0
Pentru g 25 anomalies diff:1
Pentru g 24 anomalies diff:0
Pentru g 23 anomalies diff:0
Pentru g 22 anomalies diff:0
Pentru g 21 anomalies diff:0
Pentru g 20 anomalies diff:3
Pentru g 19 anomalies diff:1
Pentru g 18 anomalies diff:0
Pentru g 17 anomalies diff:2
Pentru g 16 anomalies diff:1
Pentru g 15 anomalies diff:8
Pentru g 14 anomalies diff:4
Pentru g 13 anomalies diff:4
Pentru g 12 anomalies diff:38
Pentru g 11 anomalies diff:45
Pentru g 10 anomalies diff:77
Pentru g 9 anomalies diff:185
Pentru g 8 anomalies diff:51
Pentru g 7 anomalies diff:73
Pentru g 6 anomalies diff:95
Pentru g 5 anomalies diff:67
Pentru g 4 anomalies diff:179
Pentru g 3 anomalies diff:136
Pentru g 2 anomalies diff:6200
Pentru g 1 anomalies diff:6998
elapsed_time: 56.062857151031494
======== Their approach ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/test.pkl
Length test 517555
Nr secvente unice test: normale vs anormale
13059 3689
: 100%|██████████| 389/389 [00:32<00:00, 11.86it/s]
: 100%|██████████| 120/120 [00:09<00:00, 12.07it/s]
------------------------NORMAL TEST SEQUENCES----------------------------
For g  34  test metrics, TP:  33 , FP:  0 , FN: 15156 , P: 100.0 , R: 0.2172624925933241 , F1: 0.43358297201419005
For g  33  test metrics, TP:  33 , FP:  0 , FN: 15156 , P: 100.0 , R: 0.2172624925933241 , F1: 0.43358297201419005
For g  32  test metrics, TP:  37 , FP:  0 , FN: 15152 , P: 100.0 , R: 0.2435973401803937 , F1: 0.4860107710495205
For g  31  test metrics, TP:  39 , FP:  0 , FN: 15150 , P: 100.0 , R: 0.2567647639739285 , F1: 0.512214342001576
For g  30  test metrics, TP:  47 , FP:  0 , FN: 15142 , P: 100.0 , R: 0.30943445914806766 , F1: 0.6169598319768967
For g  29  test metrics, TP:  55 , FP:  0 , FN: 15134 , P: 100.0 , R: 0.3621041543222069 , F1: 0.7215953817895565
For g  28  test metrics, TP:  70 , FP:  1 , FN: 15119 , P: 98.59154929577464 , R: 0.46085983277371784 , F1: 0.9174311926605504
For g  27  test metrics, TP:  76 , FP:  2 , FN: 15113 , P: 97.43589743589743 , R: 0.5003621041543223 , F1: 0.9956114495316698
For g  26  test metrics, TP:  92 , FP:  2 , FN: 15097 , P: 97.87234042553192 , R: 0.6057014945026006 , F1: 1.2039521036445726
For g  25  test metrics, TP:  95 , FP:  2 , FN: 15094 , P: 97.9381443298969 , R: 0.6254526301929028 , F1: 1.242967421169698
For g  24  test metrics, TP:  96 , FP:  3 , FN: 15093 , P: 96.96969696969697 , R: 0.6320363420896702 , F1: 1.2558869701726845
For g  23  test metrics, TP:  99 , FP:  3 , FN: 15090 , P: 97.05882352941177 , R: 0.6517874777799724 , F1: 1.2948793407886992
For g  22  test metrics, TP:  105 , FP:  3 , FN: 15084 , P: 97.22222222222223 , R: 0.6912897491605767 , F1: 1.3728181996469897
For g  21  test metrics, TP:  118 , FP:  3 , FN: 15071 , P: 97.52066115702479 , R: 0.7768780038185529 , F1: 1.5414761593729587
For g  20  test metrics, TP:  121 , FP:  4 , FN: 15068 , P: 96.8 , R: 0.796629139508855 , F1: 1.5802533629358757
For g  19  test metrics, TP:  129 , FP:  4 , FN: 15060 , P: 96.99248120300751 , R: 0.8492988346829943 , F1: 1.6838532828612451
For g  18  test metrics, TP:  139 , FP:  4 , FN: 15050 , P: 97.2027972027972 , R: 0.9151359536506682 , F1: 1.8132011479259067
For g  17  test metrics, TP:  151 , FP:  4 , FN: 15038 , P: 97.41935483870968 , R: 0.994140496411877 , F1: 1.9681960375391032
For g  16  test metrics, TP:  156 , FP:  13 , FN: 15033 , P: 92.3076923076923 , R: 1.027059055895714 , F1: 2.0315145201198073
For g  15  test metrics, TP:  185 , FP:  15 , FN: 15004 , P: 92.5 , R: 1.2179867009019685 , F1: 2.404314770290467
For g  14  test metrics, TP:  196 , FP:  50 , FN: 14993 , P: 79.67479674796748 , R: 1.2904075317664099 , F1: 2.5396825396825395
For g  13  test metrics, TP:  234 , FP:  63 , FN: 14955 , P: 78.78787878787878 , R: 1.5405885838435711 , F1: 3.0220844633862844
For g  12  test metrics, TP:  563 , FP:  102 , FN: 14626 , P: 84.66165413533835 , R: 3.7066297978800447 , F1: 7.102308565661663
For g  11  test metrics, TP:  834 , FP:  241 , FN: 14355 , P: 77.5813953488372 , R: 5.49081572190401 , F1: 10.255779636005903
For g  10  test metrics, TP:  1263 , FP:  515 , FN: 13926 , P: 71.03487064116986 , R: 8.315228125617223 , F1: 14.887723227441503
For g  9  test metrics, TP:  2330 , FP:  1036 , FN: 12859 , P: 69.22162804515746 , R: 15.340048719468037 , F1: 25.11452438695769
For g  8  test metrics, TP:  2544 , FP:  1305 , FN: 12645 , P: 66.09508963367108 , R: 16.74896306537626 , F1: 26.72549637566971
For g  7  test metrics, TP:  2756 , FP:  1749 , FN: 12433 , P: 61.1764705882353 , R: 18.14470998749095 , F1: 27.988219762364174
For g  6  test metrics, TP:  3195 , FP:  2079 , FN: 11994 , P: 60.580204778157 , R: 21.034959510171834 , F1: 31.22709280164199
For g  5  test metrics, TP:  3649 , FP:  2311 , FN: 11540 , P: 61.2248322147651 , R: 24.023964711304234 , F1: 34.50754172774127
For g  4  test metrics, TP:  4363 , FP:  3181 , FN: 10826 , P: 57.834040296924705 , R: 28.724735005596155 , F1: 38.38472704878371
For g  3  test metrics, TP:  5457 , FP:  3297 , FN: 9732 , P: 62.33721727210418 , R: 35.927315820659686 , F1: 45.583260243077305
For g  2  test metrics, TP:  5942 , FP:  57659 , FN: 9247 , P: 9.342620399050329 , R: 39.120416090591874 , F1: 15.083132377205226
For g  1  test metrics, TP:  7620 , FP:  118290 , FN: 7569 , P: 6.051941863235644 , R: 50.167884653367565 , F1: 10.800927008696021
Ce a dat pe validare
4 3297 9732 62.33721727210418 35.927315820659686

Best threshold 3
Confusion matrix
TP: 5457, TN: 499069, FP: 3297, FN: 9732, FNR: 0.6407268417934031, FPR: 0.00656294414829029
Precision: 62.337%, Recall: 35.927%, F1-measure: 45.583%, Specificity: 0.993
--------------------------UNIQUE TEST SEQUENCES------------------------------------
Ce a dat pe validare
4 1267 1010 67.89153573238723 72.62130658715098

Best threshold 3
Confusion matrix
TP: 2679, TN: 11792, FP: 1267, FN: 1010, FNR: 0.2737869341284901, FPR: 0.09702121142507084
Precision: 67.892%, Recall: 72.621%, F1-measure: 70.177%, Specificity: 0.903, Lead time: 11.917
elapsed_time: 475.4025411605835
Log saved

Starting EPOCH: 9 | phase: train | ⏰: 14:21:57 | Learning rate: 0.001000
Train loss: 0.28359758 - Train acc: 0.89 - Train kurtosis: 1.56 - Train skewness: -1.69: 100%|██████████| 477/477 [03:01<00:00,  2.63it/s]
Eliminated instances percentage:  0.16629767205398802 81122/487812
Eliminated anomalies percentage:  0.06943862330810384 5633/81122

Starting epoch: 9 | phase: valid | ⏰: 14:25:00
: 100%|██████████| 53/53 [00:06<00:00,  8.45it/s]

Validation loss: 0.2698332166896676 Validation accuracy: 0.9014778325123153 Validation kurtosis: 1.986900806427002 Validation skewness: -1.781813383102417
Save model checkpoint at dataset/hdfs/deeplog/deeplog.pth
======== My contribution ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/train.pkl
Length test 57506
Nr secvente unice train: normale vs anormale
3773 607
: 100%|██████████| 107/107 [00:09<00:00, 11.02it/s]
: 100%|██████████| 19/19 [00:01<00:00, 14.15it/s]
------------------------JUST NORMAL FOR ELBOW TRAIN SEQUENCES----------------------------
For g  34  train metrics, TP:  2 , FP:  0 , FN: 1647 , P: 100.0 , R: 0.1212856276531231 , F1: 0.24227740763173833
For g  33  train metrics, TP:  2 , FP:  0 , FN: 1647 , P: 100.0 , R: 0.1212856276531231 , F1: 0.24227740763173833
For g  32  train metrics, TP:  2 , FP:  0 , FN: 1647 , P: 100.0 , R: 0.1212856276531231 , F1: 0.24227740763173833
For g  31  train metrics, TP:  3 , FP:  0 , FN: 1646 , P: 100.0 , R: 0.18192844147968465 , F1: 0.36319612590799033
For g  30  train metrics, TP:  3 , FP:  0 , FN: 1646 , P: 100.0 , R: 0.18192844147968465 , F1: 0.36319612590799033
For g  29  train metrics, TP:  3 , FP:  0 , FN: 1646 , P: 100.0 , R: 0.18192844147968465 , F1: 0.36319612590799033
For g  28  train metrics, TP:  3 , FP:  0 , FN: 1646 , P: 100.0 , R: 0.18192844147968465 , F1: 0.36319612590799033
For g  27  train metrics, TP:  3 , FP:  0 , FN: 1646 , P: 100.0 , R: 0.18192844147968465 , F1: 0.36319612590799033
For g  26  train metrics, TP:  4 , FP:  0 , FN: 1645 , P: 100.0 , R: 0.2425712553062462 , F1: 0.4839685420447671
For g  25  train metrics, TP:  5 , FP:  0 , FN: 1644 , P: 100.0 , R: 0.30321406913280774 , F1: 0.6045949214026602
For g  24  train metrics, TP:  5 , FP:  0 , FN: 1644 , P: 100.0 , R: 0.30321406913280774 , F1: 0.6045949214026602
For g  23  train metrics, TP:  7 , FP:  0 , FN: 1642 , P: 100.0 , R: 0.42449969678593086 , F1: 0.8454106280193237
For g  22  train metrics, TP:  7 , FP:  0 , FN: 1642 , P: 100.0 , R: 0.42449969678593086 , F1: 0.8454106280193237
For g  21  train metrics, TP:  7 , FP:  0 , FN: 1642 , P: 100.0 , R: 0.42449969678593086 , F1: 0.8454106280193237
For g  20  train metrics, TP:  8 , FP:  0 , FN: 1641 , P: 100.0 , R: 0.4851425106124924 , F1: 0.9656004828002414
For g  19  train metrics, TP:  9 , FP:  0 , FN: 1640 , P: 100.0 , R: 0.5457853244390539 , F1: 1.0856453558504222
For g  18  train metrics, TP:  9 , FP:  0 , FN: 1640 , P: 100.0 , R: 0.5457853244390539 , F1: 1.0856453558504222
For g  17  train metrics, TP:  12 , FP:  0 , FN: 1637 , P: 100.0 , R: 0.7277137659187386 , F1: 1.4449127031908489
For g  16  train metrics, TP:  12 , FP:  0 , FN: 1637 , P: 100.0 , R: 0.7277137659187386 , F1: 1.4449127031908489
For g  15  train metrics, TP:  14 , FP:  0 , FN: 1635 , P: 100.0 , R: 0.8489993935718617 , F1: 1.6837041491280818
For g  14  train metrics, TP:  16 , FP:  1 , FN: 1633 , P: 94.11764705882354 , R: 0.9702850212249848 , F1: 1.9207683073229291
For g  13  train metrics, TP:  28 , FP:  2 , FN: 1621 , P: 93.33333333333333 , R: 1.6979987871437234 , F1: 3.3353186420488385
For g  12  train metrics, TP:  30 , FP:  2 , FN: 1619 , P: 93.75 , R: 1.8192844147968465 , F1: 3.5693039857227844
For g  11  train metrics, TP:  35 , FP:  11 , FN: 1614 , P: 76.08695652173913 , R: 2.1224984839296543 , F1: 4.129793510324483
For g  10  train metrics, TP:  103 , FP:  52 , FN: 1546 , P: 66.45161290322581 , R: 6.24620982413584 , F1: 11.419068736141906
For g  9  train metrics, TP:  206 , FP:  80 , FN: 1443 , P: 72.02797202797203 , R: 12.49241964827168 , F1: 21.29198966408269
For g  8  train metrics, TP:  242 , FP:  126 , FN: 1407 , P: 65.76086956521739 , R: 14.675560946027895 , F1: 23.996033713435793
For g  7  train metrics, TP:  266 , FP:  183 , FN: 1383 , P: 59.24276169265033 , R: 16.130988477865372 , F1: 25.357483317445187
For g  6  train metrics, TP:  335 , FP:  201 , FN: 1314 , P: 62.5 , R: 20.31534263189812 , F1: 30.66361556064073
For g  5  train metrics, TP:  392 , FP:  248 , FN: 1257 , P: 61.25 , R: 23.77198302001213 , F1: 34.25076452599388
For g  4  train metrics, TP:  469 , FP:  367 , FN: 1180 , P: 56.100478468899524 , R: 28.441479684657367 , F1: 37.74647887323944
For g  3  train metrics, TP:  476 , FP:  376 , FN: 1173 , P: 55.86854460093897 , R: 28.8659793814433 , F1: 38.064774090363855
For g  2  train metrics, TP:  643 , FP:  5870 , FN: 1006 , P: 9.872562567173345 , R: 38.993329290479075 , F1: 15.75594217103651
For g  1  train metrics, TP:  822 , FP:  12469 , FN: 827 , P: 6.184636219998495 , R: 49.8483929654336 , F1: 11.004016064257028
Ce a dat pe train
4 376 1173 55.86854460093897 28.8659793814433

[2, 2, 2, 3, 3, 3, 3, 3, 4, 5, 5, 7, 7, 7, 8, 9, 9, 12, 12, 14, 17, 30, 32, 46, 155, 286, 368, 449, 536, 640, 836, 852, 6513, 13291]
Changes in number of anomalies
Pentru g 33 anomalies diff:0
Pentru g 32 anomalies diff:0
Pentru g 31 anomalies diff:1
Pentru g 30 anomalies diff:0
Pentru g 29 anomalies diff:0
Pentru g 28 anomalies diff:0
Pentru g 27 anomalies diff:0
Pentru g 26 anomalies diff:1
Pentru g 25 anomalies diff:1
Pentru g 24 anomalies diff:0
Pentru g 23 anomalies diff:2
Pentru g 22 anomalies diff:0
Pentru g 21 anomalies diff:0
Pentru g 20 anomalies diff:1
Pentru g 19 anomalies diff:1
Pentru g 18 anomalies diff:0
Pentru g 17 anomalies diff:3
Pentru g 16 anomalies diff:0
Pentru g 15 anomalies diff:2
Pentru g 14 anomalies diff:3
Pentru g 13 anomalies diff:13
Pentru g 12 anomalies diff:2
Pentru g 11 anomalies diff:14
Pentru g 10 anomalies diff:109
Pentru g 9 anomalies diff:131
Pentru g 8 anomalies diff:82
Pentru g 7 anomalies diff:81
Pentru g 6 anomalies diff:87
Pentru g 5 anomalies diff:104
Pentru g 4 anomalies diff:196
Pentru g 3 anomalies diff:16
Pentru g 2 anomalies diff:5661
Pentru g 1 anomalies diff:6778
elapsed_time: 54.1031060218811
======== Their approach ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/test.pkl
Length test 517555
Nr secvente unice test: normale vs anormale
13059 3689
: 100%|██████████| 389/389 [00:36<00:00, 10.64it/s]
: 100%|██████████| 120/120 [00:10<00:00, 11.35it/s]
------------------------NORMAL TEST SEQUENCES----------------------------
For g  34  test metrics, TP:  29 , FP:  0 , FN: 15160 , P: 100.0 , R: 0.19092764500625453 , F1: 0.3811276120383756
For g  33  test metrics, TP:  29 , FP:  0 , FN: 15160 , P: 100.0 , R: 0.19092764500625453 , F1: 0.3811276120383756
For g  32  test metrics, TP:  32 , FP:  0 , FN: 15157 , P: 100.0 , R: 0.2106787806965567 , F1: 0.42047171670718086
For g  31  test metrics, TP:  36 , FP:  0 , FN: 15153 , P: 100.0 , R: 0.23701362828362632 , F1: 0.4729064039408868
For g  30  test metrics, TP:  41 , FP:  1 , FN: 15148 , P: 97.61904761904762 , R: 0.2699321877674633 , F1: 0.5383756811765478
For g  29  test metrics, TP:  43 , FP:  1 , FN: 15146 , P: 97.72727272727273 , R: 0.2830996115609981 , F1: 0.5645637760126042
For g  28  test metrics, TP:  50 , FP:  1 , FN: 15139 , P: 98.03921568627452 , R: 0.3291855948383699 , F1: 0.6561679790026247
For g  27  test metrics, TP:  56 , FP:  1 , FN: 15133 , P: 98.24561403508773 , R: 0.36868786621897426 , F1: 0.7346189164370982
For g  26  test metrics, TP:  59 , FP:  1 , FN: 15130 , P: 98.33333333333333 , R: 0.38843900190927644 , F1: 0.7738212341792905
For g  25  test metrics, TP:  86 , FP:  1 , FN: 15103 , P: 98.85057471264368 , R: 0.5661992231219962 , F1: 1.125949201361613
For g  24  test metrics, TP:  89 , FP:  1 , FN: 15100 , P: 98.88888888888889 , R: 0.5859503588122984 , F1: 1.1649977092741672
For g  23  test metrics, TP:  92 , FP:  1 , FN: 15097 , P: 98.9247311827957 , R: 0.6057014945026006 , F1: 1.2040308860096847
For g  22  test metrics, TP:  99 , FP:  2 , FN: 15090 , P: 98.01980198019803 , R: 0.6517874777799724 , F1: 1.2949640287769784
For g  21  test metrics, TP:  113 , FP:  2 , FN: 15076 , P: 98.26086956521739 , R: 0.743959444334716 , F1: 1.4767381076842656
For g  20  test metrics, TP:  123 , FP:  2 , FN: 15066 , P: 98.4 , R: 0.8097965633023899 , F1: 1.6063732532323365
For g  19  test metrics, TP:  135 , FP:  2 , FN: 15054 , P: 98.54014598540147 , R: 0.8888011060635986 , F1: 1.7617121231893513
For g  18  test metrics, TP:  138 , FP:  3 , FN: 15051 , P: 97.87234042553192 , R: 0.9085522417539008 , F1: 1.8003913894324854
For g  17  test metrics, TP:  144 , FP:  3 , FN: 15045 , P: 97.95918367346938 , R: 0.9480545131345053 , F1: 1.8779342723004695
For g  16  test metrics, TP:  155 , FP:  5 , FN: 15034 , P: 96.875 , R: 1.0204753439989467 , F1: 2.0196755488956937
For g  15  test metrics, TP:  189 , FP:  8 , FN: 15000 , P: 95.93908629441624 , R: 1.2443215484890382 , F1: 2.4567788898999092
For g  14  test metrics, TP:  202 , FP:  36 , FN: 14987 , P: 84.87394957983193 , R: 1.3299098031470142 , F1: 2.6187852466454915
For g  13  test metrics, TP:  245 , FP:  57 , FN: 14944 , P: 81.12582781456953 , R: 1.6130094147080123 , F1: 3.1631269769543597
For g  12  test metrics, TP:  264 , FP:  78 , FN: 14925 , P: 77.19298245614036 , R: 1.738099940746593 , F1: 3.3996523082866528
For g  11  test metrics, TP:  306 , FP:  209 , FN: 14883 , P: 59.41747572815534 , R: 2.0146158404108236 , F1: 3.8970962812022414
For g  10  test metrics, TP:  817 , FP:  495 , FN: 14372 , P: 62.271341463414636 , R: 5.378892619658964 , F1: 9.902430155748137
For g  9  test metrics, TP:  1786 , FP:  861 , FN: 13403 , P: 67.47261050245561 , R: 11.758509447626572 , F1: 20.026911863646557
For g  8  test metrics, TP:  2152 , FP:  1248 , FN: 13037 , P: 63.294117647058826 , R: 14.16814800184344 , F1: 23.153477863252466
For g  7  test metrics, TP:  2443 , FP:  1661 , FN: 12746 , P: 59.52729044834308 , R: 16.084008163802753 , F1: 25.32524749909294
For g  6  test metrics, TP:  3034 , FP:  1843 , FN: 12155 , P: 62.21037523067459 , R: 19.974981894792283 , F1: 30.240207315857667
For g  5  test metrics, TP:  3612 , FP:  2186 , FN: 11577 , P: 62.29734391169369 , R: 23.78036737112384 , F1: 34.4213084290275
For g  4  test metrics, TP:  4346 , FP:  3156 , FN: 10843 , P: 57.931218341775526 , R: 28.61281190335111 , F1: 38.30593627429377
For g  3  test metrics, TP:  4386 , FP:  3261 , FN: 10803 , P: 57.35582581404472 , R: 28.876160379221805 , F1: 38.41303205465056
For g  2  test metrics, TP:  5911 , FP:  51586 , FN: 9278 , P: 10.280536375810913 , R: 38.916321021792086 , F1: 16.26448009245247
For g  1  test metrics, TP:  7567 , FP:  110898 , FN: 7622 , P: 6.38754062381294 , R: 49.818947922838895 , F1: 11.323267541562542
Ce a dat pe validare
4 3261 10803 57.35582581404472 28.876160379221805

Best threshold 3
Confusion matrix
TP: 4386, TN: 499105, FP: 3261, FN: 10803, FNR: 0.711238396207782, FPR: 0.006491283247672016
Precision: 57.356%, Recall: 28.876%, F1-measure: 38.413%, Specificity: 0.994
--------------------------UNIQUE TEST SEQUENCES------------------------------------
Ce a dat pe validare
4 1239 1440 64.47821100917432 60.965031173759826

Best threshold 3
Confusion matrix
TP: 2249, TN: 11820, FP: 1239, FN: 1440, FNR: 0.39034968826240174, FPR: 0.09487709625545601
Precision: 64.478%, Recall: 60.965%, F1-measure: 62.672%, Specificity: 0.905, Lead time: 11.928
elapsed_time: 476.13668990135193
Log saved
plot done
=========================== Their approach ============================
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/test.pkl
Length test 517555
Nr secvente unice test: normale vs anormale
13059 3689
: 100%|██████████| 389/389 [00:36<00:00, 10.72it/s]
: 100%|██████████| 120/120 [00:07<00:00, 15.35it/s]
------------------------NORMAL TEST SEQUENCES----------------------------
For g  34  test metrics, TP:  29 , FP:  0 , FN: 15160 , P: 100.0 , R: 0.19092764500625453 , F1: 0.3811276120383756
For g  33  test metrics, TP:  29 , FP:  0 , FN: 15160 , P: 100.0 , R: 0.19092764500625453 , F1: 0.3811276120383756
For g  32  test metrics, TP:  32 , FP:  0 , FN: 15157 , P: 100.0 , R: 0.2106787806965567 , F1: 0.42047171670718086
For g  31  test metrics, TP:  36 , FP:  0 , FN: 15153 , P: 100.0 , R: 0.23701362828362632 , F1: 0.4729064039408868
For g  30  test metrics, TP:  41 , FP:  1 , FN: 15148 , P: 97.61904761904762 , R: 0.2699321877674633 , F1: 0.5383756811765478
For g  29  test metrics, TP:  43 , FP:  1 , FN: 15146 , P: 97.72727272727273 , R: 0.2830996115609981 , F1: 0.5645637760126042
For g  28  test metrics, TP:  50 , FP:  1 , FN: 15139 , P: 98.03921568627452 , R: 0.3291855948383699 , F1: 0.6561679790026247
For g  27  test metrics, TP:  56 , FP:  1 , FN: 15133 , P: 98.24561403508773 , R: 0.36868786621897426 , F1: 0.7346189164370982
For g  26  test metrics, TP:  59 , FP:  1 , FN: 15130 , P: 98.33333333333333 , R: 0.38843900190927644 , F1: 0.7738212341792905
For g  25  test metrics, TP:  86 , FP:  1 , FN: 15103 , P: 98.85057471264368 , R: 0.5661992231219962 , F1: 1.125949201361613
For g  24  test metrics, TP:  89 , FP:  1 , FN: 15100 , P: 98.88888888888889 , R: 0.5859503588122984 , F1: 1.1649977092741672
For g  23  test metrics, TP:  92 , FP:  1 , FN: 15097 , P: 98.9247311827957 , R: 0.6057014945026006 , F1: 1.2040308860096847
For g  22  test metrics, TP:  99 , FP:  2 , FN: 15090 , P: 98.01980198019803 , R: 0.6517874777799724 , F1: 1.2949640287769784
For g  21  test metrics, TP:  113 , FP:  2 , FN: 15076 , P: 98.26086956521739 , R: 0.743959444334716 , F1: 1.4767381076842656
For g  20  test metrics, TP:  123 , FP:  2 , FN: 15066 , P: 98.4 , R: 0.8097965633023899 , F1: 1.6063732532323365
For g  19  test metrics, TP:  135 , FP:  2 , FN: 15054 , P: 98.54014598540147 , R: 0.8888011060635986 , F1: 1.7617121231893513
For g  18  test metrics, TP:  138 , FP:  3 , FN: 15051 , P: 97.87234042553192 , R: 0.9085522417539008 , F1: 1.8003913894324854
For g  17  test metrics, TP:  144 , FP:  3 , FN: 15045 , P: 97.95918367346938 , R: 0.9480545131345053 , F1: 1.8779342723004695
For g  16  test metrics, TP:  155 , FP:  5 , FN: 15034 , P: 96.875 , R: 1.0204753439989467 , F1: 2.0196755488956937
For g  15  test metrics, TP:  189 , FP:  8 , FN: 15000 , P: 95.93908629441624 , R: 1.2443215484890382 , F1: 2.4567788898999092
For g  14  test metrics, TP:  202 , FP:  36 , FN: 14987 , P: 84.87394957983193 , R: 1.3299098031470142 , F1: 2.6187852466454915
For g  13  test metrics, TP:  245 , FP:  57 , FN: 14944 , P: 81.12582781456953 , R: 1.6130094147080123 , F1: 3.1631269769543597
For g  12  test metrics, TP:  264 , FP:  78 , FN: 14925 , P: 77.19298245614036 , R: 1.738099940746593 , F1: 3.3996523082866528
For g  11  test metrics, TP:  306 , FP:  209 , FN: 14883 , P: 59.41747572815534 , R: 2.0146158404108236 , F1: 3.8970962812022414
For g  10  test metrics, TP:  817 , FP:  495 , FN: 14372 , P: 62.271341463414636 , R: 5.378892619658964 , F1: 9.902430155748137
For g  9  test metrics, TP:  1786 , FP:  861 , FN: 13403 , P: 67.47261050245561 , R: 11.758509447626572 , F1: 20.026911863646557
For g  8  test metrics, TP:  2152 , FP:  1248 , FN: 13037 , P: 63.294117647058826 , R: 14.16814800184344 , F1: 23.153477863252466
For g  7  test metrics, TP:  2443 , FP:  1661 , FN: 12746 , P: 59.52729044834308 , R: 16.084008163802753 , F1: 25.32524749909294
For g  6  test metrics, TP:  3034 , FP:  1843 , FN: 12155 , P: 62.21037523067459 , R: 19.974981894792283 , F1: 30.240207315857667
For g  5  test metrics, TP:  3612 , FP:  2186 , FN: 11577 , P: 62.29734391169369 , R: 23.78036737112384 , F1: 34.4213084290275
For g  4  test metrics, TP:  4346 , FP:  3156 , FN: 10843 , P: 57.931218341775526 , R: 28.61281190335111 , F1: 38.30593627429377
For g  3  test metrics, TP:  4386 , FP:  3261 , FN: 10803 , P: 57.35582581404472 , R: 28.876160379221805 , F1: 38.41303205465056
For g  2  test metrics, TP:  5911 , FP:  51586 , FN: 9278 , P: 10.280536375810913 , R: 38.916321021792086 , F1: 16.26448009245247
For g  1  test metrics, TP:  7567 , FP:  110898 , FN: 7622 , P: 6.38754062381294 , R: 49.818947922838895 , F1: 11.323267541562542
Ce a dat pe validare
4 3261 10803 57.35582581404472 28.876160379221805

Best threshold 3
Confusion matrix
TP: 4386, TN: 499105, FP: 3261, FN: 10803, FNR: 0.711238396207782, FPR: 0.006491283247672016
Precision: 57.356%, Recall: 28.876%, F1-measure: 38.413%, Specificity: 0.994
--------------------------UNIQUE TEST SEQUENCES------------------------------------
Ce a dat pe validare
4 1239 1440 64.47821100917432 60.965031173759826

Best threshold 3
Confusion matrix
TP: 2249, TN: 11820, FP: 1239, FN: 1440, FNR: 0.39034968826240174, FPR: 0.09487709625545601
Precision: 64.478%, Recall: 60.965%, F1-measure: 62.672%, Specificity: 0.905, Lead time: 11.928
elapsed_time: 449.44507789611816

Process finished with exit code 0

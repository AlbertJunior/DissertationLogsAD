--folder=hdfs/
--log_file=HDFS.log
--dataset_name=hdfs
--model_name=deeplog
--window_type=session
--sample=sliding_window
--is_logkey
--train_size=0.1
--train_ratio=1
--valid_ratio=0.1
--test_ratio=1
--n_warm_up_epoch=0
--n_epochs_stop=10
--batch_size=1024
--num_candidates=20
--history_size=10
--lr=0.001
--accumulation_step=5
--session_level=hour
--window_size=30
--step_size=20
--output_dir=dataset/
--max_epoch=10
--run_dir=runs/2023-03-18_hdfs_0.1train_0.1val

/Volumes/workplace/disertatie/LogADEmpirical/venv/bin/python /Volumes/workplace/disertatie/LogADEmpirical/main_run.py --folder=hdfs/ --log_file=HDFS.log --dataset_name=hdfs --model_name=deeplog --window_type=session --sample=sliding_window --is_logkey --train_size=0.1 --train_ratio=1 --valid_ratio=0.1 --test_ratio=1 --n_warm_up_epoch=0 --n_epochs_stop=10 --batch_size=1024 --num_candidates=20 --history_size=10 --lr=0.001 --accumulation_step=5 --session_level=hour --window_size=30 --step_size=20 --output_dir=dataset/ --max_epoch=10 --run_dir=runs/2023-03-18_hdfs_0.1train_0.1val
Some weights of the model checkpoint at bert-base-uncased were not used when initializing BertModel: ['cls.predictions.transform.dense.weight', 'cls.predictions.bias', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.decoder.weight', 'cls.seq_relationship.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.transform.LayerNorm.weight']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Save options parameters
vocab size 38
save vocab in dataset/hdfs/deeplog_vocab.pkl
Loading vocab
38
Loading train dataset

Secvente de train normale: 55857
Secvente de train anormale: 1649
Nr secvente train from train.pkl 57506
number of sessions 57506 . Cate una pentru fiecare identificator unic SAU logica de creare de sesiune
number of seqs 542013 . Exista mai multe pe train in functie de history_size
Train loss: 3.58181033 - Train acc: 0.00 - Train kurtosis: -3.00 - Train skewness: -0.00:   9%|▉         | 42/477 [00:15<02:34,  2.81it/s]Find 487812 secvente de train, 54201 secvente de validation
Checkpoint not found

Starting EPOCH: 0 | phase: train | ⏰: 15:52:57 | Learning rate: 0.000031
Train loss: 3.49520927 - Train acc: 0.19 - Train kurtosis: -3.00 - Train skewness: 0.03: 100%|██████████| 477/477 [03:02<00:00,  2.62it/s]
Eliminated instances percentage:  0.0987122088017515 48153/487812
Eliminated anomalies percentage:  0.04292567441280917 2067/48153
Log saved

Starting EPOCH: 1 | phase: train | ⏰: 15:56:01 | Learning rate: 0.000063
Train loss: 2.30414585 - Train acc: 0.24 - Train kurtosis: -1.69 - Train skewness: 0.08: 100%|██████████| 477/477 [03:19<00:00,  2.39it/s]
:  21%|██        | 11/53 [00:01<00:05,  7.55it/s]Eliminated instances percentage:  0.1031811435553041 50333/487812
Eliminated anomalies percentage:  0.056801700673514394 2859/50333

Starting epoch: 1 | phase: valid | ⏰: 15:59:22
: 100%|██████████| 53/53 [00:08<00:00,  6.19it/s]

Validation loss: 1.8791460496074748 Validation accuracy: 0.25674803047914246 Validation kurtosis: -0.5698876976966858 Validation skewness: -1.1495863199234009
Save model checkpoint at dataset/hdfs/deeplog/deeplog.pth
======== My contribution ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/train.pkl
Length test 57506
Nr secvente unice train: normale vs anormale
3773 607
: 100%|██████████| 107/107 [00:13<00:00,  7.88it/s]
: 100%|██████████| 19/19 [00:02<00:00,  9.15it/s]
------------------------JUST NORMAL FOR ELBOW TRAIN SEQUENCES----------------------------
For g  20  train metrics, TP:  973 , FP:  229 , FN: 676 , P: 80.94841930116472 , R: 59.005457853244394 , F1: 68.2567520168362
For g  19  train metrics, TP:  973 , FP:  229 , FN: 676 , P: 80.94841930116472 , R: 59.005457853244394 , F1: 68.2567520168362
For g  18  train metrics, TP:  975 , FP:  229 , FN: 674 , P: 80.98006644518273 , R: 59.12674348089752 , F1: 68.3491062039958
For g  17  train metrics, TP:  975 , FP:  229 , FN: 674 , P: 80.98006644518273 , R: 59.12674348089752 , F1: 68.3491062039958
For g  16  train metrics, TP:  975 , FP:  229 , FN: 674 , P: 80.98006644518273 , R: 59.12674348089752 , F1: 68.3491062039958
For g  15  train metrics, TP:  975 , FP:  229 , FN: 674 , P: 80.98006644518273 , R: 59.12674348089752 , F1: 68.3491062039958
For g  14  train metrics, TP:  1097 , FP:  231 , FN: 552 , P: 82.605421686747 , R: 66.52516676773803 , F1: 73.69835404769904
For g  13  train metrics, TP:  1536 , FP:  250 , FN: 113 , P: 86.00223964165734 , R: 93.14736203759854 , F1: 89.43231441048034
For g  12  train metrics, TP:  1536 , FP:  250 , FN: 113 , P: 86.00223964165734 , R: 93.14736203759854 , F1: 89.43231441048034
For g  11  train metrics, TP:  1536 , FP:  250 , FN: 113 , P: 86.00223964165734 , R: 93.14736203759854 , F1: 89.43231441048034
For g  10  train metrics, TP:  1628 , FP:  250 , FN: 21 , P: 86.68796592119276 , R: 98.72650090964221 , F1: 92.31641621774881
For g  9  train metrics, TP:  1629 , FP:  250 , FN: 20 , P: 86.69505055880788 , R: 98.78714372346877 , F1: 92.34693877551021
For g  8  train metrics, TP:  1629 , FP:  250 , FN: 20 , P: 86.69505055880788 , R: 98.78714372346877 , F1: 92.34693877551021
For g  7  train metrics, TP:  1629 , FP:  250 , FN: 20 , P: 86.69505055880788 , R: 98.78714372346877 , F1: 92.34693877551021
For g  6  train metrics, TP:  1633 , FP:  8180 , FN: 16 , P: 16.641190257821258 , R: 99.02971497877502 , F1: 28.494154597801433
For g  5  train metrics, TP:  1644 , FP:  20373 , FN: 5 , P: 7.466957351137757 , R: 99.6967859308672 , F1: 13.89334910842559
For g  4  train metrics, TP:  1644 , FP:  24141 , FN: 5 , P: 6.375799883653287 , R: 99.6967859308672 , F1: 11.985127943427864
For g  3  train metrics, TP:  1647 , FP:  27167 , FN: 2 , P: 5.71597140279031 , R: 99.87871437234688 , F1: 10.813117552440666
For g  2  train metrics, TP:  1647 , FP:  27177 , FN: 2 , P: 5.71398834304746 , R: 99.87871437234688 , F1: 10.809569126767958
For g  1  train metrics, TP:  1647 , FP:  55855 , FN: 2 , P: 2.8642482000626064 , R: 99.87871437234688 , F1: 5.568798498757418
Ce a dat pe train
10 250 20 86.69505055880788 98.78714372346877

[1202, 1202, 1204, 1204, 1204, 1204, 1328, 1786, 1786, 1786, 1878, 1879, 1879, 1879, 9813, 22017, 25785, 28814, 28824, 57502]
Changes in number of anomalies
Pentru g 33 anomalies diff:0
Pentru g 32 anomalies diff:2
Pentru g 31 anomalies diff:0
Pentru g 30 anomalies diff:0
Pentru g 29 anomalies diff:0
Pentru g 28 anomalies diff:124
Pentru g 27 anomalies diff:458
Pentru g 26 anomalies diff:0
Pentru g 25 anomalies diff:0
Pentru g 24 anomalies diff:92
Pentru g 23 anomalies diff:1
Pentru g 22 anomalies diff:0
Pentru g 21 anomalies diff:0
Pentru g 20 anomalies diff:7934
Pentru g 19 anomalies diff:12204
Pentru g 18 anomalies diff:3768
Pentru g 17 anomalies diff:3029
Pentru g 16 anomalies diff:10
Pentru g 15 anomalies diff:28678
elapsed_time: 49.813803911209106
======== Their approach ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/test.pkl
Length test 517555
Nr secvente unice test: normale vs anormale
13059 3689
: 100%|██████████| 389/389 [00:41<00:00,  9.40it/s]
: 100%|██████████| 120/120 [00:10<00:00, 11.17it/s]
------------------------NORMAL TEST SEQUENCES----------------------------
For g  20  test metrics, TP:  9076 , FP:  1979 , FN: 6113 , P: 82.09859791949344 , R: 59.7537691750609 , F1: 69.16628562719097
For g  19  test metrics, TP:  9076 , FP:  1979 , FN: 6113 , P: 82.09859791949344 , R: 59.7537691750609 , F1: 69.16628562719097
For g  18  test metrics, TP:  9084 , FP:  1979 , FN: 6105 , P: 82.1115429811082 , R: 59.80643887023504 , F1: 69.20615572146883
For g  17  test metrics, TP:  9084 , FP:  1979 , FN: 6105 , P: 82.1115429811082 , R: 59.80643887023504 , F1: 69.20615572146883
For g  16  test metrics, TP:  9084 , FP:  1979 , FN: 6105 , P: 82.1115429811082 , R: 59.80643887023504 , F1: 69.20615572146883
For g  15  test metrics, TP:  9084 , FP:  1979 , FN: 6105 , P: 82.1115429811082 , R: 59.80643887023504 , F1: 69.20615572146883
For g  14  test metrics, TP:  10200 , FP:  1989 , FN: 4989 , P: 83.68200836820084 , R: 67.15386134702746 , F1: 74.51238220468991
For g  13  test metrics, TP:  14269 , FP:  2186 , FN: 920 , P: 86.7152841081738 , R: 93.94298505497399 , F1: 90.18455315383643
For g  12  test metrics, TP:  14269 , FP:  2186 , FN: 920 , P: 86.7152841081738 , R: 93.94298505497399 , F1: 90.18455315383643
For g  11  test metrics, TP:  14269 , FP:  2186 , FN: 920 , P: 86.7152841081738 , R: 93.94298505497399 , F1: 90.18455315383643
For g  10  test metrics, TP:  15056 , FP:  2186 , FN: 133 , P: 87.32165642036887 , R: 99.12436631772994 , F1: 92.84943418334309
For g  9  test metrics, TP:  15057 , FP:  2186 , FN: 132 , P: 87.32239169518066 , R: 99.1309500296267 , F1: 92.85273803650715
For g  8  test metrics, TP:  15057 , FP:  2186 , FN: 132 , P: 87.32239169518066 , R: 99.1309500296267 , F1: 92.85273803650715
For g  7  test metrics, TP:  15057 , FP:  2186 , FN: 132 , P: 87.32239169518066 , R: 99.1309500296267 , F1: 92.85273803650715
For g  6  test metrics, TP:  15080 , FP:  73752 , FN: 109 , P: 16.97586455331412 , R: 99.28237540325236 , F1: 28.994145412945464
For g  5  test metrics, TP:  15177 , FP:  181962 , FN: 12 , P: 7.698628886217339 , R: 99.92099545723879 , F1: 14.295806488075053
For g  4  test metrics, TP:  15178 , FP:  216266 , FN: 11 , P: 6.557957864537426 , R: 99.92757916913556 , F1: 12.308166384871448
For g  3  test metrics, TP:  15189 , FP:  242496 , FN: 0 , P: 5.8944059607660515 , R: 100.0 , F1: 11.132610655467358
For g  2  test metrics, TP:  15189 , FP:  242614 , FN: 0 , P: 5.8917080096042325 , R: 100.0 , F1: 11.127798616809283
For g  1  test metrics, TP:  15189 , FP:  502348 , FN: 0 , P: 2.9348626281792414 , R: 100.0 , F1: 5.702368572211605
Ce a dat pe validare
10 2186 132 87.32239169518066 99.1309500296267

Best threshold 9
Confusion matrix
TP: 15057, TN: 500180, FP: 2186, FN: 132, FNR: 0.008690499703732965, FPR: 0.004351409131987435
Precision: 87.322%, Recall: 99.131%, F1-measure: 92.853%, Specificity: 0.996
--------------------------UNIQUE TEST SEQUENCES------------------------------------
For g  20  test metrics, TP:  1925 , FP:  562 , FN: 1764 , P: 77.40249296340973 , R: 52.182163187855785 , F1: 62.3380829015544
For g  19  test metrics, TP:  1925 , FP:  562 , FN: 1764 , P: 77.40249296340973 , R: 52.182163187855785 , F1: 62.3380829015544
For g  18  test metrics, TP:  1928 , FP:  562 , FN: 1761 , P: 77.429718875502 , R: 52.263486039577124 , F1: 62.40491988994983
For g  17  test metrics, TP:  1928 , FP:  562 , FN: 1761 , P: 77.429718875502 , R: 52.263486039577124 , F1: 62.40491988994983
For g  16  test metrics, TP:  1928 , FP:  562 , FN: 1761 , P: 77.429718875502 , R: 52.263486039577124 , F1: 62.40491988994983
For g  15  test metrics, TP:  1928 , FP:  562 , FN: 1761 , P: 77.429718875502 , R: 52.263486039577124 , F1: 62.40491988994983
For g  14  test metrics, TP:  2386 , FP:  572 , FN: 1303 , P: 80.66260987153483 , R: 64.67877473570073 , F1: 71.79178576801564
For g  13  test metrics, TP:  3335 , FP:  711 , FN: 354 , P: 82.42708848245181 , R: 90.40390349688262 , F1: 86.23141564318034
For g  12  test metrics, TP:  3335 , FP:  711 , FN: 354 , P: 82.42708848245181 , R: 90.40390349688262 , F1: 86.23141564318034
For g  11  test metrics, TP:  3335 , FP:  711 , FN: 354 , P: 82.42708848245181 , R: 90.40390349688262 , F1: 86.23141564318034
For g  10  test metrics, TP:  3581 , FP:  711 , FN: 108 , P: 83.43429636533085 , R: 97.07237733803198 , F1: 89.73812805412857
For g  9  test metrics, TP:  3582 , FP:  711 , FN: 107 , P: 83.43815513626835 , R: 97.09948495527243 , F1: 89.75194186920572
For g  8  test metrics, TP:  3582 , FP:  711 , FN: 107 , P: 83.43815513626835 , R: 97.09948495527243 , F1: 89.75194186920572
For g  7  test metrics, TP:  3582 , FP:  711 , FN: 107 , P: 83.43815513626835 , R: 97.09948495527243 , F1: 89.75194186920572
For g  6  test metrics, TP:  3605 , FP:  6848 , FN: 84 , P: 34.48770687840811 , R: 97.72296015180265 , F1: 50.982887851788995
For g  5  test metrics, TP:  3677 , FP:  10898 , FN: 12 , P: 25.22813036020583 , R: 99.67470859311466 , F1: 40.26500219010074
For g  4  test metrics, TP:  3678 , FP:  11662 , FN: 11 , P: 23.97653194263364 , R: 99.7018162103551 , F1: 38.656787009301596
For g  3  test metrics, TP:  3689 , FP:  12869 , FN: 0 , P: 22.279260780287473 , R: 100.0 , F1: 36.439966414777494
For g  2  test metrics, TP:  3689 , FP:  12916 , FN: 0 , P: 22.216199939777177 , R: 100.0 , F1: 36.35557307578595
For g  1  test metrics, TP:  3689 , FP:  13049 , FN: 0 , P: 22.0396702114948 , R: 100.0 , F1: 36.11886229010623
Ce a dat pe validare
10 711 107 83.43815513626835 97.09948495527243

Best threshold 9
Confusion matrix
TP: 3582, TN: 12348, FP: 711, FN: 107, FNR: 0.029005150447275686, FPR: 0.05444521019986216
Precision: 83.438%, Recall: 97.099%, F1-measure: 89.752%, Specificity: 0.946, Lead time: 17.211
elapsed_time: 335.62155389785767
Log saved

Starting EPOCH: 2 | phase: train | ⏰: 16:06:08 | Learning rate: 0.000125
Train loss: 1.72609400 - Train acc: 0.50 - Train kurtosis: -0.69 - Train skewness: -0.34: 100%|██████████| 477/477 [02:52<00:00,  2.77it/s]
:   8%|▊         | 4/53 [00:00<00:06,  7.77it/s]Eliminated instances percentage:  0.08749272260624995 42680/487812
Eliminated anomalies percentage:  0.08528584817244611 3640/42680

Starting epoch: 2 | phase: valid | ⏰: 16:09:02
: 100%|██████████| 53/53 [00:06<00:00,  8.47it/s]

Validation loss: 1.512985276726057 Validation accuracy: 0.587535285326839 Validation kurtosis: -1.257102608680725 Validation skewness: -0.49775370955467224
Save model checkpoint at dataset/hdfs/deeplog/deeplog.pth
======== My contribution ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/train.pkl
Length test 57506
Nr secvente unice train: normale vs anormale
3773 607
: 100%|██████████| 107/107 [00:09<00:00, 11.29it/s]
: 100%|██████████| 19/19 [00:01<00:00, 13.34it/s]
------------------------JUST NORMAL FOR ELBOW TRAIN SEQUENCES----------------------------
For g  20  train metrics, TP:  788 , FP:  225 , FN: 861 , P: 77.78874629812438 , R: 47.786537295330504 , F1: 59.203606311044325
For g  19  train metrics, TP:  788 , FP:  225 , FN: 861 , P: 77.78874629812438 , R: 47.786537295330504 , F1: 59.203606311044325
For g  18  train metrics, TP:  950 , FP:  226 , FN: 699 , P: 80.78231292517007 , R: 57.610673135233476 , F1: 67.2566371681416
For g  17  train metrics, TP:  1053 , FP:  229 , FN: 596 , P: 82.13728549141966 , R: 63.856882959369315 , F1: 71.85261003070624
For g  16  train metrics, TP:  1064 , FP:  229 , FN: 585 , P: 82.2892498066512 , R: 64.52395391146149 , F1: 72.33174711080898
For g  15  train metrics, TP:  1066 , FP:  229 , FN: 583 , P: 82.31660231660231 , R: 64.64523953911461 , F1: 72.41847826086956
For g  14  train metrics, TP:  1067 , FP:  231 , FN: 582 , P: 82.20338983050847 , R: 64.70588235294117 , F1: 72.41262300644723
For g  13  train metrics, TP:  1079 , FP:  231 , FN: 570 , P: 82.36641221374046 , R: 65.43359611885991 , F1: 72.9300439337614
For g  12  train metrics, TP:  1518 , FP:  250 , FN: 131 , P: 85.85972850678733 , R: 92.05579138872044 , F1: 88.84986830553117
For g  11  train metrics, TP:  1548 , FP:  250 , FN: 101 , P: 86.09566184649611 , R: 93.87507580351728 , F1: 89.81723237597912
For g  10  train metrics, TP:  1629 , FP:  250 , FN: 20 , P: 86.69505055880788 , R: 98.78714372346877 , F1: 92.34693877551021
For g  9  train metrics, TP:  1629 , FP:  250 , FN: 20 , P: 86.69505055880788 , R: 98.78714372346877 , F1: 92.34693877551021
For g  8  train metrics, TP:  1629 , FP:  250 , FN: 20 , P: 86.69505055880788 , R: 98.78714372346877 , F1: 92.34693877551021
For g  7  train metrics, TP:  1629 , FP:  250 , FN: 20 , P: 86.69505055880788 , R: 98.78714372346877 , F1: 92.34693877551021
For g  6  train metrics, TP:  1633 , FP:  7770 , FN: 16 , P: 17.366797830479634 , R: 99.02971497877502 , F1: 29.551212450235248
For g  5  train metrics, TP:  1644 , FP:  20373 , FN: 5 , P: 7.466957351137757 , R: 99.6967859308672 , F1: 13.89334910842559
For g  4  train metrics, TP:  1644 , FP:  21529 , FN: 5 , P: 7.094463384110819 , R: 99.6967859308672 , F1: 13.246313753927966
For g  3  train metrics, TP:  1647 , FP:  26973 , FN: 2 , P: 5.754716981132075 , R: 99.87871437234688 , F1: 10.882420958736661
For g  2  train metrics, TP:  1647 , FP:  27177 , FN: 2 , P: 5.71398834304746 , R: 99.87871437234688 , F1: 10.809569126767958
For g  1  train metrics, TP:  1647 , FP:  27195 , FN: 2 , P: 5.710422300811317 , R: 99.87871437234688 , F1: 10.803187825915844
Ce a dat pe train
11 250 20 86.69505055880788 98.78714372346877

[1013, 1013, 1176, 1282, 1293, 1295, 1298, 1310, 1768, 1798, 1879, 1879, 1879, 1879, 9403, 22017, 23173, 28620, 28824, 28842]
Changes in number of anomalies
Pentru g 33 anomalies diff:0
Pentru g 32 anomalies diff:163
Pentru g 31 anomalies diff:106
Pentru g 30 anomalies diff:11
Pentru g 29 anomalies diff:2
Pentru g 28 anomalies diff:3
Pentru g 27 anomalies diff:12
Pentru g 26 anomalies diff:458
Pentru g 25 anomalies diff:30
Pentru g 24 anomalies diff:81
Pentru g 23 anomalies diff:0
Pentru g 22 anomalies diff:0
Pentru g 21 anomalies diff:0
Pentru g 20 anomalies diff:7524
Pentru g 19 anomalies diff:12614
Pentru g 18 anomalies diff:1156
Pentru g 17 anomalies diff:5447
Pentru g 16 anomalies diff:204
Pentru g 15 anomalies diff:18
elapsed_time: 35.25204110145569
======== Their approach ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/test.pkl
Length test 517555
Nr secvente unice test: normale vs anormale
13059 3689
: 100%|██████████| 389/389 [00:44<00:00,  8.76it/s]
: 100%|██████████| 120/120 [00:12<00:00,  9.97it/s]
------------------------NORMAL TEST SEQUENCES----------------------------
For g  20  test metrics, TP:  7314 , FP:  1946 , FN: 7875 , P: 78.98488120950324 , R: 48.153268812956746 , F1: 59.83066792097836
For g  19  test metrics, TP:  7314 , FP:  1946 , FN: 7875 , P: 78.98488120950324 , R: 48.153268812956746 , F1: 59.83066792097836
For g  18  test metrics, TP:  8851 , FP:  1950 , FN: 6338 , P: 81.94611610036108 , R: 58.272433998288236 , F1: 68.11081185071181
For g  17  test metrics, TP:  9719 , FP:  1963 , FN: 5470 , P: 83.19637048450608 , R: 63.987095924682336 , F1: 72.33820847754085
For g  16  test metrics, TP:  9876 , FP:  1971 , FN: 5313 , P: 83.3628766776399 , R: 65.02073869247482 , F1: 73.05814469596093
For g  15  test metrics, TP:  9900 , FP:  1972 , FN: 5289 , P: 83.38948787061994 , R: 65.17874777799723 , F1: 73.16802778906913
For g  14  test metrics, TP:  9920 , FP:  1988 , FN: 5269 , P: 83.30534094726235 , R: 65.31042201593259 , F1: 73.21843746540208
For g  13  test metrics, TP:  9991 , FP:  1988 , FN: 5198 , P: 83.40429084230738 , R: 65.77786556060306 , F1: 73.54976442873969
For g  12  test metrics, TP:  14076 , FP:  2185 , FN: 1113 , P: 86.56294200848656 , R: 92.67232865889788 , F1: 89.5135135135135
For g  11  test metrics, TP:  14349 , FP:  2185 , FN: 840 , P: 86.78480706423129 , R: 94.46968200671539 , F1: 90.4643318727737
For g  10  test metrics, TP:  15056 , FP:  2186 , FN: 133 , P: 87.32165642036887 , R: 99.12436631772994 , F1: 92.84943418334309
For g  9  test metrics, TP:  15057 , FP:  2186 , FN: 132 , P: 87.32239169518066 , R: 99.1309500296267 , F1: 92.85273803650715
For g  8  test metrics, TP:  15057 , FP:  2186 , FN: 132 , P: 87.32239169518066 , R: 99.1309500296267 , F1: 92.85273803650715
For g  7  test metrics, TP:  15057 , FP:  2186 , FN: 132 , P: 87.32239169518066 , R: 99.1309500296267 , F1: 92.85273803650715
For g  6  test metrics, TP:  15080 , FP:  70023 , FN: 109 , P: 17.71970435824824 , R: 99.28237540325236 , F1: 30.07218920751406
For g  5  test metrics, TP:  15177 , FP:  181962 , FN: 12 , P: 7.698628886217339 , R: 99.92099545723879 , F1: 14.295806488075053
For g  4  test metrics, TP:  15177 , FP:  191652 , FN: 12 , P: 7.337945839316537 , R: 99.92099545723879 , F1: 13.671864443423507
For g  3  test metrics, TP:  15189 , FP:  240961 , FN: 0 , P: 5.929728674604724 , R: 100.0 , F1: 11.195589281304937
For g  2  test metrics, TP:  15189 , FP:  242614 , FN: 0 , P: 5.8917080096042325 , R: 100.0 , F1: 11.127798616809283
For g  1  test metrics, TP:  15189 , FP:  242767 , FN: 0 , P: 5.888213493774132 , R: 100.0 , F1: 11.12156546889015
Ce a dat pe validare
10 2186 132 87.32239169518066 99.1309500296267

Best threshold 9
Confusion matrix
TP: 15057, TN: 500180, FP: 2186, FN: 132, FNR: 0.008690499703732965, FPR: 0.004351409131987435
Precision: 87.322%, Recall: 99.131%, F1-measure: 92.853%, Specificity: 0.996
--------------------------UNIQUE TEST SEQUENCES------------------------------------
For g  20  test metrics, TP:  1771 , FP:  533 , FN: 1918 , P: 76.86631944444444 , R: 48.007590132827325 , F1: 59.10228600033372
For g  19  test metrics, TP:  1771 , FP:  533 , FN: 1918 , P: 76.86631944444444 , R: 48.007590132827325 , F1: 59.10228600033372
For g  18  test metrics, TP:  1806 , FP:  537 , FN: 1883 , P: 77.08066581306018 , R: 48.95635673624288 , F1: 59.88063660477453
For g  17  test metrics, TP:  2212 , FP:  549 , FN: 1477 , P: 80.11590003621876 , R: 59.96204933586338 , F1: 68.5891472868217
For g  16  test metrics, TP:  2301 , FP:  556 , FN: 1388 , P: 80.53902695134757 , R: 62.37462727026294 , F1: 70.30247479376719
For g  15  test metrics, TP:  2319 , FP:  557 , FN: 1370 , P: 80.63282336578581 , R: 62.862564380590946 , F1: 70.64737242955064
For g  14  test metrics, TP:  2333 , FP:  571 , FN: 1356 , P: 80.3374655647383 , R: 63.24207102195717 , F1: 70.77203094190808
For g  13  test metrics, TP:  2365 , FP:  571 , FN: 1324 , P: 80.55177111716621 , R: 64.1095147736514 , F1: 71.39622641509433
For g  12  test metrics, TP:  3328 , FP:  710 , FN: 361 , P: 82.41703813769193 , R: 90.21415017619951 , F1: 86.13951080626376
For g  11  test metrics, TP:  3374 , FP:  710 , FN: 315 , P: 82.61508325171401 , R: 91.46110056925997 , F1: 86.81332818731507
For g  10  test metrics, TP:  3581 , FP:  711 , FN: 108 , P: 83.43429636533085 , R: 97.07237733803198 , F1: 89.73812805412857
For g  9  test metrics, TP:  3582 , FP:  711 , FN: 107 , P: 83.43815513626835 , R: 97.09948495527243 , F1: 89.75194186920572
For g  8  test metrics, TP:  3582 , FP:  711 , FN: 107 , P: 83.43815513626835 , R: 97.09948495527243 , F1: 89.75194186920572
For g  7  test metrics, TP:  3582 , FP:  711 , FN: 107 , P: 83.43815513626835 , R: 97.09948495527243 , F1: 89.75194186920572
For g  6  test metrics, TP:  3605 , FP:  5764 , FN: 84 , P: 38.47795922723876 , R: 97.72296015180265 , F1: 55.21519375095727
For g  5  test metrics, TP:  3677 , FP:  10898 , FN: 12 , P: 25.22813036020583 , R: 99.67470859311466 , F1: 40.26500219010074
For g  4  test metrics, TP:  3677 , FP:  11243 , FN: 12 , P: 24.644772117962468 , R: 99.67470859311466 , F1: 39.518512547691984
For g  3  test metrics, TP:  3689 , FP:  12858 , FN: 0 , P: 22.29407143288814 , R: 100.0 , F1: 36.45977465902353
For g  2  test metrics, TP:  3689 , FP:  12916 , FN: 0 , P: 22.216199939777177 , R: 100.0 , F1: 36.35557307578595
For g  1  test metrics, TP:  3689 , FP:  12924 , FN: 0 , P: 22.205501715523987 , R: 100.0 , F1: 36.341247167766724
Ce a dat pe validare
10 711 107 83.43815513626835 97.09948495527243

Best threshold 9
Confusion matrix
TP: 3582, TN: 12348, FP: 711, FN: 107, FNR: 0.029005150447275686, FPR: 0.05444521019986216
Precision: 83.438%, Recall: 97.099%, F1-measure: 89.752%, Specificity: 0.946, Lead time: 17.209
elapsed_time: 307.4905297756195
Log saved

Starting EPOCH: 3 | phase: train | ⏰: 16:15:01 | Learning rate: 0.000250
Train loss: 1.14895126 - Train acc: 0.69 - Train kurtosis: -1.17 - Train skewness: -0.21: 100%|██████████| 477/477 [03:00<00:00,  2.65it/s]
:  28%|██▊       | 15/53 [00:01<00:05,  7.34it/s]Eliminated instances percentage:  0.025366329651587086 12374/487812
Eliminated anomalies percentage:  0.2620009697753354 3242/12374

Starting epoch: 3 | phase: valid | ⏰: 16:18:02
: 100%|██████████| 53/53 [00:06<00:00,  8.21it/s]

Validation loss: 0.8864237992268689 Validation accuracy: 0.7376616667589159 Validation kurtosis: -1.0792012214660645 Validation skewness: -0.5568886995315552
Save model checkpoint at dataset/hdfs/deeplog/deeplog.pth
======== My contribution ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/train.pkl
Length test 57506
Nr secvente unice train: normale vs anormale
3773 607
: 100%|██████████| 107/107 [00:19<00:00,  5.43it/s]
: 100%|██████████| 19/19 [00:01<00:00, 14.52it/s]
------------------------JUST NORMAL FOR ELBOW TRAIN SEQUENCES----------------------------
For g  20  train metrics, TP:  78 , FP:  38 , FN: 1571 , P: 67.24137931034483 , R: 4.730139478471801 , F1: 8.838526912181303
For g  19  train metrics, TP:  78 , FP:  38 , FN: 1571 , P: 67.24137931034483 , R: 4.730139478471801 , F1: 8.838526912181303
For g  18  train metrics, TP:  198 , FP:  40 , FN: 1451 , P: 83.19327731092437 , R: 12.007277137659187 , F1: 20.985691573926868
For g  17  train metrics, TP:  202 , FP:  40 , FN: 1447 , P: 83.47107438016529 , R: 12.249848392965433 , F1: 21.364357482813325
For g  16  train metrics, TP:  204 , FP:  41 , FN: 1445 , P: 83.26530612244898 , R: 12.371134020618557 , F1: 21.541710665258712
For g  15  train metrics, TP:  222 , FP:  42 , FN: 1427 , P: 84.0909090909091 , R: 13.462704669496665 , F1: 23.209618400418194
For g  14  train metrics, TP:  222 , FP:  42 , FN: 1427 , P: 84.0909090909091 , R: 13.462704669496665 , F1: 23.209618400418194
For g  13  train metrics, TP:  256 , FP:  42 , FN: 1393 , P: 85.90604026845638 , R: 15.524560339599757 , F1: 26.296866974833076
For g  12  train metrics, TP:  701 , FP:  217 , FN: 948 , P: 76.36165577342048 , R: 42.51061249241965 , F1: 54.61628359953253
For g  11  train metrics, TP:  1028 , FP:  221 , FN: 621 , P: 82.30584467574059 , R: 62.340812613705275 , F1: 70.94547964113181
For g  10  train metrics, TP:  1200 , FP:  226 , FN: 449 , P: 84.15147265077138 , R: 72.77137659187386 , F1: 78.04878048780488
For g  9  train metrics, TP:  1628 , FP:  245 , FN: 21 , P: 86.91938067271757 , R: 98.72650090964221 , F1: 92.44747302668938
For g  8  train metrics, TP:  1629 , FP:  247 , FN: 20 , P: 86.83368869936034 , R: 98.78714372346877 , F1: 92.42553191489363
For g  7  train metrics, TP:  1629 , FP:  250 , FN: 20 , P: 86.69505055880788 , R: 98.78714372346877 , F1: 92.34693877551021
For g  6  train metrics, TP:  1633 , FP:  252 , FN: 16 , P: 86.63129973474801 , R: 99.02971497877502 , F1: 92.41652518392756
For g  5  train metrics, TP:  1639 , FP:  267 , FN: 10 , P: 85.9916054564533 , R: 99.39357186173439 , F1: 92.20815752461323
For g  4  train metrics, TP:  1644 , FP:  289 , FN: 5 , P: 85.0491464045525 , R: 99.6967859308672 , F1: 91.79229480737017
For g  3  train metrics, TP:  1644 , FP:  8210 , FN: 5 , P: 16.683580271970772 , R: 99.6967859308672 , F1: 28.583847691906456
For g  2  train metrics, TP:  1646 , FP:  8407 , FN: 3 , P: 16.37322192380384 , R: 99.81807155852032 , F1: 28.13194325756281
For g  1  train metrics, TP:  1648 , FP:  23716 , FN: 1 , P: 6.497397886768648 , R: 99.93935718617344 , F1: 12.20153259541702
Ce a dat pe train
10 245 21 86.91938067271757 98.72650090964221

[116, 116, 238, 242, 245, 264, 264, 298, 918, 1249, 1426, 1873, 1876, 1879, 1885, 1906, 1933, 9854, 10053, 25364]
Changes in number of anomalies
Pentru g 33 anomalies diff:0
Pentru g 32 anomalies diff:122
Pentru g 31 anomalies diff:4
Pentru g 30 anomalies diff:3
Pentru g 29 anomalies diff:19
Pentru g 28 anomalies diff:0
Pentru g 27 anomalies diff:34
Pentru g 26 anomalies diff:620
Pentru g 25 anomalies diff:331
Pentru g 24 anomalies diff:177
Pentru g 23 anomalies diff:447
Pentru g 22 anomalies diff:3
Pentru g 21 anomalies diff:3
Pentru g 20 anomalies diff:6
Pentru g 19 anomalies diff:21
Pentru g 18 anomalies diff:27
Pentru g 17 anomalies diff:7921
Pentru g 16 anomalies diff:199
Pentru g 15 anomalies diff:15311
elapsed_time: 45.36366105079651
======== Their approach ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/test.pkl
Length test 517555
Nr secvente unice test: normale vs anormale
13059 3689
: 100%|██████████| 389/389 [00:47<00:00,  8.23it/s]
: 100%|██████████| 120/120 [00:13<00:00,  9.18it/s]
------------------------NORMAL TEST SEQUENCES----------------------------
For g  20  test metrics, TP:  651 , FP:  333 , FN: 14538 , P: 66.15853658536585 , R: 4.285996444795575 , F1: 8.050454461138935
For g  19  test metrics, TP:  651 , FP:  333 , FN: 14538 , P: 66.15853658536585 , R: 4.285996444795575 , F1: 8.050454461138935
For g  18  test metrics, TP:  1747 , FP:  343 , FN: 13442 , P: 83.58851674641149 , R: 11.501744683652644 , F1: 20.221077608657907
For g  17  test metrics, TP:  1761 , FP:  350 , FN: 13428 , P: 83.42018000947418 , R: 11.593916650207387 , F1: 20.358381502890172
For g  16  test metrics, TP:  1764 , FP:  358 , FN: 13425 , P: 83.12912346842602 , R: 11.61366778589769 , F1: 20.380105135463
For g  15  test metrics, TP:  1892 , FP:  385 , FN: 13297 , P: 83.09178743961353 , R: 12.456382908683915 , F1: 21.664949043856634
For g  14  test metrics, TP:  1895 , FP:  385 , FN: 13294 , P: 83.1140350877193 , R: 12.476134044374218 , F1: 21.695575018604384
For g  13  test metrics, TP:  2230 , FP:  385 , FN: 12959 , P: 85.27724665391969 , R: 14.681677529791296 , F1: 25.050550438103794
For g  12  test metrics, TP:  6407 , FP:  1864 , FN: 8782 , P: 77.46342642969411 , R: 42.18184212258871 , F1: 54.62063086104006
For g  11  test metrics, TP:  9455 , FP:  1897 , FN: 5734 , P: 83.2892882311487 , R: 62.24899598393574 , F1: 71.24825741305904
For g  10  test metrics, TP:  11101 , FP:  1911 , FN: 4088 , P: 85.31355671687673 , R: 73.08578576601488 , F1: 78.72770469132301
For g  9  test metrics, TP:  15055 , FP:  2129 , FN: 134 , P: 87.61056797020484 , R: 99.11778260583317 , F1: 93.00960677107466
For g  8  test metrics, TP:  15055 , FP:  2170 , FN: 134 , P: 87.40203193033382 , R: 99.11778260583317 , F1: 92.89196026408342
For g  7  test metrics, TP:  15057 , FP:  2186 , FN: 132 , P: 87.32239169518066 , R: 99.1309500296267 , F1: 92.85273803650715
For g  6  test metrics, TP:  15077 , FP:  2229 , FN: 112 , P: 87.12007396278747 , R: 99.26262426756205 , F1: 92.79581474072934
For g  5  test metrics, TP:  15124 , FP:  2355 , FN: 65 , P: 86.52668916986097 , R: 99.57205872671013 , F1: 92.59213909636341
For g  4  test metrics, TP:  15176 , FP:  2559 , FN: 13 , P: 85.5709049901325 , R: 99.91441174534202 , F1: 92.18806949337869
For g  3  test metrics, TP:  15179 , FP:  74035 , FN: 10 , P: 17.014145761875938 , R: 99.93416288103232 , F1: 29.077708494966615
For g  2  test metrics, TP:  15183 , FP:  75752 , FN: 6 , P: 16.696541485676583 , R: 99.9604977286194 , F1: 28.613697184425767
For g  1  test metrics, TP:  15189 , FP:  211224 , FN: 0 , P: 6.708537053967749 , R: 100.0 , F1: 12.573571410832692
Ce a dat pe validare
10 2129 134 87.61056797020484 99.11778260583317

Best threshold 9
Confusion matrix
TP: 15055, TN: 500237, FP: 2129, FN: 134, FNR: 0.008822173941668312, FPR: 0.004237946039341835
Precision: 87.611%, Recall: 99.118%, F1-measure: 93.010%, Specificity: 0.996
--------------------------UNIQUE TEST SEQUENCES------------------------------------
For g  20  test metrics, TP:  317 , FP:  45 , FN: 3372 , P: 87.56906077348066 , R: 8.593114665220927 , F1: 15.650456677363614
For g  19  test metrics, TP:  317 , FP:  45 , FN: 3372 , P: 87.56906077348066 , R: 8.593114665220927 , F1: 15.650456677363614
For g  18  test metrics, TP:  762 , FP:  55 , FN: 2927 , P: 93.26805385556915 , R: 20.656004337218757 , F1: 33.82157123834887
For g  17  test metrics, TP:  773 , FP:  58 , FN: 2916 , P: 93.02045728038507 , R: 20.95418812686365 , F1: 34.20353982300885
For g  16  test metrics, TP:  776 , FP:  63 , FN: 2913 , P: 92.49106078665078 , R: 21.035510978584984 , F1: 34.275618374558306
For g  15  test metrics, TP:  868 , FP:  85 , FN: 2821 , P: 91.08079748163694 , R: 23.529411764705884 , F1: 37.39767341663077
For g  14  test metrics, TP:  871 , FP:  85 , FN: 2818 , P: 91.10878661087867 , R: 23.610734616427216 , F1: 37.502691065662
For g  13  test metrics, TP:  951 , FP:  85 , FN: 2738 , P: 91.79536679536679 , R: 25.77934399566278 , F1: 40.25396825396825
For g  12  test metrics, TP:  2491 , FP:  493 , FN: 1198 , P: 83.47855227882037 , R: 67.5250745459474 , F1: 74.65907387981419
For g  11  test metrics, TP:  2591 , FP:  508 , FN: 1098 , P: 83.60761535979348 , R: 70.23583626999186 , F1: 76.34060106069533
For g  10  test metrics, TP:  2705 , FP:  521 , FN: 984 , P: 83.84996900185989 , R: 73.32610463540254 , F1: 78.23571945046999
For g  9  test metrics, TP:  3580 , FP:  672 , FN: 109 , P: 84.19567262464723 , R: 97.04526972079154 , F1: 90.16496662888805
For g  8  test metrics, TP:  3580 , FP:  697 , FN: 109 , P: 83.70353051204116 , R: 97.04526972079154 , F1: 89.88199849359779
For g  7  test metrics, TP:  3582 , FP:  711 , FN: 107 , P: 83.43815513626835 , R: 97.09948495527243 , F1: 89.75194186920572
For g  6  test metrics, TP:  3602 , FP:  742 , FN: 87 , P: 82.91896869244935 , R: 97.64163730008133 , F1: 89.68006971243621
For g  5  test metrics, TP:  3645 , FP:  822 , FN: 44 , P: 81.59838817998657 , R: 98.80726484142043 , F1: 89.38205002452183
For g  4  test metrics, TP:  3676 , FP:  877 , FN: 13 , P: 80.73797496156381 , R: 99.64760097587423 , F1: 89.20165008493085
For g  3  test metrics, TP:  3679 , FP:  6956 , FN: 10 , P: 34.59332393041843 , R: 99.72892382759555 , F1: 51.368332867913985
For g  2  test metrics, TP:  3683 , FP:  7571 , FN: 6 , P: 32.726141816243114 , R: 99.83735429655734 , F1: 49.29398380512614
For g  1  test metrics, TP:  3689 , FP:  12742 , FN: 0 , P: 22.451463696670928 , R: 100.0 , F1: 36.66998011928429
Ce a dat pe validare
10 672 109 84.19567262464723 97.04526972079154

Best threshold 9
Confusion matrix
TP: 3580, TN: 12387, FP: 672, FN: 109, FNR: 0.029547302792084576, FPR: 0.0514587640707558
Precision: 84.196%, Recall: 97.045%, F1-measure: 90.165%, Specificity: 0.949, Lead time: 16.162
elapsed_time: 12246.141681909561
Log saved

Starting EPOCH: 4 | phase: train | ⏰: 19:43:09 | Learning rate: 0.000500
Train loss: 0.82484910 - Train acc: 0.72 - Train kurtosis: -1.14 - Train skewness: -0.45: 100%|██████████| 477/477 [02:43<00:00,  2.93it/s]
Eliminated instances percentage:  0.043533164415799526 21236/487812
Eliminated anomalies percentage:  0.20083819928423433 4265/21236

Starting epoch: 4 | phase: valid | ⏰: 19:45:54
: 100%|██████████| 53/53 [00:05<00:00,  8.87it/s]

Validation loss: 0.6596815496120813 Validation accuracy: 0.7826977362041291 Validation kurtosis: -0.9084676504135132 Validation skewness: -0.6915872693061829
Save model checkpoint at dataset/hdfs/deeplog/deeplog.pth
======== My contribution ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/train.pkl
Length test 57506
Nr secvente unice train: normale vs anormale
3773 607
: 100%|██████████| 107/107 [00:10<00:00, 10.59it/s]
: 100%|██████████| 19/19 [00:01<00:00, 18.37it/s]
------------------------JUST NORMAL FOR ELBOW TRAIN SEQUENCES----------------------------
For g  20  train metrics, TP:  28 , FP:  38 , FN: 1621 , P: 42.42424242424242 , R: 1.6979987871437234 , F1: 3.265306122448979
For g  19  train metrics, TP:  28 , FP:  38 , FN: 1621 , P: 42.42424242424242 , R: 1.6979987871437234 , F1: 3.265306122448979
For g  18  train metrics, TP:  45 , FP:  38 , FN: 1604 , P: 54.21686746987952 , R: 2.72892662219527 , F1: 5.196304849884527
For g  17  train metrics, TP:  62 , FP:  38 , FN: 1587 , P: 62.0 , R: 3.759854457246816 , F1: 7.089765580331618
For g  16  train metrics, TP:  78 , FP:  38 , FN: 1571 , P: 67.24137931034483 , R: 4.730139478471801 , F1: 8.838526912181303
For g  15  train metrics, TP:  110 , FP:  38 , FN: 1539 , P: 74.32432432432432 , R: 6.670709520921771 , F1: 12.242626599888704
For g  14  train metrics, TP:  115 , FP:  38 , FN: 1534 , P: 75.16339869281046 , R: 6.973923590054579 , F1: 12.763596004439512
For g  13  train metrics, TP:  234 , FP:  41 , FN: 1415 , P: 85.0909090909091 , R: 14.190418435415403 , F1: 24.324324324324323
For g  12  train metrics, TP:  567 , FP:  47 , FN: 1082 , P: 92.34527687296416 , R: 34.3844754396604 , F1: 50.11047282368538
For g  11  train metrics, TP:  1011 , FP:  207 , FN: 638 , P: 83.00492610837438 , R: 61.30988477865373 , F1: 70.52668294384374
For g  10  train metrics, TP:  1032 , FP:  225 , FN: 617 , P: 82.10023866348449 , R: 62.58338386901152 , F1: 71.02546455609085
For g  9  train metrics, TP:  1057 , FP:  226 , FN: 592 , P: 82.3850350740452 , R: 64.09945421467556 , F1: 72.10095497953616
For g  8  train metrics, TP:  1058 , FP:  228 , FN: 591 , P: 82.27060653188181 , R: 64.16009702850212 , F1: 72.09540034071551
For g  7  train metrics, TP:  1058 , FP:  231 , FN: 591 , P: 82.07913110938712 , R: 64.16009702850212 , F1: 72.0217835262083
For g  6  train metrics, TP:  1193 , FP:  234 , FN: 456 , P: 83.6019621583742 , R: 72.34687689508793 , F1: 77.56827048114434
For g  5  train metrics, TP:  1197 , FP:  271 , FN: 452 , P: 81.53950953678473 , R: 72.58944815039418 , F1: 76.8046198267565
For g  4  train metrics, TP:  1207 , FP:  302 , FN: 442 , P: 79.98674618952948 , R: 73.19587628865979 , F1: 76.44078530715642
For g  3  train metrics, TP:  1208 , FP:  379 , FN: 441 , P: 76.1184625078765 , R: 73.25651910248635 , F1: 74.66007416563659
For g  2  train metrics, TP:  1645 , FP:  8281 , FN: 4 , P: 16.572637517630465 , R: 99.75742874469375 , F1: 28.423326133909285
For g  1  train metrics, TP:  1648 , FP:  23719 , FN: 1 , P: 6.496629479244688 , R: 99.93935718617344 , F1: 12.200177672490376
Ce a dat pe train
7 234 456 83.6019621583742 72.34687689508793

[66, 66, 83, 100, 116, 148, 153, 275, 614, 1218, 1257, 1283, 1286, 1289, 1427, 1468, 1509, 1587, 9926, 25367]
Changes in number of anomalies
Pentru g 33 anomalies diff:0
Pentru g 32 anomalies diff:17
Pentru g 31 anomalies diff:17
Pentru g 30 anomalies diff:16
Pentru g 29 anomalies diff:32
Pentru g 28 anomalies diff:5
Pentru g 27 anomalies diff:122
Pentru g 26 anomalies diff:339
Pentru g 25 anomalies diff:604
Pentru g 24 anomalies diff:39
Pentru g 23 anomalies diff:26
Pentru g 22 anomalies diff:3
Pentru g 21 anomalies diff:3
Pentru g 20 anomalies diff:138
Pentru g 19 anomalies diff:41
Pentru g 18 anomalies diff:41
Pentru g 17 anomalies diff:78
Pentru g 16 anomalies diff:8339
Pentru g 15 anomalies diff:15441
elapsed_time: 36.31275224685669
======== Their approach ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/test.pkl
Length test 517555
Nr secvente unice test: normale vs anormale
13059 3689
: 100%|██████████| 389/389 [01:06<00:00,  5.87it/s]
: 100%|██████████| 120/120 [00:14<00:00,  8.04it/s]
------------------------NORMAL TEST SEQUENCES----------------------------
For g  20  test metrics, TP:  214 , FP:  332 , FN: 14975 , P: 39.1941391941392 , R: 1.408914345908223 , F1: 2.720050842071814
For g  19  test metrics, TP:  214 , FP:  332 , FN: 14975 , P: 39.1941391941392 , R: 1.408914345908223 , F1: 2.720050842071814
For g  18  test metrics, TP:  362 , FP:  332 , FN: 14827 , P: 52.16138328530259 , R: 2.383303706629798 , F1: 4.5583328086633506
For g  17  test metrics, TP:  522 , FP:  332 , FN: 14667 , P: 61.124121779859486 , R: 3.4366976101125815 , F1: 6.507511064015458
For g  16  test metrics, TP:  634 , FP:  338 , FN: 14555 , P: 65.22633744855968 , R: 4.17407334255053 , F1: 7.846049130623106
For g  15  test metrics, TP:  937 , FP:  340 , FN: 14252 , P: 73.37509788566953 , R: 6.168938047271052 , F1: 11.381027571966477
For g  14  test metrics, TP:  955 , FP:  340 , FN: 14234 , P: 73.74517374517374 , R: 6.287444861412864 , F1: 11.586993448192187
For g  13  test metrics, TP:  2070 , FP:  359 , FN: 13119 , P: 85.22025524907369 , R: 13.628283626308512 , F1: 23.498694516971277
For g  12  test metrics, TP:  5145 , FP:  402 , FN: 10044 , P: 92.75283937263386 , R: 33.87319770886826 , F1: 49.623842592592595
For g  11  test metrics, TP:  9379 , FP:  1744 , FN: 5810 , P: 84.32077676885733 , R: 61.74863387978142 , F1: 71.29066585588326
For g  10  test metrics, TP:  9602 , FP:  1914 , FN: 5587 , P: 83.37964571031608 , R: 63.21680163276055 , F1: 71.91162703613556
For g  9  test metrics, TP:  9810 , FP:  1935 , FN: 5379 , P: 83.52490421455938 , R: 64.58621370728817 , F1: 72.84473156605034
For g  8  test metrics, TP:  9818 , FP:  1973 , FN: 5371 , P: 83.26689848189297 , R: 64.63888340246231 , F1: 72.77983691623423
For g  7  test metrics, TP:  9821 , FP:  1989 , FN: 5368 , P: 83.15834038950042 , R: 64.65863453815261 , F1: 72.75084262380088
For g  6  test metrics, TP:  11004 , FP:  2011 , FN: 4185 , P: 84.54859777180177 , R: 72.44716571202844 , F1: 78.03148489575946
For g  5  test metrics, TP:  11021 , FP:  2344 , FN: 4168 , P: 82.46165357276469 , R: 72.5590888142735 , F1: 77.1940883939203
For g  4  test metrics, TP:  11115 , FP:  2639 , FN: 4074 , P: 80.81285444234405 , R: 73.17795773256962 , F1: 76.80613619873544
For g  3  test metrics, TP:  11128 , FP:  3221 , FN: 4061 , P: 77.55244267893232 , R: 73.2635459872276 , F1: 75.34701063037444
For g  2  test metrics, TP:  15179 , FP:  74631 , FN: 10 , P: 16.901235942545373 , R: 99.93416288103232 , F1: 28.912656311012487
For g  1  test metrics, TP:  15189 , FP:  211259 , FN: 0 , P: 6.707500176640995 , R: 100.0 , F1: 12.571750187264367
Ce a dat pe validare
7 2011 4185 84.54859777180177 72.44716571202844

Best threshold 6
Confusion matrix
TP: 11004, TN: 500355, FP: 2011, FN: 4185, FNR: 0.27552834287971556, FPR: 0.004003057531759713
Precision: 84.549%, Recall: 72.447%, F1-measure: 78.031%, Specificity: 0.996
--------------------------UNIQUE TEST SEQUENCES------------------------------------
For g  20  test metrics, TP:  178 , FP:  44 , FN: 3511 , P: 80.18018018018019 , R: 4.825155868799133 , F1: 9.102531321912556
For g  19  test metrics, TP:  178 , FP:  44 , FN: 3511 , P: 80.18018018018019 , R: 4.825155868799133 , F1: 9.102531321912556
For g  18  test metrics, TP:  213 , FP:  44 , FN: 3476 , P: 82.87937743190662 , R: 5.773922472214692 , F1: 10.795742524075013
For g  17  test metrics, TP:  244 , FP:  44 , FN: 3445 , P: 84.72222222222223 , R: 6.614258606668474 , F1: 12.270555695247674
For g  16  test metrics, TP:  300 , FP:  47 , FN: 3389 , P: 86.45533141210375 , R: 8.13228517213337 , F1: 14.86620416253717
For g  15  test metrics, TP:  374 , FP:  48 , FN: 3315 , P: 88.62559241706161 , R: 10.138248847926267 , F1: 18.195086353685234
For g  14  test metrics, TP:  390 , FP:  48 , FN: 3299 , P: 89.04109589041096 , R: 10.571970723773381 , F1: 18.899927307971893
For g  13  test metrics, TP:  853 , FP:  64 , FN: 2836 , P: 93.020719738277 , R: 23.122797506099214 , F1: 37.03864524533218
For g  12  test metrics, TP:  953 , FP:  95 , FN: 2736 , P: 90.93511450381679 , R: 25.83355923014367 , F1: 40.23643656322567
For g  11  test metrics, TP:  2326 , FP:  443 , FN: 1363 , P: 84.00144456482485 , R: 63.052317701274056 , F1: 72.03468566119541
For g  10  test metrics, TP:  2487 , FP:  520 , FN: 1202 , P: 82.70701696042568 , R: 67.41664407698563 , F1: 74.2831541218638
For g  9  test metrics, TP:  2628 , FP:  533 , FN: 1061 , P: 83.13824739006644 , R: 71.23881810788832 , F1: 76.72992700729927
For g  8  test metrics, TP:  2636 , FP:  558 , FN: 1053 , P: 82.52974326862868 , R: 71.45567904581188 , F1: 76.59450820862996
For g  7  test metrics, TP:  2639 , FP:  572 , FN: 1050 , P: 82.18623481781377 , R: 71.5370018975332 , F1: 76.4927536231884
For g  6  test metrics, TP:  2649 , FP:  587 , FN: 1040 , P: 81.86032138442522 , R: 71.80807806993765 , F1: 76.50541516245487
For g  5  test metrics, TP:  2666 , FP:  733 , FN: 1023 , P: 78.4348337746396 , R: 72.26890756302521 , F1: 75.22573363431151
For g  4  test metrics, TP:  2735 , FP:  905 , FN: 954 , P: 75.13736263736264 , R: 74.13933315261589 , F1: 74.63501159776233
For g  3  test metrics, TP:  2747 , FP:  1067 , FN: 942 , P: 72.02412165705296 , R: 74.46462455950122 , F1: 73.22404371584699
For g  2  test metrics, TP:  3679 , FP:  7177 , FN: 10 , P: 33.88909358879882 , R: 99.72892382759555 , F1: 50.58783086971468
For g  1  test metrics, TP:  3689 , FP:  12759 , FN: 0 , P: 22.428258754863812 , R: 100.0 , F1: 36.63902269454239
Ce a dat pe validare
10 533 1061 83.13824739006644 71.23881810788832

Best threshold 9
Confusion matrix
TP: 2628, TN: 12526, FP: 533, FN: 1061, FNR: 0.2876118189211168, FPR: 0.040814763764453636
Precision: 83.138%, Recall: 71.239%, F1-measure: 76.730%, Specificity: 0.959, Lead time: 15.157
elapsed_time: 456.6604759693146
Log saved

Starting EPOCH: 5 | phase: train | ⏰: 19:54:25 | Learning rate: 0.001000
Train loss: 0.54055568 - Train acc: 0.80 - Train kurtosis: -0.70 - Train skewness: -0.90: 100%|██████████| 477/477 [04:02<00:00,  1.97it/s]
Eliminated instances percentage:  0.04869293908308939 23753/487812
Eliminated anomalies percentage:  0.17951416663158337 4264/23753

Starting epoch: 5 | phase: valid | ⏰: 19:58:33
: 100%|██████████| 53/53 [00:08<00:00,  6.09it/s]

Validation loss: 0.4291567566259852 Validation accuracy: 0.8302060847585838 Validation kurtosis: -0.4057515561580658 Validation skewness: -1.0657786130905151
Save model checkpoint at dataset/hdfs/deeplog/deeplog.pth
======== My contribution ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/train.pkl
Length test 57506
Nr secvente unice train: normale vs anormale
3773 607
: 100%|██████████| 107/107 [00:16<00:00,  6.65it/s]
: 100%|██████████| 19/19 [00:02<00:00,  8.13it/s]
------------------------JUST NORMAL FOR ELBOW TRAIN SEQUENCES----------------------------
For g  20  train metrics, TP:  26 , FP:  41 , FN: 1623 , P: 38.80597014925373 , R: 1.5767131594906003 , F1: 3.03030303030303
For g  19  train metrics, TP:  26 , FP:  41 , FN: 1623 , P: 38.80597014925373 , R: 1.5767131594906003 , F1: 3.03030303030303
For g  18  train metrics, TP:  30 , FP:  42 , FN: 1619 , P: 41.666666666666664 , R: 1.8192844147968465 , F1: 3.486345148169669
For g  17  train metrics, TP:  62 , FP:  42 , FN: 1587 , P: 59.61538461538461 , R: 3.759854457246816 , F1: 7.073588134626355
For g  16  train metrics, TP:  63 , FP:  44 , FN: 1586 , P: 58.87850467289719 , R: 3.820497271073378 , F1: 7.175398633257403
For g  15  train metrics, TP:  63 , FP:  47 , FN: 1586 , P: 57.27272727272727 , R: 3.820497271073378 , F1: 7.163160886867538
For g  14  train metrics, TP:  101 , FP:  56 , FN: 1548 , P: 64.3312101910828 , R: 6.124924196482716 , F1: 11.184939091915835
For g  13  train metrics, TP:  121 , FP:  89 , FN: 1528 , P: 57.61904761904762 , R: 7.3377804730139475 , F1: 13.01775147928994
For g  12  train metrics, TP:  226 , FP:  148 , FN: 1423 , P: 60.42780748663102 , R: 13.70527592480291 , F1: 22.343054869006426
For g  11  train metrics, TP:  426 , FP:  152 , FN: 1223 , P: 73.70242214532873 , R: 25.833838690115222 , F1: 38.257745846430176
For g  10  train metrics, TP:  519 , FP:  274 , FN: 1130 , P: 65.44766708701135 , R: 31.473620375985444 , F1: 42.5061425061425
For g  9  train metrics, TP:  535 , FP:  289 , FN: 1114 , P: 64.92718446601941 , R: 32.44390539721043 , F1: 43.267286696320255
For g  8  train metrics, TP:  579 , FP:  304 , FN: 1070 , P: 65.57191392978483 , R: 35.11218920557914 , F1: 45.73459715639811
For g  7  train metrics, TP:  655 , FP:  322 , FN: 994 , P: 67.04196519959058 , R: 39.72104305639782 , F1: 49.88575780654988
For g  6  train metrics, TP:  1061 , FP:  334 , FN: 588 , P: 76.05734767025089 , R: 64.3420254699818 , F1: 69.71090670170828
For g  5  train metrics, TP:  1196 , FP:  359 , FN: 453 , P: 76.91318327974277 , R: 72.52880533656761 , F1: 74.65667915106118
For g  4  train metrics, TP:  1198 , FP:  374 , FN: 451 , P: 76.20865139949109 , R: 72.65009096422074 , F1: 74.38683638621545
For g  3  train metrics, TP:  1209 , FP:  416 , FN: 440 , P: 74.4 , R: 73.31716191631291 , F1: 73.85461209529628
For g  2  train metrics, TP:  1271 , FP:  8274 , FN: 378 , P: 13.315872184389733 , R: 77.07701637355973 , F1: 22.708593889583703
For g  1  train metrics, TP:  1464 , FP:  17845 , FN: 185 , P: 7.581956600548967 , R: 88.78107944208611 , F1: 13.97079874033782
Ce a dat pe train
6 359 453 76.91318327974277 72.52880533656761

[67, 67, 72, 104, 107, 110, 157, 210, 374, 578, 793, 824, 883, 977, 1395, 1555, 1572, 1625, 9545, 19309]
Changes in number of anomalies
Pentru g 33 anomalies diff:0
Pentru g 32 anomalies diff:5
Pentru g 31 anomalies diff:32
Pentru g 30 anomalies diff:3
Pentru g 29 anomalies diff:3
Pentru g 28 anomalies diff:47
Pentru g 27 anomalies diff:53
Pentru g 26 anomalies diff:164
Pentru g 25 anomalies diff:204
Pentru g 24 anomalies diff:215
Pentru g 23 anomalies diff:31
Pentru g 22 anomalies diff:59
Pentru g 21 anomalies diff:94
Pentru g 20 anomalies diff:418
Pentru g 19 anomalies diff:160
Pentru g 18 anomalies diff:17
Pentru g 17 anomalies diff:53
Pentru g 16 anomalies diff:7920
Pentru g 15 anomalies diff:9764
elapsed_time: 56.86183404922485
======== Their approach ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/test.pkl
Length test 517555
Nr secvente unice test: normale vs anormale
13059 3689
: 100%|██████████| 389/389 [01:02<00:00,  6.20it/s]
: 100%|██████████| 120/120 [00:17<00:00,  6.86it/s]
------------------------NORMAL TEST SEQUENCES----------------------------
For g  20  test metrics, TP:  208 , FP:  356 , FN: 14981 , P: 36.87943262411348 , R: 1.3694120745276186 , F1: 2.6407668380625915
For g  19  test metrics, TP:  208 , FP:  356 , FN: 14981 , P: 36.87943262411348 , R: 1.3694120745276186 , F1: 2.6407668380625915
For g  18  test metrics, TP:  220 , FP:  360 , FN: 14969 , P: 37.93103448275862 , R: 1.4484166172888275 , F1: 2.7902847358741836
For g  17  test metrics, TP:  516 , FP:  372 , FN: 14673 , P: 58.108108108108105 , R: 3.397195338731977 , F1: 6.419108042545251
For g  16  test metrics, TP:  530 , FP:  411 , FN: 14659 , P: 56.323060573857596 , R: 3.4893673052867205 , F1: 6.57160570365778
For g  15  test metrics, TP:  539 , FP:  441 , FN: 14650 , P: 55.0 , R: 3.548620712357627 , F1: 6.667078978291793
For g  14  test metrics, TP:  857 , FP:  516 , FN: 14332 , P: 62.418062636562276 , R: 5.64224109552966 , F1: 10.348991667672987
For g  13  test metrics, TP:  1012 , FP:  832 , FN: 14177 , P: 54.88069414316703 , R: 6.662716439528606 , F1: 11.88281571067927
For g  12  test metrics, TP:  1938 , FP:  1298 , FN: 13251 , P: 59.88875154511743 , R: 12.759233655935216 , F1: 21.03663500678426
For g  11  test metrics, TP:  3758 , FP:  1334 , FN: 11431 , P: 73.80204241948154 , R: 24.74158930805188 , F1: 37.05931660174548
For g  10  test metrics, TP:  4668 , FP:  2376 , FN: 10521 , P: 66.26916524701873 , R: 30.73276713411021 , F1: 41.99163405748212
For g  9  test metrics, TP:  4864 , FP:  2453 , FN: 10325 , P: 66.47533141998086 , R: 32.023174665876624 , F1: 43.224029147782815
For g  8  test metrics, TP:  5311 , FP:  2598 , FN: 9878 , P: 67.15134656720193 , R: 34.966093883731645 , F1: 45.98666551216555
For g  7  test metrics, TP:  6048 , FP:  2724 , FN: 9141 , P: 68.94664842681259 , R: 39.81828955164922 , F1: 50.482033304119206
For g  6  test metrics, TP:  9836 , FP:  2869 , FN: 5353 , P: 77.41833923652105 , R: 64.75739021660412 , F1: 70.52412705241271
For g  5  test metrics, TP:  11027 , FP:  3051 , FN: 4162 , P: 78.32788748401762 , R: 72.59859108565409 , F1: 75.35449482352139
For g  4  test metrics, TP:  11038 , FP:  3225 , FN: 4151 , P: 77.38904858725374 , R: 72.67101191651854 , F1: 74.95586038299608
For g  3  test metrics, TP:  11128 , FP:  3556 , FN: 4061 , P: 75.78316535004086 , R: 73.2635459872276 , F1: 74.5020587152278
For g  2  test metrics, TP:  11693 , FP:  74553 , FN: 3496 , P: 13.557730213575123 , R: 76.98334320890118 , F1: 23.055158475871245
For g  1  test metrics, TP:  13393 , FP:  158261 , FN: 1796 , P: 7.802323278222471 , R: 88.17565343340576 , F1: 14.336100362336293
Ce a dat pe validare
6 3051 4162 78.32788748401762 72.59859108565409

Best threshold 5
Confusion matrix
TP: 11027, TN: 499315, FP: 3051, FN: 4162, FNR: 0.2740140891434591, FPR: 0.0060732613273987495
Precision: 78.328%, Recall: 72.599%, F1-measure: 75.354%, Specificity: 0.994
--------------------------UNIQUE TEST SEQUENCES------------------------------------
For g  20  test metrics, TP:  173 , FP:  60 , FN: 3516 , P: 74.2489270386266 , R: 4.68961778259691 , F1: 8.822029576746559
For g  19  test metrics, TP:  173 , FP:  60 , FN: 3516 , P: 74.2489270386266 , R: 4.68961778259691 , F1: 8.822029576746559
For g  18  test metrics, TP:  185 , FP:  64 , FN: 3504 , P: 74.29718875502007 , R: 5.014909189482244 , F1: 9.395632300660234
For g  17  test metrics, TP:  250 , FP:  73 , FN: 3439 , P: 77.39938080495357 , R: 6.776904310111141 , F1: 12.462612163509473
For g  16  test metrics, TP:  264 , FP:  107 , FN: 3425 , P: 71.15902964959568 , R: 7.1564109514773655 , F1: 13.004926108374384
For g  15  test metrics, TP:  273 , FP:  133 , FN: 3416 , P: 67.24137931034483 , R: 7.400379506641366 , F1: 13.333333333333332
For g  14  test metrics, TP:  344 , FP:  191 , FN: 3345 , P: 64.29906542056075 , R: 9.325020330712931 , F1: 16.28787878787879
For g  13  test metrics, TP:  430 , FP:  325 , FN: 3259 , P: 56.95364238410596 , R: 11.656275413391162 , F1: 19.35193519351935
For g  12  test metrics, TP:  1093 , FP:  540 , FN: 2596 , P: 66.93202694427434 , R: 29.628625643805908 , F1: 41.07478391582112
For g  11  test metrics, TP:  1228 , FP:  572 , FN: 2461 , P: 68.22222222222223 , R: 33.28815397126593 , F1: 44.744033521588634
For g  10  test metrics, TP:  1580 , FP:  764 , FN: 2109 , P: 67.4061433447099 , R: 42.830035239902415 , F1: 52.37858445217968
For g  9  test metrics, TP:  1700 , FP:  825 , FN: 1989 , P: 67.32673267326733 , R: 46.08294930875576 , F1: 54.71515931766977
For g  8  test metrics, TP:  1925 , FP:  894 , FN: 1764 , P: 68.28662646328485 , R: 52.182163187855785 , F1: 59.15795943454209
For g  7  test metrics, TP:  2225 , FP:  978 , FN: 1464 , P: 69.46612550733687 , R: 60.31444835998916 , F1: 64.56761462565292
For g  6  test metrics, TP:  2654 , FP:  1083 , FN: 1035 , P: 71.01953438587103 , R: 71.94361615613988 , F1: 71.47858874225695
For g  5  test metrics, TP:  2671 , FP:  1148 , FN: 1018 , P: 69.93977481015973 , R: 72.40444564922743 , F1: 71.15077250932339
For g  4  test metrics, TP:  2681 , FP:  1215 , FN: 1008 , P: 68.8141683778234 , R: 72.67552182163188 , F1: 70.69215557020435
For g  3  test metrics, TP:  2747 , FP:  1293 , FN: 942 , P: 67.9950495049505 , R: 74.46462455950122 , F1: 71.08293440289818
For g  2  test metrics, TP:  3102 , FP:  7133 , FN: 587 , P: 30.307767464582316 , R: 84.08782867985904 , F1: 44.55616202240736
For g  1  test metrics, TP:  3568 , FP:  11625 , FN: 121 , P: 23.484499440531824 , R: 96.71997831390621 , F1: 37.79260671539032
Ce a dat pe validare
7 1083 1035 71.01953438587103 71.94361615613988

Best threshold 6
Confusion matrix
TP: 2654, TN: 11976, FP: 1083, FN: 1035, FNR: 0.2805638384386012, FPR: 0.08293131173903055
Precision: 71.020%, Recall: 71.944%, F1-measure: 71.479%, Specificity: 0.917, Lead time: 15.193
elapsed_time: 502.0347456932068
Log saved

Starting EPOCH: 6 | phase: train | ⏰: 20:08:14 | Learning rate: 0.001000
Train loss: 0.39975943 - Train acc: 0.85 - Train kurtosis: -0.08 - Train skewness: -1.19: 100%|██████████| 477/477 [03:15<00:00,  2.44it/s]
:  55%|█████▍    | 29/53 [00:03<00:03,  7.94it/s]Eliminated instances percentage:  0.07840930522414373 38249/487812
Eliminated anomalies percentage:  0.1241862532353787 4750/38249

Starting epoch: 6 | phase: valid | ⏰: 20:11:32
: 100%|██████████| 53/53 [00:06<00:00,  8.18it/s]

Validation loss: 0.36253688639065007 Validation accuracy: 0.8665707274773529 Validation kurtosis: 0.29631197452545166 Validation skewness: -1.3127115964889526
Save model checkpoint at dataset/hdfs/deeplog/deeplog.pth
======== My contribution ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/train.pkl
Length test 57506
Nr secvente unice train: normale vs anormale
3773 607
: 100%|██████████| 107/107 [00:14<00:00,  7.53it/s]
: 100%|██████████| 19/19 [00:01<00:00, 11.44it/s]
------------------------JUST NORMAL FOR ELBOW TRAIN SEQUENCES----------------------------
For g  20  train metrics, TP:  24 , FP:  15 , FN: 1625 , P: 61.53846153846154 , R: 1.4554275318374772 , F1: 2.8436018957345968
For g  19  train metrics, TP:  24 , FP:  15 , FN: 1625 , P: 61.53846153846154 , R: 1.4554275318374772 , F1: 2.8436018957345968
For g  18  train metrics, TP:  25 , FP:  17 , FN: 1624 , P: 59.523809523809526 , R: 1.5160703456640388 , F1: 2.9568302779420463
For g  17  train metrics, TP:  29 , FP:  47 , FN: 1620 , P: 38.1578947368421 , R: 1.758641600970285 , F1: 3.3623188405797104
For g  16  train metrics, TP:  31 , FP:  48 , FN: 1618 , P: 39.24050632911393 , R: 1.879927228623408 , F1: 3.5879629629629632
For g  15  train metrics, TP:  34 , FP:  65 , FN: 1615 , P: 34.343434343434346 , R: 2.0618556701030926 , F1: 3.8901601830663615
For g  14  train metrics, TP:  65 , FP:  79 , FN: 1584 , P: 45.138888888888886 , R: 3.941782898726501 , F1: 7.2504182933630785
For g  13  train metrics, TP:  65 , FP:  87 , FN: 1584 , P: 42.76315789473684 , R: 3.941782898726501 , F1: 7.218212104386453
For g  12  train metrics, TP:  131 , FP:  100 , FN: 1518 , P: 56.70995670995671 , R: 7.944208611279564 , F1: 13.93617021276596
For g  11  train metrics, TP:  134 , FP:  130 , FN: 1515 , P: 50.75757575757576 , R: 8.126137052759248 , F1: 14.009409304756927
For g  10  train metrics, TP:  233 , FP:  176 , FN: 1416 , P: 56.9682151589242 , R: 14.129775621588841 , F1: 22.643343051506317
For g  9  train metrics, TP:  276 , FP:  190 , FN: 1373 , P: 59.227467811158796 , R: 16.73741661613099 , F1: 26.099290780141843
For g  8  train metrics, TP:  322 , FP:  224 , FN: 1327 , P: 58.97435897435897 , R: 19.52698605215282 , F1: 29.339407744874723
For g  7  train metrics, TP:  459 , FP:  355 , FN: 1190 , P: 56.38820638820639 , R: 27.835051546391753 , F1: 37.27161997563947
For g  6  train metrics, TP:  471 , FP:  361 , FN: 1178 , P: 56.61057692307692 , R: 28.562765312310493 , F1: 37.96856106408707
For g  5  train metrics, TP:  752 , FP:  370 , FN: 897 , P: 67.02317290552584 , R: 45.60339599757429 , F1: 54.27643450018044
For g  4  train metrics, TP:  753 , FP:  374 , FN: 896 , P: 66.8145519077196 , R: 45.66403881140085 , F1: 54.2507204610951
For g  3  train metrics, TP:  760 , FP:  405 , FN: 889 , P: 65.23605150214593 , R: 46.08853850818678 , F1: 54.015636105188335
For g  2  train metrics, TP:  819 , FP:  7780 , FN: 830 , P: 9.524363298057914 , R: 49.66646452395391 , F1: 15.98360655737705
For g  1  train metrics, TP:  1004 , FP:  14975 , FN: 645 , P: 6.283246761374304 , R: 60.885385081867796 , F1: 11.390968913092808
Ce a dat pe train
6 370 897 67.02317290552584 45.60339599757429

[39, 39, 42, 76, 79, 99, 144, 152, 231, 264, 409, 466, 546, 814, 832, 1122, 1127, 1165, 8599, 15979]
Changes in number of anomalies
Pentru g 33 anomalies diff:0
Pentru g 32 anomalies diff:3
Pentru g 31 anomalies diff:34
Pentru g 30 anomalies diff:3
Pentru g 29 anomalies diff:20
Pentru g 28 anomalies diff:45
Pentru g 27 anomalies diff:8
Pentru g 26 anomalies diff:79
Pentru g 25 anomalies diff:33
Pentru g 24 anomalies diff:145
Pentru g 23 anomalies diff:57
Pentru g 22 anomalies diff:80
Pentru g 21 anomalies diff:268
Pentru g 20 anomalies diff:18
Pentru g 19 anomalies diff:290
Pentru g 18 anomalies diff:5
Pentru g 17 anomalies diff:38
Pentru g 16 anomalies diff:7434
Pentru g 15 anomalies diff:7380
elapsed_time: 42.03414988517761
======== Their approach ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/test.pkl
Length test 517555
Nr secvente unice test: normale vs anormale
13059 3689
: 100%|██████████| 389/389 [00:44<00:00,  8.71it/s]
: 100%|██████████| 120/120 [00:11<00:00, 10.89it/s]
------------------------NORMAL TEST SEQUENCES----------------------------
For g  20  test metrics, TP:  198 , FP:  178 , FN: 14991 , P: 52.659574468085104 , R: 1.3035749555599447 , F1: 2.5441696113074204
For g  19  test metrics, TP:  198 , FP:  178 , FN: 14991 , P: 52.659574468085104 , R: 1.3035749555599447 , F1: 2.5441696113074204
For g  18  test metrics, TP:  212 , FP:  206 , FN: 14977 , P: 50.717703349282296 , R: 1.3957469221146883 , F1: 2.716729672582815
For g  17  test metrics, TP:  233 , FP:  419 , FN: 14956 , P: 35.736196319018404 , R: 1.5340048719468036 , F1: 2.941733476421943
For g  16  test metrics, TP:  239 , FP:  463 , FN: 14950 , P: 34.04558404558404 , R: 1.573507143327408 , F1: 3.0079919451261716
For g  15  test metrics, TP:  264 , FP:  610 , FN: 14925 , P: 30.205949656750573 , R: 1.738099940746593 , F1: 3.287057212226857
For g  14  test metrics, TP:  537 , FP:  732 , FN: 14652 , P: 42.31678486997636 , R: 3.5354532885640926 , F1: 6.5257017863652935
For g  13  test metrics, TP:  549 , FP:  801 , FN: 14640 , P: 40.666666666666664 , R: 3.6144578313253013 , F1: 6.6388536187193905
For g  12  test metrics, TP:  1082 , FP:  955 , FN: 14107 , P: 53.1173294059892 , R: 7.123576272302324 , F1: 12.562405665853941
For g  11  test metrics, TP:  1141 , FP:  1117 , FN: 14048 , P: 50.531443755535875 , R: 7.512015274211601 , F1: 13.079612540837967
For g  10  test metrics, TP:  2036 , FP:  1505 , FN: 13153 , P: 57.49788195425021 , R: 13.404437421818422 , F1: 21.740523224773092
For g  9  test metrics, TP:  2461 , FP:  1669 , FN: 12728 , P: 59.58837772397094 , R: 16.202514977944563 , F1: 25.47750918784616
For g  8  test metrics, TP:  2940 , FP:  1956 , FN: 12249 , P: 60.049019607843135 , R: 19.35611297649615 , F1: 29.2755787901419
For g  7  test metrics, TP:  4264 , FP:  3084 , FN: 10925 , P: 58.02939575394665 , R: 28.072947527816183 , F1: 37.83999645028175
For g  6  test metrics, TP:  4362 , FP:  3128 , FN: 10827 , P: 58.23765020026702 , R: 28.71815129369939 , F1: 38.46730455487456
For g  5  test metrics, TP:  6949 , FP:  3194 , FN: 8240 , P: 68.51030267179335 , R: 45.75021397063664 , F1: 54.86341386388758
For g  4  test metrics, TP:  6955 , FP:  3240 , FN: 8234 , P: 68.21971554683668 , R: 45.78971624201725 , F1: 54.79829814056098
For g  3  test metrics, TP:  7004 , FP:  3482 , FN: 8185 , P: 66.79382033187106 , R: 46.112318124958854 , F1: 54.55890944498539
For g  2  test metrics, TP:  7557 , FP:  68661 , FN: 7632 , P: 9.91498071321735 , R: 49.75311080387122 , F1: 16.53483868850307
For g  1  test metrics, TP:  9224 , FP:  133052 , FN: 5965 , P: 6.483173550001406 , R: 60.72815853578248 , F1: 11.715619343981205
Ce a dat pe validare
6 3194 8240 68.51030267179335 45.75021397063664

Best threshold 5
Confusion matrix
TP: 6949, TN: 499172, FP: 3194, FN: 8240, FNR: 0.5424978602936336, FPR: 0.006357914349299117
Precision: 68.510%, Recall: 45.750%, F1-measure: 54.863%, Specificity: 0.994
--------------------------UNIQUE TEST SEQUENCES------------------------------------
For g  20  test metrics, TP:  164 , FP:  52 , FN: 3525 , P: 75.92592592592592 , R: 4.4456492274329085 , F1: 8.399487836107555
For g  19  test metrics, TP:  164 , FP:  52 , FN: 3525 , P: 75.92592592592592 , R: 4.4456492274329085 , F1: 8.399487836107555
For g  18  test metrics, TP:  178 , FP:  79 , FN: 3511 , P: 69.26070038910505 , R: 4.825155868799133 , F1: 9.021794221996961
For g  17  test metrics, TP:  197 , FP:  115 , FN: 3492 , P: 63.14102564102564 , R: 5.34020059636758 , F1: 9.847538115471135
For g  16  test metrics, TP:  203 , FP:  151 , FN: 3486 , P: 57.344632768361585 , R: 5.502846299810247 , F1: 10.042047984170171
For g  15  test metrics, TP:  226 , FP:  182 , FN: 3463 , P: 55.3921568627451 , R: 6.126321496340472 , F1: 11.032462777642177
For g  14  test metrics, TP:  273 , FP:  260 , FN: 3416 , P: 51.21951219512195 , R: 7.400379506641366 , F1: 12.932259592610139
For g  13  test metrics, TP:  283 , FP:  303 , FN: 3406 , P: 48.29351535836177 , R: 7.6714556790458115 , F1: 13.239766081871345
For g  12  test metrics, TP:  484 , FP:  411 , FN: 3205 , P: 54.07821229050279 , R: 13.12008674437517 , F1: 21.11692844677138
For g  11  test metrics, TP:  541 , FP:  513 , FN: 3148 , P: 51.32827324478178 , R: 14.66522092708051 , F1: 22.81256588656968
For g  10  test metrics, TP:  1188 , FP:  671 , FN: 2501 , P: 63.905325443786985 , R: 32.20384928164815 , F1: 42.82624369142033
For g  9  test metrics, TP:  1378 , FP:  721 , FN: 2311 , P: 65.65030967127204 , R: 37.35429655733261 , F1: 47.61575673807879
For g  8  test metrics, TP:  1650 , FP:  844 , FN: 2039 , P: 66.158781074579 , R: 44.727568446733535 , F1: 53.37214944201844
For g  7  test metrics, TP:  2153 , FP:  1118 , FN: 1536 , P: 65.82084989299908 , R: 58.36269991867715 , F1: 61.86781609195402
For g  6  test metrics, TP:  2226 , FP:  1144 , FN: 1463 , P: 66.05341246290801 , R: 60.3415559772296 , F1: 63.068423289417765
For g  5  test metrics, TP:  2675 , FP:  1192 , FN: 1014 , P: 69.17507111455909 , R: 72.51287611818921 , F1: 70.80465854949709
For g  4  test metrics, TP:  2681 , FP:  1223 , FN: 1008 , P: 68.67315573770492 , R: 72.67552182163188 , F1: 70.61767417358092
For g  3  test metrics, TP:  2720 , FP:  1287 , FN: 969 , P: 67.88120788619915 , R: 73.73271889400921 , F1: 70.68607068607068
For g  2  test metrics, TP:  3087 , FP:  6610 , FN: 602 , P: 31.83458801691245 , R: 83.68121442125238 , F1: 46.122814881219185
For g  1  test metrics, TP:  3440 , FP:  11725 , FN: 249 , P: 22.683811407847017 , R: 93.2502033071293 , F1: 36.49093030656625
Ce a dat pe validare
6 1192 1014 69.17507111455909 72.51287611818921

Best threshold 5
Confusion matrix
TP: 2675, TN: 11867, FP: 1192, FN: 1014, FNR: 0.2748712388181079, FPR: 0.09127804579217398
Precision: 69.175%, Recall: 72.513%, F1-measure: 70.805%, Specificity: 0.909, Lead time: 14.735
elapsed_time: 358.92258620262146
Log saved

Starting EPOCH: 7 | phase: train | ⏰: 20:18:28 | Learning rate: 0.001000
Train loss: 0.35246775 - Train acc: 0.87 - Train kurtosis: 0.52 - Train skewness: -1.39: 100%|██████████| 477/477 [02:52<00:00,  2.76it/s]
Eliminated instances percentage:  0.160508556575074 78298/487812
Eliminated anomalies percentage:  0.07629824516590462 5974/78298

Starting epoch: 7 | phase: valid | ⏰: 20:21:22
: 100%|██████████| 53/53 [00:06<00:00,  8.78it/s]

Validation loss: 0.32827950479849327 Validation accuracy: 0.8778435822217302 Validation kurtosis: 1.0012754201889038 Validation skewness: -1.5325267314910889
Save model checkpoint at dataset/hdfs/deeplog/deeplog.pth
======== My contribution ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/train.pkl
Length test 57506
Nr secvente unice train: normale vs anormale
3773 607
: 100%|██████████| 107/107 [00:11<00:00,  9.30it/s]
: 100%|██████████| 19/19 [00:02<00:00,  8.64it/s]
------------------------JUST NORMAL FOR ELBOW TRAIN SEQUENCES----------------------------
For g  20  train metrics, TP:  18 , FP:  9 , FN: 1631 , P: 66.66666666666667 , R: 1.0915706488781078 , F1: 2.1479713603818613
For g  19  train metrics, TP:  18 , FP:  9 , FN: 1631 , P: 66.66666666666667 , R: 1.0915706488781078 , F1: 2.1479713603818613
For g  18  train metrics, TP:  18 , FP:  9 , FN: 1631 , P: 66.66666666666667 , R: 1.0915706488781078 , F1: 2.1479713603818613
For g  17  train metrics, TP:  23 , FP:  13 , FN: 1626 , P: 63.888888888888886 , R: 1.3947847180109156 , F1: 2.7299703264094957
For g  16  train metrics, TP:  28 , FP:  13 , FN: 1621 , P: 68.29268292682927 , R: 1.6979987871437234 , F1: 3.3136094674556213
For g  15  train metrics, TP:  30 , FP:  47 , FN: 1619 , P: 38.96103896103896 , R: 1.8192844147968465 , F1: 3.4762456546929315
For g  14  train metrics, TP:  34 , FP:  73 , FN: 1615 , P: 31.77570093457944 , R: 2.0618556701030926 , F1: 3.872437357630979
For g  13  train metrics, TP:  35 , FP:  75 , FN: 1614 , P: 31.818181818181817 , R: 2.1224984839296543 , F1: 3.979533826037521
For g  12  train metrics, TP:  53 , FP:  82 , FN: 1596 , P: 39.25925925925926 , R: 3.2140691328077624 , F1: 5.94170403587444
For g  11  train metrics, TP:  138 , FP:  102 , FN: 1511 , P: 57.5 , R: 8.368708308065495 , F1: 14.610905240868187
For g  10  train metrics, TP:  163 , FP:  149 , FN: 1486 , P: 52.243589743589745 , R: 9.884778653729533 , F1: 16.624171341152472
For g  9  train metrics, TP:  209 , FP:  166 , FN: 1440 , P: 55.733333333333334 , R: 12.674348089751364 , F1: 20.652173913043477
For g  8  train metrics, TP:  310 , FP:  214 , FN: 1339 , P: 59.16030534351145 , R: 18.799272286234082 , F1: 28.53198343304188
For g  7  train metrics, TP:  378 , FP:  278 , FN: 1271 , P: 57.6219512195122 , R: 22.922983626440267 , F1: 32.79826464208243
For g  6  train metrics, TP:  427 , FP:  334 , FN: 1222 , P: 56.11038107752957 , R: 25.894481503941783 , F1: 35.43568464730291
For g  5  train metrics, TP:  447 , FP:  349 , FN: 1202 , P: 56.15577889447236 , R: 27.107337780473014 , F1: 36.56441717791411
For g  4  train metrics, TP:  632 , FP:  371 , FN: 1017 , P: 63.01096709870389 , R: 38.3262583383869 , F1: 47.66214177978884
For g  3  train metrics, TP:  757 , FP:  405 , FN: 892 , P: 65.14629948364887 , R: 45.906610066707096 , F1: 53.85983635716827
For g  2  train metrics, TP:  813 , FP:  7955 , FN: 836 , P: 9.272354014598541 , R: 49.302607640994545 , F1: 15.60910050878372
For g  1  train metrics, TP:  875 , FP:  16929 , FN: 774 , P: 4.914625926758032 , R: 53.06246209824136 , F1: 8.99604174163368
Ce a dat pe train
4 405 892 65.14629948364887 45.906610066707096

[27, 27, 27, 36, 41, 77, 107, 110, 135, 240, 312, 375, 524, 656, 761, 796, 1003, 1162, 8768, 17804]
Changes in number of anomalies
Pentru g 33 anomalies diff:0
Pentru g 32 anomalies diff:0
Pentru g 31 anomalies diff:9
Pentru g 30 anomalies diff:5
Pentru g 29 anomalies diff:36
Pentru g 28 anomalies diff:30
Pentru g 27 anomalies diff:3
Pentru g 26 anomalies diff:25
Pentru g 25 anomalies diff:105
Pentru g 24 anomalies diff:72
Pentru g 23 anomalies diff:63
Pentru g 22 anomalies diff:149
Pentru g 21 anomalies diff:132
Pentru g 20 anomalies diff:105
Pentru g 19 anomalies diff:35
Pentru g 18 anomalies diff:207
Pentru g 17 anomalies diff:159
Pentru g 16 anomalies diff:7606
Pentru g 15 anomalies diff:9036
elapsed_time: 40.77806210517883
======== Their approach ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/test.pkl
Length test 517555
Nr secvente unice test: normale vs anormale
13059 3689
: 100%|██████████| 389/389 [00:45<00:00,  8.61it/s]
: 100%|██████████| 120/120 [00:10<00:00, 11.07it/s]
------------------------NORMAL TEST SEQUENCES----------------------------
For g  20  test metrics, TP:  181 , FP:  114 , FN: 15008 , P: 61.355932203389834 , R: 1.191651853314899 , F1: 2.3378971841901315
For g  19  test metrics, TP:  181 , FP:  114 , FN: 15008 , P: 61.355932203389834 , R: 1.191651853314899 , F1: 2.3378971841901315
For g  18  test metrics, TP:  186 , FP:  131 , FN: 15003 , P: 58.67507886435331 , R: 1.224570412798736 , F1: 2.39907132722817
For g  17  test metrics, TP:  197 , FP:  147 , FN: 14992 , P: 57.26744186046512 , R: 1.2969912436631772 , F1: 2.5365351187793728
For g  16  test metrics, TP:  222 , FP:  163 , FN: 14967 , P: 57.66233766233766 , R: 1.4615840410823622 , F1: 2.8509053550789774
For g  15  test metrics, TP:  233 , FP:  420 , FN: 14956 , P: 35.68147013782542 , R: 1.5340048719468036 , F1: 2.94154778437066
For g  14  test metrics, TP:  246 , FP:  633 , FN: 14943 , P: 27.986348122866893 , R: 1.6195931266047798 , F1: 3.0619865571321885
For g  13  test metrics, TP:  266 , FP:  668 , FN: 14923 , P: 28.4796573875803 , R: 1.7512673645401278 , F1: 3.2996340631396146
For g  12  test metrics, TP:  385 , FP:  745 , FN: 14804 , P: 34.07079646017699 , R: 2.534729080255448 , F1: 4.718426374165084
For g  11  test metrics, TP:  1158 , FP:  962 , FN: 14031 , P: 54.62264150943396 , R: 7.623938376456646 , F1: 13.380322375642727
For g  10  test metrics, TP:  1468 , FP:  1270 , FN: 13721 , P: 53.61577794010226 , R: 9.66488906445454 , F1: 16.37753109834328
For g  9  test metrics, TP:  1890 , FP:  1405 , FN: 13299 , P: 57.359635811836114 , R: 12.44321548489038 , F1: 20.450119021856743
For g  8  test metrics, TP:  2728 , FP:  1811 , FN: 12461 , P: 60.101343908349854 , R: 17.96036605438146 , F1: 27.65612327656123
For g  7  test metrics, TP:  3449 , FP:  2405 , FN: 11740 , P: 58.9169798428425 , R: 22.707222331950753 , F1: 32.78049707741292
For g  6  test metrics, TP:  3978 , FP:  2909 , FN: 11211 , P: 57.76099898359227 , R: 26.190005925340706 , F1: 36.03913752491393
For g  5  test metrics, TP:  4229 , FP:  3019 , FN: 10960 , P: 58.34713024282561 , R: 27.842517611429322 , F1: 37.696661764050454
For g  4  test metrics, TP:  5858 , FP:  3240 , FN: 9331 , P: 64.38777753352385 , R: 38.567384291263416 , F1: 48.23979906946103
For g  3  test metrics, TP:  6970 , FP:  3495 , FN: 8219 , P: 66.60296225513616 , R: 45.88847192046876 , F1: 54.33850471661339
For g  2  test metrics, TP:  7490 , FP:  70762 , FN: 7699 , P: 9.57164034146092 , R: 49.31200210678781 , F1: 16.031506512130647
For g  1  test metrics, TP:  8149 , FP:  150875 , FN: 7040 , P: 5.124383740818996 , R: 53.65066824675752 , F1: 9.355214593629638
Ce a dat pe validare
4 3495 8219 66.60296225513616 45.88847192046876

Best threshold 3
Confusion matrix
TP: 6970, TN: 498871, FP: 3495, FN: 8219, FNR: 0.5411152807953123, FPR: 0.0069570791016908
Precision: 66.603%, Recall: 45.888%, F1-measure: 54.339%, Specificity: 0.993
--------------------------UNIQUE TEST SEQUENCES------------------------------------
For g  20  test metrics, TP:  148 , FP:  93 , FN: 3541 , P: 61.41078838174274 , R: 4.011927351585795 , F1: 7.531806615776081
For g  19  test metrics, TP:  148 , FP:  93 , FN: 3541 , P: 61.41078838174274 , R: 4.011927351585795 , F1: 7.531806615776081
For g  18  test metrics, TP:  153 , FP:  109 , FN: 3536 , P: 58.396946564885496 , R: 4.147465437788019 , F1: 7.744874715261959
For g  17  test metrics, TP:  163 , FP:  123 , FN: 3526 , P: 56.99300699300699 , R: 4.418541610192464 , F1: 8.20125786163522
For g  16  test metrics, TP:  186 , FP:  136 , FN: 3503 , P: 57.7639751552795 , R: 5.042016806722689 , F1: 9.274495138369483
For g  15  test metrics, TP:  197 , FP:  174 , FN: 3492 , P: 53.099730458221025 , R: 5.34020059636758 , F1: 9.704433497536947
For g  14  test metrics, TP:  210 , FP:  204 , FN: 3479 , P: 50.72463768115942 , R: 5.692599620493358 , F1: 10.236412381184497
For g  13  test metrics, TP:  229 , FP:  231 , FN: 3460 , P: 49.78260869565217 , R: 6.207644348061805 , F1: 11.03880453121234
For g  12  test metrics, TP:  311 , FP:  291 , FN: 3378 , P: 51.66112956810631 , R: 8.43046896177826 , F1: 14.495455604754138
For g  11  test metrics, TP:  548 , FP:  416 , FN: 3141 , P: 56.84647302904564 , R: 14.854974247763622 , F1: 23.554695895121426
For g  10  test metrics, TP:  809 , FP:  595 , FN: 2880 , P: 57.62108262108262 , R: 21.93006234751965 , F1: 31.76909483604948
For g  9  test metrics, TP:  1090 , FP:  678 , FN: 2599 , P: 61.65158371040724 , R: 29.547302792084576 , F1: 39.94868975627634
For g  8  test metrics, TP:  1590 , FP:  818 , FN: 2099 , P: 66.0299003322259 , R: 43.10111141230686 , F1: 52.156798425455136
For g  7  test metrics, TP:  1854 , FP:  951 , FN: 1835 , P: 66.09625668449198 , R: 50.257522363784226 , F1: 57.098860486603016
For g  6  test metrics, TP:  2107 , FP:  1110 , FN: 1582 , P: 65.49580354367423 , R: 57.1157495256167 , F1: 61.01940341731827
For g  5  test metrics, TP:  2200 , FP:  1172 , FN: 1489 , P: 65.24317912218268 , R: 59.63675792897804 , F1: 62.314119813057644
For g  4  test metrics, TP:  2237 , FP:  1220 , FN: 1452 , P: 64.70928550766561 , R: 60.63973976687449 , F1: 62.60845228099636
For g  3  test metrics, TP:  2696 , FP:  1295 , FN: 993 , P: 67.5519919819594 , R: 73.08213608023854 , F1: 70.20833333333333
For g  2  test metrics, TP:  3058 , FP:  6828 , FN: 631 , P: 30.93263200485535 , R: 82.89509352127948 , F1: 45.05340699815837
For g  1  test metrics, TP:  3444 , FP:  11959 , FN: 245 , P: 22.359280659611763 , R: 93.35863377609108 , F1: 36.07793840351979
Ce a dat pe validare
4 1295 993 67.5519919819594 73.08213608023854

Best threshold 3
Confusion matrix
TP: 2696, TN: 11764, FP: 1295, FN: 993, FNR: 0.26917863919761453, FPR: 0.09916532659468566
Precision: 67.552%, Recall: 73.082%, F1-measure: 70.208%, Specificity: 0.901, Lead time: 12.067
elapsed_time: 359.5064868927002
Log saved

Starting EPOCH: 8 | phase: train | ⏰: 20:28:18 | Learning rate: 0.001000
Train loss: 0.31651383 - Train acc: 0.88 - Train kurtosis: 0.91 - Train skewness: -1.52: 100%|██████████| 477/477 [02:53<00:00,  2.74it/s]
:   0%|          | 0/53 [00:00<?, ?it/s]Eliminated instances percentage:  0.17848064418259493 87065/487812
Eliminated anomalies percentage:  0.07014299661172688 6107/87065

Starting epoch: 8 | phase: valid | ⏰: 20:31:14
: 100%|██████████| 53/53 [00:06<00:00,  8.36it/s]

Validation loss: 0.2965254822991929 Validation accuracy: 0.8818656482352724 Validation kurtosis: 1.083076000213623 Validation skewness: -1.569976568222046
Save model checkpoint at dataset/hdfs/deeplog/deeplog.pth
======== My contribution ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/train.pkl
Length test 57506
Nr secvente unice train: normale vs anormale
3773 607
: 100%|██████████| 107/107 [00:13<00:00,  7.83it/s]
: 100%|██████████| 19/19 [00:01<00:00, 16.45it/s]
------------------------JUST NORMAL FOR ELBOW TRAIN SEQUENCES----------------------------
For g  20  train metrics, TP:  18 , FP:  17 , FN: 1631 , P: 51.42857142857143 , R: 1.0915706488781078 , F1: 2.1377672209026124
For g  19  train metrics, TP:  18 , FP:  17 , FN: 1631 , P: 51.42857142857143 , R: 1.0915706488781078 , F1: 2.1377672209026124
For g  18  train metrics, TP:  19 , FP:  18 , FN: 1630 , P: 51.351351351351354 , R: 1.1522134627046694 , F1: 2.25385527876631
For g  17  train metrics, TP:  20 , FP:  18 , FN: 1629 , P: 52.63157894736842 , R: 1.212856276531231 , F1: 2.371072910491997
For g  16  train metrics, TP:  23 , FP:  20 , FN: 1626 , P: 53.48837209302326 , R: 1.3947847180109156 , F1: 2.718676122931442
For g  15  train metrics, TP:  29 , FP:  24 , FN: 1620 , P: 54.716981132075475 , R: 1.758641600970285 , F1: 3.407755581668625
For g  14  train metrics, TP:  35 , FP:  53 , FN: 1614 , P: 39.77272727272727 , R: 2.1224984839296543 , F1: 4.029936672423719
For g  13  train metrics, TP:  40 , FP:  77 , FN: 1609 , P: 34.18803418803419 , R: 2.425712553062462 , F1: 4.530011325028312
For g  12  train metrics, TP:  57 , FP:  93 , FN: 1592 , P: 38.0 , R: 3.4566403881140086 , F1: 6.336853807670929
For g  11  train metrics, TP:  109 , FP:  112 , FN: 1540 , P: 49.321266968325794 , R: 6.610066707095209 , F1: 11.657754010695186
For g  10  train metrics, TP:  137 , FP:  135 , FN: 1512 , P: 50.36764705882353 , R: 8.308065494238933 , F1: 14.263404476834982
For g  9  train metrics, TP:  171 , FP:  161 , FN: 1478 , P: 51.506024096385545 , R: 10.369921164342026 , F1: 17.264008076728928
For g  8  train metrics, TP:  234 , FP:  189 , FN: 1415 , P: 55.319148936170215 , R: 14.190418435415403 , F1: 22.586872586872587
For g  7  train metrics, TP:  344 , FP:  247 , FN: 1305 , P: 58.206429780033844 , R: 20.861127956337175 , F1: 30.71428571428572
For g  6  train metrics, TP:  386 , FP:  269 , FN: 1263 , P: 58.93129770992366 , R: 23.408126137052758 , F1: 33.50694444444444
For g  5  train metrics, TP:  401 , FP:  277 , FN: 1248 , P: 59.14454277286136 , R: 24.31776834445118 , F1: 34.4649763644177
For g  4  train metrics, TP:  474 , FP:  372 , FN: 1175 , P: 56.02836879432624 , R: 28.744693753790177 , F1: 37.99599198396794
For g  3  train metrics, TP:  496 , FP:  376 , FN: 1153 , P: 56.88073394495413 , R: 30.07883565797453 , F1: 39.34946449821499
For g  2  train metrics, TP:  645 , FP:  6630 , FN: 1004 , P: 8.8659793814433 , R: 39.114614918132204 , F1: 14.455401165396685
For g  1  train metrics, TP:  853 , FP:  13356 , FN: 796 , P: 6.00323738475614 , R: 51.728320194057005 , F1: 10.757977046285786
Ce a dat pe train
4 376 1153 56.88073394495413 30.07883565797453

[35, 35, 37, 38, 43, 53, 88, 117, 150, 221, 272, 332, 423, 591, 655, 678, 846, 872, 7275, 14209]
Changes in number of anomalies
Pentru g 33 anomalies diff:0
Pentru g 32 anomalies diff:2
Pentru g 31 anomalies diff:1
Pentru g 30 anomalies diff:5
Pentru g 29 anomalies diff:10
Pentru g 28 anomalies diff:35
Pentru g 27 anomalies diff:29
Pentru g 26 anomalies diff:33
Pentru g 25 anomalies diff:71
Pentru g 24 anomalies diff:51
Pentru g 23 anomalies diff:60
Pentru g 22 anomalies diff:91
Pentru g 21 anomalies diff:168
Pentru g 20 anomalies diff:64
Pentru g 19 anomalies diff:23
Pentru g 18 anomalies diff:168
Pentru g 17 anomalies diff:26
Pentru g 16 anomalies diff:6403
Pentru g 15 anomalies diff:6934
elapsed_time: 42.94955492019653
======== Their approach ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/test.pkl
Length test 517555
Nr secvente unice test: normale vs anormale
13059 3689
: 100%|██████████| 389/389 [00:44<00:00,  8.66it/s]
------------------------NORMAL TEST SEQUENCES----------------------------
: 100%|██████████| 120/120 [00:11<00:00, 10.12it/s]
For g  20  test metrics, TP:  181 , FP:  140 , FN: 15008 , P: 56.386292834890966 , R: 1.191651853314899 , F1: 2.3339780786589297
For g  19  test metrics, TP:  181 , FP:  140 , FN: 15008 , P: 56.386292834890966 , R: 1.191651853314899 , F1: 2.3339780786589297
For g  18  test metrics, TP:  186 , FP:  145 , FN: 15003 , P: 56.19335347432024 , R: 1.224570412798736 , F1: 2.3969072164948457
For g  17  test metrics, TP:  195 , FP:  158 , FN: 14994 , P: 55.240793201133144 , R: 1.2838238198696426 , F1: 2.5093295586153648
For g  16  test metrics, TP:  218 , FP:  180 , FN: 14971 , P: 54.77386934673367 , R: 1.4352491934952927 , F1: 2.797202797202797
For g  15  test metrics, TP:  239 , FP:  202 , FN: 14950 , P: 54.19501133786848 , R: 1.573507143327408 , F1: 3.0582213691618687
For g  14  test metrics, TP:  281 , FP:  472 , FN: 14908 , P: 37.31739707835325 , R: 1.8500230429916387 , F1: 3.525279136871158
For g  13  test metrics, TP:  318 , FP:  717 , FN: 14871 , P: 30.72463768115942 , R: 2.0936203831720324 , F1: 3.920118343195267
For g  12  test metrics, TP:  462 , FP:  845 , FN: 14727 , P: 35.34812547819434 , R: 3.0416748963065374 , F1: 5.601357904946653
For g  11  test metrics, TP:  931 , FP:  968 , FN: 14258 , P: 49.02580305423907 , R: 6.129435775890447 , F1: 10.896535580524343
For g  10  test metrics, TP:  1191 , FP:  1188 , FN: 13998 , P: 50.06305170239597 , R: 7.84120086904997 , F1: 13.558743169398907
For g  9  test metrics, TP:  1531 , FP:  1340 , FN: 13658 , P: 53.32636711947057 , R: 10.079662913950886 , F1: 16.954595791805094
For g  8  test metrics, TP:  2125 , FP:  1656 , FN: 13064 , P: 56.2020629463105 , R: 13.99038778063072 , F1: 22.40379546652609
For g  7  test metrics, TP:  3100 , FP:  2149 , FN: 12089 , P: 59.05886835587731 , R: 20.40950687997893 , F1: 30.33564928075154
For g  6  test metrics, TP:  3460 , FP:  2305 , FN: 11729 , P: 60.01734605377277 , R: 22.779643162815194 , F1: 33.02472081702778
For g  5  test metrics, TP:  3683 , FP:  2411 , FN: 11506 , P: 60.43649491302921 , R: 24.247810915794325 , F1: 34.6097824554809
For g  4  test metrics, TP:  4373 , FP:  3239 , FN: 10816 , P: 57.44876510772465 , R: 28.79057212456383 , F1: 38.35796675584404
For g  3  test metrics, TP:  4596 , FP:  3300 , FN: 10593 , P: 58.20668693009119 , R: 30.258739877542958 , F1: 39.8180636777128
For g  2  test metrics, TP:  5948 , FP:  58728 , FN: 9241 , P: 9.196610798441462 , R: 39.15991836197248 , F1: 14.89513554122582
For g  1  test metrics, TP:  7921 , FP:  118552 , FN: 7268 , P: 6.262996845176441 , R: 52.14958193429455 , F1: 11.182956615041437
Ce a dat pe validare
4 3300 10593 58.20668693009119 30.258739877542958

Best threshold 3
Confusion matrix
TP: 4596, TN: 499066, FP: 3300, FN: 10593, FNR: 0.6974126012245704, FPR: 0.00656891589000848
Precision: 58.207%, Recall: 30.259%, F1-measure: 39.818%, Specificity: 0.993
--------------------------UNIQUE TEST SEQUENCES------------------------------------
For g  20  test metrics, TP:  148 , FP:  112 , FN: 3541 , P: 56.92307692307692 , R: 4.011927351585795 , F1: 7.495568498354013
For g  19  test metrics, TP:  148 , FP:  112 , FN: 3541 , P: 56.92307692307692 , R: 4.011927351585795 , F1: 7.495568498354013
For g  18  test metrics, TP:  153 , FP:  117 , FN: 3536 , P: 56.666666666666664 , R: 4.147465437788019 , F1: 7.729224551654458
For g  17  test metrics, TP:  162 , FP:  130 , FN: 3527 , P: 55.47945205479452 , R: 4.391433992952019 , F1: 8.138658628485306
For g  16  test metrics, TP:  184 , FP:  147 , FN: 3505 , P: 55.58912386706949 , R: 4.9878015722418 , F1: 9.154228855721392
For g  15  test metrics, TP:  203 , FP:  165 , FN: 3486 , P: 55.16304347826087 , R: 5.502846299810247 , F1: 10.007394626571358
For g  14  test metrics, TP:  233 , FP:  216 , FN: 3456 , P: 51.89309576837417 , R: 6.316074817023583 , F1: 11.26147897535041
For g  13  test metrics, TP:  270 , FP:  265 , FN: 3419 , P: 50.467289719626166 , R: 7.319056654920033 , F1: 12.78409090909091
For g  12  test metrics, TP:  372 , FP:  351 , FN: 3317 , P: 51.45228215767635 , R: 10.084033613445378 , F1: 16.86310063463282
For g  11  test metrics, TP:  536 , FP:  428 , FN: 3153 , P: 55.601659751037346 , R: 14.529682840878287 , F1: 23.038899634644316
For g  10  test metrics, TP:  755 , FP:  562 , FN: 2934 , P: 57.32725892179195 , R: 20.466251016535647 , F1: 30.16380343587695
For g  9  test metrics, TP:  872 , FP:  651 , FN: 2817 , P: 57.25541694024951 , R: 23.637842233667662 , F1: 33.46124328472756
For g  8  test metrics, TP:  1270 , FP:  793 , FN: 2419 , P: 61.560833737275814 , R: 34.426673895364594 , F1: 44.158553546592486
For g  7  test metrics, TP:  1678 , FP:  960 , FN: 2011 , P: 63.608794541319185 , R: 45.48658172946598 , F1: 53.04251620041094
For g  6  test metrics, TP:  1898 , FP:  1054 , FN: 1791 , P: 64.29539295392954 , R: 51.450257522363785 , F1: 57.160066255082064
For g  5  test metrics, TP:  2060 , FP:  1120 , FN: 1629 , P: 64.77987421383648 , R: 55.8416915153158 , F1: 59.97961857621196
For g  4  test metrics, TP:  2237 , FP:  1219 , FN: 1452 , P: 64.72800925925925 , R: 60.63973976687449 , F1: 62.61721483554933
For g  3  test metrics, TP:  2339 , FP:  1264 , FN: 1350 , P: 64.91812378573411 , R: 63.40471672539984 , F1: 64.15249588590235
For g  2  test metrics, TP:  3002 , FP:  6392 , FN: 687 , P: 31.95656802214179 , R: 81.37706695581458 , F1: 45.891615072995485
For g  1  test metrics, TP:  3353 , FP:  11337 , FN: 336 , P: 22.82505105513955 , R: 90.89184060721063 , F1: 36.48729528265955
Ce a dat pe validare
4 1264 1350 64.91812378573411 63.40471672539984

Best threshold 3
Confusion matrix
TP: 2339, TN: 11795, FP: 1264, FN: 1350, FNR: 0.3659528327460016, FPR: 0.09679148479975495
Precision: 64.918%, Recall: 63.405%, F1-measure: 64.152%, Specificity: 0.903, Lead time: 12.776
elapsed_time: 372.2311327457428
Log saved

Starting EPOCH: 9 | phase: train | ⏰: 20:38:24 | Learning rate: 0.001000
Train loss: 0.29321258 - Train acc: 0.88 - Train kurtosis: 1.25 - Train skewness: -1.61: 100%|██████████| 477/477 [02:49<00:00,  2.81it/s]
Eliminated instances percentage:  0.16912253081105016 82500/487812
Eliminated anomalies percentage:  0.0703030303030303 5800/82500

Starting epoch: 9 | phase: valid | ⏰: 20:41:15
: 100%|██████████| 53/53 [00:05<00:00,  8.89it/s]
: 100%|██████████| 107/107 [00:12<00:00,  8.86it/s]

Validation loss: 0.277254747894575 Validation accuracy: 0.886551908636372 Validation kurtosis: 1.5060889720916748 Validation skewness: -1.6663784980773926
Save model checkpoint at dataset/hdfs/deeplog/deeplog.pth
======== My contribution ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/train.pkl
Length test 57506
Nr secvente unice train: normale vs anormale
3773 607
------------------------JUST NORMAL FOR ELBOW TRAIN SEQUENCES----------------------------
For g  20  train metrics, TP:  19 , FP:  14 , FN: 1630 , P: 57.57575757575758 , R: 1.1522134627046694 , F1: 2.2592152199762188
For g  19  train metrics, TP:  19 , FP:  14 , FN: 1630 , P: 57.57575757575758 , R: 1.1522134627046694 , F1: 2.2592152199762188
: 100%|██████████| 19/19 [00:01<00:00, 13.15it/s]
For g  18  train metrics, TP:  19 , FP:  14 , FN: 1630 , P: 57.57575757575758 , R: 1.1522134627046694 , F1: 2.2592152199762188
For g  17  train metrics, TP:  19 , FP:  15 , FN: 1630 , P: 55.88235294117647 , R: 1.1522134627046694 , F1: 2.2578728461081403
For g  16  train metrics, TP:  19 , FP:  18 , FN: 1630 , P: 51.351351351351354 , R: 1.1522134627046694 , F1: 2.25385527876631
For g  15  train metrics, TP:  25 , FP:  20 , FN: 1624 , P: 55.55555555555556 , R: 1.5160703456640388 , F1: 2.9515938606847696
For g  14  train metrics, TP:  36 , FP:  50 , FN: 1613 , P: 41.86046511627907 , R: 2.1831412977562157 , F1: 4.149855907780979
For g  13  train metrics, TP:  41 , FP:  62 , FN: 1608 , P: 39.80582524271845 , R: 2.4863553668890237 , F1: 4.680365296803654
For g  12  train metrics, TP:  49 , FP:  68 , FN: 1600 , P: 41.88034188034188 , R: 2.971497877501516 , F1: 5.549263873159683
For g  11  train metrics, TP:  96 , FP:  71 , FN: 1553 , P: 57.48502994011976 , R: 5.821710127349909 , F1: 10.572687224669602
For g  10  train metrics, TP:  120 , FP:  101 , FN: 1529 , P: 54.29864253393665 , R: 7.277137659187386 , F1: 12.83422459893048
For g  9  train metrics, TP:  131 , FP:  119 , FN: 1518 , P: 52.4 , R: 7.944208611279564 , F1: 13.796735123749343
For g  8  train metrics, TP:  146 , FP:  154 , FN: 1503 , P: 48.666666666666664 , R: 8.853850818677987 , F1: 14.982042072857876
For g  7  train metrics, TP:  244 , FP:  190 , FN: 1405 , P: 56.22119815668203 , R: 14.79684657368102 , F1: 23.42774843975036
For g  6  train metrics, TP:  288 , FP:  226 , FN: 1361 , P: 56.03112840466926 , R: 17.465130382049725 , F1: 26.629680998613036
For g  5  train metrics, TP:  392 , FP:  271 , FN: 1257 , P: 59.125188536953246 , R: 23.77198302001213 , F1: 33.910034602076124
For g  4  train metrics, TP:  468 , FP:  370 , FN: 1181 , P: 55.8472553699284 , R: 28.380836870830805 , F1: 37.635705669481304
For g  3  train metrics, TP:  488 , FP:  376 , FN: 1161 , P: 56.48148148148148 , R: 29.59369314736204 , F1: 38.83804218066057
For g  2  train metrics, TP:  641 , FP:  5919 , FN: 1008 , P: 9.771341463414634 , R: 38.87204366282595 , F1: 15.617005725423315
For g  1  train metrics, TP:  855 , FP:  14525 , FN: 794 , P: 5.559167750325098 , R: 51.84960582171013 , F1: 10.041693581537379
Ce a dat pe train
4 376 1161 56.48148148148148 29.59369314736204

[33, 33, 33, 34, 37, 45, 86, 103, 117, 167, 221, 250, 300, 434, 514, 663, 838, 864, 6560, 15380]
Changes in number of anomalies
Pentru g 33 anomalies diff:0
Pentru g 32 anomalies diff:0
Pentru g 31 anomalies diff:1
Pentru g 30 anomalies diff:3
Pentru g 29 anomalies diff:8
Pentru g 28 anomalies diff:41
Pentru g 27 anomalies diff:17
Pentru g 26 anomalies diff:14
Pentru g 25 anomalies diff:50
Pentru g 24 anomalies diff:54
Pentru g 23 anomalies diff:29
Pentru g 22 anomalies diff:50
Pentru g 21 anomalies diff:134
Pentru g 20 anomalies diff:80
Pentru g 19 anomalies diff:149
Pentru g 18 anomalies diff:175
Pentru g 17 anomalies diff:26
Pentru g 16 anomalies diff:5696
Pentru g 15 anomalies diff:8820
elapsed_time: 41.333699226379395
======== Their approach ===========
model_path: dataset/hdfs/deeplog/deeplog.pth
Loading dataset/hdfs/test.pkl
Length test 517555
Nr secvente unice test: normale vs anormale
13059 3689
: 100%|██████████| 389/389 [00:47<00:00,  8.18it/s]
: 100%|██████████| 120/120 [00:11<00:00, 10.68it/s]
------------------------NORMAL TEST SEQUENCES----------------------------
For g  20  test metrics, TP:  182 , FP:  123 , FN: 15007 , P: 59.67213114754098 , R: 1.1982355652116663 , F1: 2.349296501871692
For g  19  test metrics, TP:  182 , FP:  123 , FN: 15007 , P: 59.67213114754098 , R: 1.1982355652116663 , F1: 2.349296501871692
For g  18  test metrics, TP:  186 , FP:  123 , FN: 15003 , P: 60.19417475728155 , R: 1.224570412798736 , F1: 2.4003097173828882
For g  17  test metrics, TP:  194 , FP:  135 , FN: 14995 , P: 58.96656534954408 , R: 1.277240107972875 , F1: 2.500322206469906
For g  16  test metrics, TP:  203 , FP:  154 , FN: 14986 , P: 56.86274509803921 , R: 1.3364935150437818 , F1: 2.611604271195163
For g  15  test metrics, TP:  220 , FP:  173 , FN: 14969 , P: 55.979643765903305 , R: 1.4484166172888275 , F1: 2.823771017841099
For g  14  test metrics, TP:  284 , FP:  426 , FN: 14905 , P: 40.0 , R: 1.8697741786819408 , F1: 3.572551732813384
For g  13  test metrics, TP:  322 , FP:  549 , FN: 14867 , P: 36.969001148105626 , R: 2.119955230759102 , F1: 4.009962640099626
For g  12  test metrics, TP:  394 , FP:  628 , FN: 14795 , P: 38.551859099804304 , R: 2.5939824873263544 , F1: 4.860896921843192
For g  11  test metrics, TP:  797 , FP:  687 , FN: 14392 , P: 53.706199460916444 , R: 5.2472183817236155 , F1: 9.560367060517004
For g  10  test metrics, TP:  991 , FP:  924 , FN: 14198 , P: 51.74934725848564 , R: 6.524458489696491 , F1: 11.587932647333957
For g  9  test metrics, TP:  1192 , FP:  1069 , FN: 13997 , P: 52.72003538257408 , R: 7.847784580946738 , F1: 13.66189111747851
For g  8  test metrics, TP:  1383 , FP:  1305 , FN: 13806 , P: 51.450892857142854 , R: 9.10527355322931 , F1: 15.472394697096826
For g  7  test metrics, TP:  2264 , FP:  1650 , FN: 12925 , P: 57.84363822176801 , R: 14.905523734281388 , F1: 23.70308328534785
For g  6  test metrics, TP:  2644 , FP:  1916 , FN: 12545 , P: 57.98245614035088 , R: 17.407334255052998 , F1: 26.776039293128765
For g  5  test metrics, TP:  3595 , FP:  2374 , FN: 11594 , P: 60.227843859943036 , R: 23.668444268878794 , F1: 33.98241799792041
For g  4  test metrics, TP:  4332 , FP:  3232 , FN: 10857 , P: 57.27128503437335 , R: 28.520639936796364 , F1: 38.078495143497555
For g  3  test metrics, TP:  4470 , FP:  3302 , FN: 10719 , P: 57.51415337107566 , R: 29.429192178550267 , F1: 38.9355864291625
For g  2  test metrics, TP:  5918 , FP:  51995 , FN: 9271 , P: 10.218776440522854 , R: 38.96240700506946 , F1: 16.191075483570902
For g  1  test metrics, TP:  8013 , FP:  129040 , FN: 7176 , P: 5.846643269392133 , R: 52.755283428797156 , F1: 10.526661499454814
Ce a dat pe validare
4 3302 10719 57.51415337107566 29.429192178550267

Best threshold 3
Confusion matrix
TP: 4470, TN: 499064, FP: 3302, FN: 10719, FNR: 0.7057080782144973, FPR: 0.00657289705115394
Precision: 57.514%, Recall: 29.429%, F1-measure: 38.936%, Specificity: 0.993
--------------------------UNIQUE TEST SEQUENCES------------------------------------
For g  20  test metrics, TP:  149 , FP:  103 , FN: 3540 , P: 59.12698412698413 , R: 4.039034968826241 , F1: 7.561532605937579
For g  19  test metrics, TP:  149 , FP:  103 , FN: 3540 , P: 59.12698412698413 , R: 4.039034968826241 , F1: 7.561532605937579
For g  18  test metrics, TP:  153 , FP:  103 , FN: 3536 , P: 59.765625 , R: 4.147465437788019 , F1: 7.756653992395438
For g  17  test metrics, TP:  160 , FP:  113 , FN: 3529 , P: 58.608058608058606 , R: 4.33721875847113 , F1: 8.076728924785462
For g  16  test metrics, TP:  169 , FP:  125 , FN: 3520 , P: 57.48299319727891 , R: 4.581187313635131 , F1: 8.486065779563141
For g  15  test metrics, TP:  186 , FP:  141 , FN: 3503 , P: 56.88073394495413 , R: 5.042016806722689 , F1: 9.262948207171316
For g  14  test metrics, TP:  236 , FP:  183 , FN: 3453 , P: 56.32458233890215 , R: 6.397397668744917 , F1: 11.489776046738072
For g  13  test metrics, TP:  274 , FP:  222 , FN: 3415 , P: 55.24193548387097 , R: 7.427487123881811 , F1: 13.094384707287933
For g  12  test metrics, TP:  317 , FP:  275 , FN: 3372 , P: 53.5472972972973 , R: 8.593114665220927 , F1: 14.809623919644942
For g  11  test metrics, TP:  458 , FP:  327 , FN: 3231 , P: 58.34394904458599 , R: 12.41528869612361 , F1: 20.47384890478319
For g  10  test metrics, TP:  589 , FP:  417 , FN: 3100 , P: 58.54870775347913 , R: 15.966386554621849 , F1: 25.09052183173589
For g  9  test metrics, TP:  758 , FP:  508 , FN: 2931 , P: 59.87361769352291 , R: 20.54757386825698 , F1: 30.59535822401614
For g  8  test metrics, TP:  910 , FP:  638 , FN: 2779 , P: 58.78552971576227 , R: 24.667931688804554 , F1: 34.75272102348673
For g  7  test metrics, TP:  1369 , FP:  805 , FN: 2320 , P: 62.97148114075437 , R: 37.11032800216861 , F1: 46.69964182159304
For g  6  test metrics, TP:  1554 , FP:  908 , FN: 2135 , P: 63.11941510966694 , R: 42.125237191650854 , F1: 50.528369370834014
For g  5  test metrics, TP:  1986 , FP:  1089 , FN: 1703 , P: 64.58536585365853 , R: 53.8357278395229 , F1: 58.72264931992903
For g  4  test metrics, TP:  2211 , FP:  1212 , FN: 1478 , P: 64.59246275197195 , R: 59.93494171862293 , F1: 62.176602924634416
For g  3  test metrics, TP:  2280 , FP:  1261 , FN: 1409 , P: 64.38859079356114 , R: 61.80536730821361 , F1: 63.07053941908714
For g  2  test metrics, TP:  2979 , FP:  6368 , FN: 710 , P: 31.87118861666845 , R: 80.75359175928436 , F1: 45.704203743479596
For g  1  test metrics, TP:  3305 , FP:  11081 , FN: 384 , P: 22.9737244543306 , R: 89.59067497966929 , F1: 36.569847856154915
Ce a dat pe validare
4 1261 1409 64.38859079356114 61.80536730821361

Best threshold 3
Confusion matrix
TP: 2280, TN: 11798, FP: 1261, FN: 1409, FNR: 0.3819463269178639, FPR: 0.09656175817443909
Precision: 64.389%, Recall: 61.805%, F1-measure: 63.071%, Specificity: 0.903, Lead time: 12.068
elapsed_time: 431.33708000183105
Log saved
plot done

Process finished with exit code 0
